<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>é¾™æŸçš„å°æœ¬æœ¬</title><link>https://longxiucai.github.io</link><description> </description><copyright>é¾™æŸçš„å°æœ¬æœ¬</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://avatars.githubusercontent.com/u/43312586</url><title>avatar</title><link>https://longxiucai.github.io</link></image><lastBuildDate>Tue, 13 Jan 2026 06:07:29 +0000</lastBuildDate><managingEditor>é¾™æŸçš„å°æœ¬æœ¬</managingEditor><ttl>60</ttl><webMaster>é¾™æŸçš„å°æœ¬æœ¬</webMaster><item><title>goç¨‹åºåˆ©ç”¨k8s leaderelectioné€‰ä¸¾ï¼ˆæ—¥å¿—æ»šå­˜+æ—¥å¿—æ‰“å°æ§åˆ¶å°+é€‰ä¸¾+å¤šä»»åŠ¡ï¼‰</title><link>https://longxiucai.github.io/post/88.html</link><description># æ—¥å¿—æ»šå­˜+æ—¥å¿—æ‰“å°æ§åˆ¶å°+é€‰ä¸¾+å¤šä»»åŠ¡ï¼ˆä¸€ä¸ªå¸¸é©»ä»»åŠ¡ã€ä¸€ä¸ªleaderæ‰§è¡Œä»»åŠ¡ï¼‰
```
package main

import (
	'context'
	'fmt'
	'io'
	'os'
	'os/signal'
	'syscall'
	'time'

	'github.com/labstack/gommon/log'
	'gopkg.in/natefinch/lumberjack.v2'
	metav1 'k8s.io/apimachinery/pkg/apis/meta/v1'
	'k8s.io/client-go/kubernetes'
	'k8s.io/client-go/rest'
	'k8s.io/client-go/tools/clientcmd'
	'k8s.io/client-go/tools/leaderelection'
	'k8s.io/client-go/tools/leaderelection/resourcelock'
)

// é€‰ä¸»æ ¸å¿ƒé…ç½®
const (
	leaderLockName      = 'alertmanager-webhook-leader-lock'
	leaderLockNamespace = 'monitoring'
	// Leader èº«ä»½çš„ã€Œæœ€å¤§æœ‰æ•ˆæœŸã€ / Lease é”çš„ã€Œç§ŸæœŸæ—¶é•¿ã€
	leaseDuration = 15 * time.Second
	// Leader çš„ã€Œç»­çº¦è¶…æ—¶æ—¶é—´ã€ / ã€Œèº«ä»½ç»­å‘½çª—å£æœŸã€
	renewDeadline = 10 * time.Second

	// ä¸¤ç§åœºæ™¯ä¸‹çš„ã€Œé‡è¯•é—´éš”ã€ï¼ˆæœ€çµæ´»çš„å‚æ•°ï¼Œæ§åˆ¶é›†ç¾¤æŠ¢ä¸»æ•ˆç‡ï¼‰ï¼Œè¦†ç›–æ‰€æœ‰é Leader å®ä¾‹ + Leader ç»­çº¦å¤±è´¥åœºæ™¯ï¼š
	// åœºæ™¯â‘ ï¼šFollower å®ä¾‹ï¼ˆé Leaderï¼‰çš„ã€ŒæŠ¢ä¸»é‡è¯•é—´éš”ã€ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/88.html</guid><pubDate>Mon, 05 Jan 2026 09:44:12 +0000</pubDate></item><item><title>é€šè¿‡opentelemetry-operatoréƒ¨ç½²jaeger(all-in-one)</title><link>https://longxiucai.github.io/post/87.html</link><description>é›†ç¾¤ä¸­éœ€è¦æœ‰cert-managerã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/87.html</guid><pubDate>Mon, 15 Dec 2025 07:12:33 +0000</pubDate></item><item><title>kubectl topå‘½ä»¤æŠ¥é”™error: metrics not available yetæ’æŸ¥æ€è·¯</title><link>https://longxiucai.github.io/post/86.html</link><description>1ã€æ£€æŸ¥apiservice
```
[root@master1 ~]# kubectl get apiservice v1beta1.metrics.k8s.io
NAME                     SERVICE                         AVAILABLE   AGE
v1beta1.metrics.k8s.io   monitoring/prometheus-adapter   True        173d
```
æ—§çš„ç‰ˆæœ¬å¯èƒ½ä¸º`kube-system/metrics-server`
2ã€æ£€æŸ¥prometheus-adapterè¿è¡Œå‚æ•°æ˜¯å¦æ­£ç¡®ä»prometheusä¸­è·å–æŒ‡æ ‡æ•°æ®
```
kubectl get deployment.apps/prometheus-adapter -n monitoring  -oyaml
```
3ã€æ£€æŸ¥prometheus-adapteré…ç½®
```
[root@master1 ~]# kubectl get cm -n monitoring  adapter-config -oyaml
apiVersion: v1
data:
  config.yaml: |-
    'resourceRules':
      'cpu':
        'containerLabel': 'container'
        'containerQuery': |
          sum by (&lt;&lt;.GroupBy&gt;&gt;) (
            irate (
                container_cpu_usage_seconds_total{&lt;&lt;.LabelMatchers&gt;&gt;,container!='',pod!=''}[120s]
            )
          )
        'nodeQuery': |
          sum by (&lt;&lt;.GroupBy&gt;&gt;) (
            1 - irate(
              node_cpu_seconds_total{mode='idle'}[60s]
            )
            * on(namespace, pod) group_left(node) (
              node_namespace_pod:kube_pod_info:{&lt;&lt;.LabelMatchers&gt;&gt;}
            )
          )
          or sum by (&lt;&lt;.GroupBy&gt;&gt;) (
            1 - irate(
              windows_cpu_time_total{mode='idle', job='windows-exporter',&lt;&lt;.LabelMatchers&gt;&gt;}[4m]
            )
          )
        'resources':
          'overrides':
            'namespace':
              'resource': 'namespace'
            'node':
              'resource': 'node'
            'pod':
              'resource': 'pod'
      'memory':
        'containerLabel': 'container'
        'containerQuery': |
          sum by (&lt;&lt;.GroupBy&gt;&gt;) (
            container_memory_working_set_bytes{&lt;&lt;.LabelMatchers&gt;&gt;,container!='',pod!=''}
          )
        'nodeQuery': |
          sum by (&lt;&lt;.GroupBy&gt;&gt;) (
            node_memory_MemTotal_bytes{job='node-exporter',&lt;&lt;.LabelMatchers&gt;&gt;}
            -
            node_memory_MemAvailable_bytes{job='node-exporter',&lt;&lt;.LabelMatchers&gt;&gt;}
          )
          or sum by (&lt;&lt;.GroupBy&gt;&gt;) (
            windows_cs_physical_memory_bytes{job='windows-exporter',&lt;&lt;.LabelMatchers&gt;&gt;}
            -
            windows_memory_available_bytes{job='windows-exporter',&lt;&lt;.LabelMatchers&gt;&gt;}
          )
        'resources':
          'overrides':
            'instance':
              'resource': 'node'
            'namespace':
              'resource': 'namespace'
            'pod':
              'resource': 'pod'
      'window': '5m'
kind: ConfigMap
metadata:
  annotations:
...
```
å¯çŸ¥kube topå‘½ä»¤æ‰€æ˜¾ç¤ºçš„æ•°æ®åº”å½“æ˜¯ç”±ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­çš„promQLæä¾›ï¼Œkube topå‘½ä»¤æ— æ³•æ˜¾ç¤ºæ•°æ®æ˜¯å› ä¸ºä¸Šè¿°æŸ¥è¯¢è¯­å¥æ²¡æœ‰æ•°æ®è¿”å›ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/86.html</guid><pubDate>Wed, 19 Nov 2025 08:00:02 +0000</pubDate></item><item><title>å›½å¯†ç‰ˆnginx</title><link>https://longxiucai.github.io/post/85.html</link><description># ç¼–è¯‘éƒ¨ç½²ï¼ˆnginx-1.24ä¸ºä¾‹ï¼‰
1. ä¸‹è½½gmssl_openssl_1.1_bxx.tar.gzåˆ°/root/ä¸‹

æ‰“å¼€åœ°å€ https://www.gmssl.cn/gmssl/index.jsp 
é€‰æ‹©æ¶æ„ä¸‹è½½
&lt;img width='1558' height='613' alt='Image' src='https://github.com/user-attachments/assets/3e9a0e6b-59ca-4d79-a11d-fed3ffe9e979' /&gt;

2. è§£å‹ tar xzfm gmssl_openssl_1.1_bxx.tar.gz -C /usr/local
3. ä¸‹è½½[nginx-1.24.0.tar.gz](http://nginx.org/download/nginx-1.24.0.tar.gz)åˆ°/root/ä¸‹
4. è§£å‹ tar xzfm nginx-1.24.0.tar.gz
5. è¿›å…¥ç›®å½• cd /root/nginx-1.24.0
6. ç¼–è¾‘auto/lib/openssl/confï¼Œå°†å…¨éƒ¨$OPENSSL/.openssl/ä¿®æ”¹ä¸º$OPENSSL/å¹¶ä¿å­˜(sed -i 's|$OPENSSL/.openssl/|$OPENSSL/|g'  auto/lib/openssl/conf)
7. ç¼–è¯‘é…ç½®
```
./configure \
--without-http_gzip_module \
--with-http_ssl_module \
--with-http_stub_status_module \
--with-http_v2_module \
--with-stream \
--with-file-aio \
--with-openssl='/usr/local/gmssl'
```
8. ç¼–è¯‘å®‰è£…
```
make install
```
9. /usr/local/nginxå³ä¸ºç”Ÿæˆçš„nginxç›®å½•
&gt; [ !TIP ]
&gt; å¯èƒ½éœ€è¦ä½¿ç”¨`yum install -y zlib zlib-devel pcre pcre-devel`æˆ–è€…`apt-get install libpcre3 libpcre3-dev zlib1g zlib1g-dev`

# ç›´æ¥ä¸‹è½½
æ‰“å¼€åœ°å€ https://www.gmssl.cn/gmssl/index.jsp 
&lt;img width='1443' height='611' alt='Image' src='https://github.com/user-attachments/assets/a1574f62-f243-4fd8-9b99-edac252708ae' /&gt;

# æµ‹è¯•ï¼š
è‡ªå·±ä½¿ç”¨gmsslç”Ÿæˆè¯ä¹¦ï¼Œå³æ ¹æ®[sm2å›½å¯†è¯ä¹¦åˆ›å»º](https://longxiucai.github.io/post/84.html)æ–‡ä¸­æä¾›çš„æ–¹æ³•
éœ€è¦åˆ°ä¸‹é¢åœ°å€ä¸­è§£å¯†nginx-sm2.keyä¹‹ånginxæ‰èƒ½ä½¿ç”¨
https://www.gmcrt.cn/gmcrt/index.jsp
&lt;img width='1595' height='519' alt='Image' src='https://github.com/user-attachments/assets/6a4120c0-2608-4271-9994-cf27f790da3c' /&gt;

å°†nginx-sm2.certä¸nginx-sm2.decrypted.pemæ”¾åˆ°/usr/local/nginx/conf/cert/ä¸‹

/usr/local/nginx/conf/nginx.confé…ç½®å¦‚ä¸‹
```
worker_processes  auto;
error_log  /var/log/nginx/error.log;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;
    server {
        listen 80;
        return 301 https://$host$request_uri;
    }
    server {
        listen 443 ssl;
        # è‡ªå·±çš„è¯ä¹¦
        ssl_certificate /usr/local/nginx/conf/cert/nginx-sm2.cert;
        ssl_certificate_key /usr/local/nginx/conf/cert/nginx-sm2.decrypted.pem; ##è§£å¯†ä¹‹åçš„key
        ssl_protocols TLSv1.1 TLSv1.2 TLSv1.3;
	#é…ç½®sslè¯ä¹¦æ‰€éœ€çš„åŠ å¯†å¥—ä»¶
        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:AES128-SHA:DES-CBC3-SHA:ECC-SM4-CBC-SM3:ECC-SM4-GCM-SM3;
        ssl_verify_client off;
        ssl_session_cache shared:SSL:10m;
        ssl_session_timeout 10m;

        root /usr/local/nginx/html;
        index index.html;
        location / {
            try_files $uri $uri/ =404;
        }
    }
}

```

# nginxé…ç½®
## é…ç½®ç¤ºä¾‹(å›½å¯†å•å‘)
```
server
{
  listen 0.0.0.0:1443 ssl;
  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
  ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:AES128-SHA:DES-CBC3-SHA:ECC-SM4-CBC-SM3:ECC-SM4-GCM-SM3;
  ssl_verify_client off;
  
  ssl_certificate keystore/sm2.demo1.gmssl.cn.sig.crt.pem;
  ssl_certificate_key keystore/sm2.demo1.gmssl.cn.sig.key.pem;
  
  ssl_certificate keystore/sm2.demo1.gmssl.cn.enc.crt.pem;
  ssl_certificate_key keystore/sm2.demo1.gmssl.cn.enc.key.pem;
  
  location /
  {
    root html;
    index index.html index.htm;
  }
}
```
æ³¨é‡Šï¼šæµ‹è¯•è¯ä¹¦ä½¿ç”¨[www.gmcrt.cn](https://www.gmcrt.cn/)ç­¾å‘ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/85.html</guid><pubDate>Sat, 11 Oct 2025 02:12:18 +0000</pubDate></item><item><title>sm2å›½å¯†è¯ä¹¦åˆ›å»º</title><link>https://longxiucai.github.io/post/84.html</link><description>å‚è€ƒï¼šhttp://gmssl.org/docs/quickstart.html
# GmSSLçš„ç¼–è¯‘ã€å®‰è£…

### ä¸‹è½½æºä»£ç ([zip](https://github.com/guanzhi/GmSSL/archive/master.zip))ï¼Œè§£å‹ç¼©è‡³å½“å‰å·¥ä½œç›®å½•
```
$ unzip GmSSL-master.zip
```
### ç¼–è¯‘ä¸å®‰è£…

#### Linuxå¹³å°
```
$ mkdir build
$ cd build
$ cmake ..
$ make
$ make test
$ sudo make install
```
å®‰è£…ä¹‹åå¯ä»¥æ‰§è¡Œgmsslå‘½ä»¤è¡Œå·¥å…·æ£€æŸ¥æ˜¯å¦æˆåŠŸ
```
$ gmssl version
GmSSL 3.1.0 Dev
```
# è¯ä¹¦åˆ›å»º
```
COMMOMARG='-C CN -ST Beijing -O KylinSoft -OU kylincloud -pass 1234'
# 1.1 ç”Ÿæˆ SM2 æ ¹ CA ç§é’¥ï¼ˆå¯†ç  1234ï¼Œå­˜å‚¨ä¸º rootcakey.pemï¼‰
gmssl sm2keygen -pass 1234 -out rootca.key

# 1.2 ç”Ÿæˆæ ¹ CA è‡ªç­¾åè¯ä¹¦ï¼ˆæœ‰æ•ˆæœŸ 10 å¹´ï¼Œæ”¯æŒç­¾å‘è¯ä¹¦å’Œ CRLï¼‰
gmssl certgen $COMMOMARG\
  -days 3650 \
  -CN 'KylinSoft SM2 Root CA' \
  -key rootca.key \
  -out rootca.cert \
  -key_usage keyCertSign \
  -key_usage cRLSign

# 1.3 è§£ææ ¹ CA è¯ä¹¦ï¼ŒéªŒè¯ä¿¡æ¯ï¼ˆå¯é€‰ï¼Œç¡®è®¤ç”Ÿæˆæ­£ç¡®ï¼‰
gmssl certparse -in rootca.cert


# 2.1 ç”ŸæˆäºŒçº§ CA ç§é’¥ï¼ˆå¯†ç  1234ï¼Œå­˜å‚¨ä¸º cakey.pemï¼‰
gmssl sm2keygen -pass 1234 -out ca.key

# 2.2 ç”ŸæˆäºŒçº§ CA çš„è¯ä¹¦è¯·æ±‚ï¼ˆCSRï¼Œå‘æ ¹ CA ç”³è¯·ç­¾åï¼‰
gmssl reqgen $COMMOMARG\
  -CN 'KylinSoft SM2 Root CA' \
  -key ca.key \
  -out ca.csr       # è¾“å‡º CSR æ–‡ä»¶

# 2.3 ç”¨æ ¹ CA ç­¾åäºŒçº§ CA è¯·æ±‚ï¼Œç”ŸæˆäºŒçº§ CA è¯ä¹¦
gmssl reqsign \
  -in ca.csr  \
  -days 3650    \
  -key_usage keyCertSign \
  -path_len_constraint 0  \
  -cacert rootca.cert  \
  -key rootca.key   \
  -pass 1234          \
  -out ca.cert          # è¾“å‡ºäºŒçº§ CA è¯ä¹¦

# 2.4 è§£æäºŒçº§ CA è¯ä¹¦ï¼ŒéªŒè¯ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
gmssl certparse -in ca.cert


# 3.1 ç”ŸæˆæœåŠ¡ç«¯ SM2 ç§é’¥ï¼ˆå¯†ç  1234ï¼Œå­˜å‚¨ä¸º nginx-sm2-key.pemï¼‰
gmssl sm2keygen -pass 1234 -out nginx-sm2.key

# 3.2 ç”ŸæˆæœåŠ¡ç«¯è¯ä¹¦è¯·æ±‚ï¼ˆCSRï¼Œå…³é”®ï¼šCN å¡«ä¸»åŸŸåï¼Œæ”¯æŒå¤š DNS åç§°ï¼‰
#                        # ä¸»åŸŸåï¼ˆå¿…é¡»æ­£ç¡®ï¼ŒåŒ¹é…æœåŠ¡ç«¯åŸŸåï¼‰  å…³è”æœåŠ¡ç«¯ç§é’¥           è¾“å‡ºæœåŠ¡ç«¯ CSR
gmssl reqgen $COMMOMARG -CN 'nginx.example1.kylinos.cn'      -key nginx-sm2.key   -out nginx-sm2.csr

# 3.3 ç”¨äºŒçº§ CA ç­¾åæœåŠ¡ç«¯è¯·æ±‚ï¼Œç”ŸæˆæœåŠ¡ç«¯è¯ä¹¦
gmssl reqsign \
  -in nginx-sm2.csr \
  -subject_dns_name 'nginx.example1.kylinos.cn' \
  -subject_dns_name 'server1.nginx.local' \
  -days 365 \
  -key_usage digitalSignature \
  -key_usage keyEncipherment \
  -cacert ca.cert   \
  -key ca.key   \
  -pass 1234      \
  -out nginx-sm2.cert

# 3.4 è§£ææœåŠ¡ç«¯è¯ä¹¦ï¼ŒéªŒè¯åŸŸåå’Œç”¨é€”ï¼ˆå…³é”®ï¼ç¡®è®¤é…ç½®æ­£ç¡®ï¼‰
gmssl certparse -in nginx-sm2.cert

# 3.5 éªŒè¯è¯ä¹¦
gmssl certverify -in nginx-sm2.cert -cacert ca.cert
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/84.html</guid><pubDate>Fri, 10 Oct 2025 05:25:09 +0000</pubDate></item><item><title>ingress-nginx-controlleræ’ä»¶å¼€å‘</title><link>https://longxiucai.github.io/post/83.html</link><description>æµ‹è¯•ç‰ˆæœ¬ï¼šingress-nginx-controller:v1.7.0-2
## å¼€å¯access_by_lua_blockï¼Œè®©acessé˜¶æ®µæ‰§è¡Œæ’ä»¶ï¼ˆé€‚ç”¨äºä¼˜å…ˆçº§åˆ†æµï¼‰
```
kubectl exec -it  -n ingress-nginx ingress-nginx-controller-qdwws    -- cat template/nginx.tmpl &gt; nginx.tmpl
```
ä¿®æ”¹nginx.tmplï¼Œä¸‹åˆ—access_by_lua_blockéƒ¨åˆ†æ˜¯è¢«æ³¨é‡Šæ‰çš„ï¼Œå»æ‰æ³¨é‡Šï¼Œå¢åŠ plugins.run()
```
location {{ $path }} {
    ...
            # be careful with `access_by_lua_block` and `satisfy any` directives as satisfy any
            # will always succeed when there's `access_by_lua_block` that does not have any lua code doing `ngx.exit(ngx.DECLINED)`
            # other authentication method such as basic auth or external auth useless - all requests will be allowed.
            access_by_lua_block {
                plugins.run()
            }

```
å°†nginx.tmplæ–‡ä»¶æ”¾åˆ°configmapä¸­
```
kubectl create cm -n ingress-nginx nginx-custom-template-config --from-file nginx.tmpl
```
ä¿®æ”¹ingress-nginx-controllerçš„dsï¼Œå¢åŠ nginx-configmapçš„æŒ‚è½½ï¼Œä¿å­˜å¦‚ä¸‹æ–‡ä»¶ä¸ºingress-volume-patch.yamlåæ‰§è¡Œ`kubectl patch -n ingress-nginx daemonsets.apps ingress-nginx-controller  --patch-file ingress-volume-patch.yaml`
```
spec:
  template:
    spec:
      containers:
      - name: ingress-nginx-controller
        volumeMounts:
        - name: nginx-custom-template
          mountPath: /etc/nginx/template/nginx.tmpl
          subPath: nginx.tmpl
      volumes:
      - name: nginx-custom-template
        configMap:
          name: nginx-custom-template-config
```

## å¢åŠ è‡ªå®šä¹‰æ’ä»¶å¹¶å¯ç”¨
### å¢åŠ æ’ä»¶ï¼ˆæ’ä»¶ä¸­ä»£ç è¿˜éœ€è¦è°ƒè¯•ä¼˜åŒ–ï¼‰
åˆ›å»ºå¦‚ä¸‹ConfigMapï¼Œå¿…é¡»ä¸ºmain.luaï¼Œé€šè¿‡å®šä¹‰å¹¶è¿”å›`_M`æ¥å¯¼å‡ºå‡½æ•°

è„šæœ¬è¯´æ˜:
* é…ç½®åŠ è½½æœºåˆ¶ï¼š
    * ä»ç¼“å­˜è·å–é…ç½®ï¼Œç¼“å­˜è¿‡æœŸæ—¶é—´ä¸º 30 ç§’
    * ç¼“å­˜æœªå‘½ä¸­æ—¶ä»æ–‡ä»¶è¯»å–é…ç½®å¹¶æ›´æ–°ç¼“å­˜
* æ ¸å¿ƒé€»è¾‘ï¼š
    * åˆ¤æ–­å½“å‰è¯·æ±‚çš„åŸŸåæ˜¯å¦å±äºä½ä¼˜å…ˆçº§åˆ—è¡¨
    * å¢åŠ å…¨å±€è¿æ¥è®¡æ•°å’Œï¼ˆå¦‚æœæ˜¯ä½ä¼˜å…ˆçº§ï¼‰ä½ä¼˜å…ˆçº§è¿æ¥è®¡æ•°
    * å½“å…¨å±€è¿æ¥æ•°è¶…è¿‡8000ä¸”ä½ä¼˜å…ˆçº§è¿æ¥æ•°è¶…è¿‡3000ï¼Œè¿”å› 503 é”™è¯¯
```
apiVersion: v1
kind: ConfigMap
metadata:
  name: ingress-nginx-plugins
  namespace: ingress-nginx
  labels:
    app.kubernetes.io/part-of: ingress-nginx
    app.kubernetes.io/component: controller
data:
  main.lua: |
    local ngx = ngx
    local cjson = require 'cjson'
    local _M = {}
    local CONFIG_TTL = 30

    -- è¯»å–é…ç½®
    local function get_config()
      local CONFIG_PATH = '/etc/nginx/conf.d/conn_limit_config.json'
      local config_cache = ngx.shared.config_cache
      local cached = config_cache:get('config')
      if cached then
          return cjson.decode(cached)
      end
      local file = io.open(CONFIG_PATH, 'r')
      if not file then
          ngx.log(ngx.ERR, 'æ— æ³•è¯»å–é…ç½®æ–‡ä»¶: ', CONFIG_PATH)
          ngx.exit(500)
      end
      local content = file:read('*a')
      file:close()
      local config = cjson.decode(content)
      config_cache:set('config', content, CONFIG_TTL)
      return config
    end

    -- åˆ¤æ–­åŸŸåæ˜¯å¦åœ¨åˆ—è¡¨ä¸­
    local function is_in_list(domain, list)
      for _, d in ipairs(list) do
          if d == domain then return true end
      end
      return false
    end

    -- æ¸…ç†è®¡æ•°
    local function cleanup(is_low, host)
      local low_conns = ngx.shared.low_conns
      local global_conns = ngx.shared.global_conns
      local new_global = global_conns:incr('total', -1, 0) or 0
      local new_low = is_low and (low_conns:incr('count', -1, 0) or 0) or 0
      ngx.log(ngx.INFO, '[ç»“æŸé˜¶æ®µè®¡æ•°] Host: ', host or '',
              ' | å…¨å±€è¿æ¥=', new_global,
              ' | ä½ä¼˜è¿æ¥=', new_low)
    end

    -- access é˜¶æ®µï¼šè¿æ¥æ•°ç»Ÿè®¡ä¸é™æµ
    function _M.access()
      ngx.log(ngx.INFO, '[conn-limit-TEST] access é˜¶æ®µæ‰§è¡Œï¼')  -- æ–°å¢æµ‹è¯•æ—¥å¿—
      local low_conns = ngx.shared.low_conns
      local global_conns = ngx.shared.global_conns
      local config = get_config()
      local host = ngx.var.host or ''
      local is_low = is_in_list(host, config.low_priority.domains or {})

      local global_threshold = config.global_threshold or 1
      local low_max = config.low_priority.max_conns or 1

      -- å¢åŠ è®¡æ•°
      local current_global = global_conns:incr('total', 1, 0)
      local current_low = is_low and low_conns:incr('count', 1, 0) or 0

      ngx.log(ngx.INFO, '[è®¿é—®é˜¶æ®µè®¡æ•°] Host: ', host,
              ' | å…¨å±€è¿æ¥=', current_global,
              ' | ä½ä¼˜è¿æ¥=', current_low)

      -- é™åˆ¶ä½ä¼˜è¯·æ±‚
      if current_global &gt;= global_threshold and is_low and current_low &gt; low_max then
          ngx.log(ngx.WARN, '[æ‹’ç»è¯·æ±‚] Host=', host,
                  ' | å…¨å±€=', current_global,
                  ' | ä½ä¼˜=', current_low)
          cleanup(is_low, host)
          ngx.status = 503
          ngx.say('Service busy (low-prio quota exceeded: ', current_low, '/', low_max, ')')
          return ngx.exit(503)
      end

      -- ä¿å­˜ä¸Šä¸‹æ–‡
      ngx.ctx.host = host
      ngx.ctx.is_low = is_low
    end

    -- log é˜¶æ®µï¼šè¿æ¥æ•°é‡Šæ”¾
    function _M.log()
      local host = ngx.ctx.host
      local is_low = ngx.ctx.is_low
      if host then
          cleanup(is_low, host)
      end
    end
    -- å®¢æˆ·ç«¯ä¸­æ–­å¤„ç†
    function on_abort_phase()
      local host = ngx.ctx.host
      local is_low = ngx.ctx.is_low
      if host then
          ngx.log(ngx.WARN, '[å®¢æˆ·ç«¯ä¸­æ–­] Host=', host)
          cleanup(is_low, host)
      end
    end
    return _M
```
æŒ‚è½½åˆ°ingress-nginx-controllerçš„dsä¸­ï¼Œä¿å­˜å¦‚ä¸‹æ–‡ä»¶ä¸ºingress-plugins-patch.yamlåæ‰§è¡Œ`kubectl patch -n ingress-nginx daemonsets.apps ingress-nginx-controller --patch-file ingress-plugins-patch.yaml`
```
spec:
  template:
    spec:
      containers:
      - name: ingress-nginx-controller
        volumeMounts:
        - name: plugin-volume
          mountPath: /etc/nginx/lua/plugins/dynamic_conn_limit/main.lua ##å¿…é¡»åœ¨/etc/nginx/lua/plugins/ä¸‹é¢ï¼Œç›®å½•ä¸ºæ’ä»¶åç§°ï¼Œæ–‡ä»¶ä¸ºmain.lua
          subPath: main.lua
      volumes:
      - name: plugin-volume
        configMap:
          name: ingress-nginx-plugins
```
### å¯ç”¨æ’ä»¶
ä¿®æ”¹ingress-nginx-controllerçš„é…ç½®`kubectl edit cm -n ingress-nginx ingress-nginx`å¢åŠ å­—æ®µ`plugins: dynamic_conn_limit`ä»¥åŠ`lua-shared-dicts: global_conns:10m,low_conns:10m,config_cache:10m`å¢åŠ å…±äº«å†…å­˜
### é…ç½®æ–‡ä»¶
åˆ›å»ºå¦‚ä¸‹ConfigMap,é…ç½®å…¨å±€è¿æ¥æ•°ä¸º8000ï¼Œnginx1.orgä¸ºé«˜ä¼˜åŸŸåï¼Œnginx.orgä¸ºä½ä¼˜åŸŸåï¼Œä½ä¼˜åŸŸåæœ€å¤§è¿æ¥æ•°ä¸º3000ï¼Œå®ç°
```
apiVersion: v1
kind: ConfigMap
metadata:
  name: ingress-nginx-conn-config
  namespace: ingress-nginx
data:
  conn_limit_config.json: |
    {
      'global_threshold': 8000,
      'high_priority_domains': ['nginx1.org'],
      'low_priority': {
        'domains': ['nginx.org'],
        'max_conns': 3000
      }
    }
```

##  æ³¨è§£ä¸­æ’å…¥luaè„šæœ¬å³å¯åœ¨accessé˜¶æ®µæ‰§è¡Œä¸‹é¢è„šæœ¬ï¼ˆä¸é€‚ç”¨ä¼˜å…ˆçº§åˆ†æµï¼‰
```
     nginx.ingress.kubernetes.io/server-snippet: |
      access_by_lua_file /etc/nginx/lua/scripts/dynamic-conn-limit.lua;
```
æ‰‹åŠ¨å°†è„šæœ¬æŒ‚è½½è¿›å»å³å¯ï¼Œå…·ä½“æ­¥éª¤å‚è€ƒæ–‡æ¡£ä¸Šé¢ï¼Œæ­¤ç§æ–¹æ³•åªèƒ½åœ¨accessé˜¶æ®µæ‰§è¡Œï¼Œå½“è¿æ¥é‡Šæ”¾æ—¶ï¼Œå­˜å‚¨çš„è¿æ¥æ•°å˜é‡æ— æ³•å‡å°‘ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/83.html</guid><pubDate>Wed, 24 Sep 2025 05:35:34 +0000</pubDate></item><item><title>å‘½ä»¤è¡Œsshä¹‹åè‡ªåŠ¨ä¿®æ”¹æ ‡é¢˜</title><link>https://longxiucai.github.io/post/82.html</link><description>ä¿®æ”¹/etc/ssh/ssh_config (å‚è€ƒhttps://linux.die.net/man/5/ssh_config)
```
Host *git*  ##æ­¤æ¬¡æŒ‰éœ€é€‰æ‹©æ˜¯å¦é…ç½®ï¼Œgitå‘½ä»¤å¦‚æœä½¿ç”¨sshåè®®çš„è¿œç«¯æŠ¥é”™
    PermitLocalCommand no

Host *
    PermitLocalCommand yes
    LocalCommand echo -ne '\033]0;$(echo %r@%h)\007' 
```

è¿™ä¸ªå‘½ä»¤ä¹‹æ‰€ä»¥ä»¥ä¿®æ”¹ç»ˆç«¯æ ‡é¢˜ï¼Œæ˜¯å› ä¸ºå®ƒåˆ©ç”¨äº†ç»ˆç«¯æ”¯æŒçš„**ANSIè½¬ä¹‰åºåˆ—**ï¼ˆANSI escape codesï¼‰æ¥ä¸ç»ˆç«¯è¿›è¡Œé€šä¿¡ï¼ŒæŒ‡ç¤ºç»ˆç«¯æ‰§è¡Œç‰¹å®šæ“ä½œï¼ˆè¿™é‡Œæ˜¯ä¿®æ”¹çª—å£æ ‡é¢˜ï¼‰ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/82.html</guid><pubDate>Thu, 04 Sep 2025 03:28:34 +0000</pubDate></item><item><title>libvirtä½¿ç”¨ovsæ¡¥æ¥ï¼Œipv6æµ‹è¯•æ— æ³•è¿é€šé—®é¢˜åˆ†æ</title><link>https://longxiucai.github.io/post/81.html</link><description>nmcli connection modify enp1s0 ipv6.method manual ipv6.addresses 2003:db8::37/64
nmcli connection up enp1s0 



è™šæ‹Ÿæœºç½‘å¡é…ç½®ï¼Œå¤šå°è™šæ‹Ÿæœºä½¿ç”¨æ­¤é…ç½®æ¡¥æ¥åˆ°ovs-br0ï¼Œé…ç½®ipv6ï¼ˆæ— ç½‘å…³ï¼‰ä¹‹åï¼Œipv6ä¹‹é—´ä¸é€šã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/81.html</guid><pubDate>Tue, 26 Aug 2025 05:24:29 +0000</pubDate></item><item><title>apisix-controlleré»‘ç™½åå•é…ç½®</title><link>https://longxiucai.github.io/post/80.html</link><description>å‚è€ƒï¼š https://apache-apisix.netlify.app/docs/apisix/3.10/plugins/ip-restriction/
# éƒ¨ç½²nginxçš„podå¹¶é…ç½®apisixèµ„æº
```
apiVersion: v1
kind: Namespace
metadata:
  name: nginx-example2
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: nginx-example2
  name: nginx
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.23.1
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: nginx-service
  namespace: nginx-example2
spec:
  selector:
    app: nginx
  ports:
  - protocol: TCP
    port: 80
    targetPort: 80
  type: NodePort
---
# nginx-upstream.yaml
apiVersion: apisix.apache.org/v2beta3
kind: ApisixUpstream
metadata:
  name: nginx-service
  namespace: nginx-example2
spec:
  timeout:
    connect: 600s
    read: 600s
    send: 600s
---
# nginx-route.yaml
apiVersion: apisix.apache.org/v2beta3
kind: ApisixRoute
metadata:
  name: nginx-route
  namespace: nginx-example2
spec:
  http:
    - name: nginx-route
      match:
        hosts:
          - server2.nginx.local
        paths:
          - /*
      backends:
        - serviceName: nginx-service
          servicePort: 80
      plugins:
        - config:
#            blacklist:
#              - '10.42.120.46'
            whitelist:
              - '10.42.189.0/24'
            message: 'Access denied' #æ‹’ç»è®¿é—®æ—¶è¿”å›çš„æ¶ˆæ¯
          enable: true
          name: ip-restriction #ä¸èƒ½æ”¹ï¼Œæ’ä»¶çš„åå­—ï¼Œå›ºå®š
```
# è¯´æ˜
blacklisté…ç½®é»‘åå•ã€whitelisté…ç½®ç™½åå•ï¼Œå€¼éƒ½æ˜¯åˆ—è¡¨ï¼Œæ”¯æŒå•ä¸ªipåœ°å€ä»¥åŠcidrï¼ˆxx.xx.xx.xx/xxï¼‰
## ç™½åå•
ä¸Šè¿°å…³é”®é…ç½®å¦‚ä¸‹ï¼Œ**éœ€è¦ç»™å“ªä¸ªè·¯ç”±é…ç½®é»‘ç™½åå•ï¼Œåˆ™ç›´æ¥editå¯¹åº”çš„èµ„æºæ·»åŠ å¦‚ä¸‹pluginså­—æ®µå³å¯**ï¼š
```
      plugins:
        - config:
#            blacklist:
#              - '10.42.120.46'
            whitelist:
              - '10.42.189.0/24'
            message: 'Access denied'  #æ‹’ç»è®¿é—®æ—¶è¿”å›çš„æ¶ˆæ¯
          enable: true
          name: ip-restriction  #ä¸èƒ½æ”¹ï¼Œæ’ä»¶çš„åå­—ï¼Œå›ºå®š
```
é…ç½®äº†`10.42.189.0/24`ç½‘æ®µç™½åå•ï¼Œåªèƒ½è¿™ä¸ªç½‘æ®µèƒ½è®¿é—®
æ‰§è¡Œ`curl -H 'Host: server2.nginx.local' master-ip:apisixç½‘å…³ç«¯å£`éªŒè¯è®¿é—®
* åœ¨10.42.189.30ä¸Šæ‰§è¡Œè¯·æ±‚æˆåŠŸ
* åœ¨10.42.189.34ä¸Šæ‰§è¡Œè¯·æ±‚æˆåŠŸ
* åœ¨10.42.120.46ä¸Šæ‰§è¡Œè¯·æ±‚å¤±è´¥ï¼Œè¿”å›ï¼š`{'message':'Access denied'}`

## é»‘åå•
```
      plugins:
        - config:
            blacklist:
              - '10.42.120.46'
            message: 'Access denied' #æ‹’ç»è®¿é—®æ—¶è¿”å›çš„æ¶ˆæ¯
          enable: true
          name: ip-restriction #ä¸èƒ½æ”¹ï¼Œæ’ä»¶çš„åå­—ï¼Œå›ºå®š
```
éªŒè¯ï¼š
* åœ¨10.42.120.46ä¸Šæ‰§è¡Œè¯·æ±‚å¤±è´¥ï¼Œè¿”å›ï¼š`{'message':'Access denied'}`
* å…¶ä»–ä»»æ„ipå‡èƒ½è®¿é—®ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/80.html</guid><pubDate>Fri, 22 Aug 2025 02:53:35 +0000</pubDate></item><item><title>ä¿®æ”¹cert-managerè¯ä¹¦è¿‡æœŸæ—¶é—´ï¼Œåˆ é™¤å¯¹åº”secretè®©å…¶ç«‹é©¬æ–°å»ºè¯ä¹¦</title><link>https://longxiucai.github.io/post/79.html</link><description>```
#!/bin/bash

# é…ç½®éƒ¨åˆ† - åœ¨è¿™é‡Œè®¾ç½®ç›®æ ‡æœˆæ•°
TARGET_MONTHS=240  # ä¾‹å¦‚240ä¸ªæœˆ=20å¹´
# å¤‡ä»½ç›®å½•
BACKUP_DIR='./secret_backups'

# è®¡ç®—å°æ—¶æ•°ï¼ˆ1ä¸ªæœˆæŒ‰30å¤©è®¡ç®—ï¼Œ1å¤©=24å°æ—¶ï¼‰
HOURS_PER_MONTH=$((30 * 24))  # 720å°æ—¶/æœˆ
TARGET_DURATION=$((TARGET_MONTHS * HOURS_PER_MONTH))'h'

# åˆ›å»ºæ—¥å¿—æ–‡ä»¶
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
LOG_FILE='certificate_update_${TIMESTAMP}.log'
# ===== æ–°å¢ï¼šè‡ªåŠ¨åˆ›å»ºå¤‡ä»½ç›®å½• &amp; åˆå§‹åŒ–æ—¥å¿— =====
mkdir -p ${BACKUP_DIR} &amp;&amp; chmod 755 ${BACKUP_DIR}
echo '===== è¯ä¹¦æ›´æ–°æ“ä½œæ—¥å¿— - $(date) =====' &gt; '$LOG_FILE'
echo 'ç›®æ ‡æœ‰æ•ˆæœŸ: $TARGET_MONTHS ä¸ªæœˆ ($TARGET_DURATION)' &gt;&gt; '$LOG_FILE'
echo 'Secretå¤‡ä»½ç›®å½•: $(realpath ${BACKUP_DIR})' &gt;&gt; '$LOG_FILE'
echo '====================================' &gt;&gt; '$LOG_FILE'
echo '' &gt;&gt; '$LOG_FILE'

mkdir -p $BACKUP_DIR

backup_secret() {
    local ns=$1
    local secret=$2
    local backup_file='${BACKUP_DIR}/${ns}_${secret}_${TIMESTAMP}.yaml'
    
    echo '  ğŸ“¦ å¤‡ä»½secret $ns/$secret åˆ°æœ¬åœ°...'
    # å®Œæ•´å¤‡ä»½Secretçš„æ‰€æœ‰å†…å®¹ï¼ˆYAMLæ ¼å¼ï¼Œå¯ç›´æ¥kubectl applyæ¢å¤ï¼‰
    if kubectl get secret '$secret' -n '$ns' -o yaml &gt; '${backup_file}' 2&gt;&amp;1; then
        echo '  âœ… å¤‡ä»½æˆåŠŸ: ${backup_file}'
        echo '  å¤‡ä»½SecretæˆåŠŸ: $(realpath ${backup_file})' &gt;&gt; '$LOG_FILE'
        return 0
    else
        echo '  âš ï¸ è­¦å‘Šï¼šsecret $ns/$secret å¤‡ä»½å¤±è´¥ï¼'
        echo '  è­¦å‘Šï¼šSecretå¤‡ä»½å¤±è´¥ $ns/$secret' &gt;&gt; '$LOG_FILE'
        return 1
    fi
}

# å‡½æ•°ï¼šç­‰å¾…secretåˆ›å»º
wait_for_secret() {
    local ns=$1
    local secret=$2
    local timeout=30
    local interval=2
    local count=0
    
    echo '  ç­‰å¾…secret $ns/$secret ç”Ÿæˆ...'
    while ! kubectl get secret '$secret' -n '$ns' &gt;/dev/null 2&gt;&amp;1; do
        sleep $interval
        count=$((count + interval))
        if [ $count -ge $timeout ]; then
            echo '  âš ï¸ è¶…æ—¶ï¼šsecret $ns/$secret æœªåœ¨ $timeout ç§’å†…ç”Ÿæˆ'
            echo 'è¶…æ—¶ï¼šsecret $ns/$secret æœªç”Ÿæˆ' &gt;&gt; '$LOG_FILE'
            return 1
        fi
    done
    echo '  âœ… secret $ns/$secret å·²ç”Ÿæˆ'
    return 0
}

# å‡½æ•°ï¼šæ£€æŸ¥è¯ä¹¦è¿‡æœŸæ—¶é—´
check_cert_expiry() {
    local ns=$1
    local secret=$2
    
    # æå–å¹¶è§£ç è¯ä¹¦
    cert_data=$(kubectl get secret '$secret' -n '$ns' -o jsonpath='{.data.tls\.crt}')
    if [ -z '$cert_data' ]; then
        echo '  âŒ æ— æ³•ä» $ns/$secret è·å–è¯ä¹¦æ•°æ®'
        echo 'é”™è¯¯ï¼šæ— æ³•ä» $ns/$secret è·å–è¯ä¹¦æ•°æ®' &gt;&gt; '$LOG_FILE'
        return 1
    fi
    
    # è§£ç å¹¶æ£€æŸ¥æœ‰æ•ˆæœŸ
    expiry_date=$(echo '$cert_data' | base64 -d | openssl x509 -noout -enddate | cut -d= -f2)
    if [ -z '$expiry_date' ]; then
        echo '  âŒ æ— æ³•è§£æ $ns/$secret çš„è¯ä¹¦è¿‡æœŸæ—¶é—´'
        echo 'é”™è¯¯ï¼šæ— æ³•è§£æ $ns/$secret çš„è¯ä¹¦è¿‡æœŸæ—¶é—´' &gt;&gt; '$LOG_FILE'
        return 1
    fi
    
    # è½¬æ¢ä¸ºæ—¶é—´æˆ³ä»¥ä¾¿è®¡ç®—
    expiry_timestamp=$(date -d '$expiry_date' +%s)
    current_timestamp=$(date +%s)
    days_remaining=$(( (expiry_timestamp - current_timestamp) / 86400 ))
    
    echo '  ******** è¯ä¹¦ $ns/$secret è¿‡æœŸæ—¶é—´: $expiry_date (çº¦ $days_remaining å¤©)'
    echo '$ns/$secret è¿‡æœŸæ—¶é—´: $expiry_date (çº¦ $days_remaining å¤©)' &gt;&gt; '$LOG_FILE'
    return 0
}

# è·å–æ‰€æœ‰å‘½åç©ºé—´
namespaces=$(kubectl get namespaces -o jsonpath='{.items[*].metadata.name}')
# æŒ‡å®šå‘½åns
# namespaces='test1  test2'

# è®°å½•æ€»æ•°ç»Ÿè®¡
total_certs=0
updated_certs=0
failed_certs=0

echo '===== å¼€å§‹è¯ä¹¦æ›´æ–°æµç¨‹ ====='
echo 'ç›®æ ‡æœ‰æ•ˆæœŸ: $TARGET_MONTHS ä¸ªæœˆ ($TARGET_DURATION)'
echo 'Secretå¤‡ä»½ç›®å½•: $(realpath ${BACKUP_DIR})'
echo 'æ—¥å¿—å°†ä¿å­˜è‡³: $LOG_FILE'
echo ''

# éå†æ‰€æœ‰å‘½åç©ºé—´
for ns in $namespaces; do
    echo 'å¤„ç†å‘½åç©ºé—´: $ns'
    echo 'å¤„ç†å‘½åç©ºé—´: $ns' &gt;&gt; '$LOG_FILE'
    
    # è·å–å½“å‰å‘½åç©ºé—´ä¸­çš„æ‰€æœ‰Certificateèµ„æº
    certs=$(kubectl get certificates -n '$ns' -o jsonpath='{.items[*].metadata.name}')
    
    if [ -z '$certs' ]; then
        echo '  æœªå‘ç°Certificateèµ„æºï¼Œè·³è¿‡'
        echo '  æœªå‘ç°Certificateèµ„æºï¼Œè·³è¿‡' &gt;&gt; '$LOG_FILE'
        echo ''
        continue
    fi
    
    # éå†æ¯ä¸ªCertificateèµ„æº
    for cert in $certs; do
        total_certs=$((total_certs + 1))
        echo '  å¤„ç†Certificate: $cert'
        echo '  å¤„ç†Certificate: $cert' &gt;&gt; '$LOG_FILE'
        
        # è·å–å½“å‰duration
        current_duration=$(kubectl get certificate '$cert' -n '$ns' -o jsonpath='{.spec.duration}')
        
        # è·å–å…³è”çš„secretåç§°
        secret_name=$(kubectl get certificate '$cert' -n '$ns' -o jsonpath='{.spec.secretName}')
        if [ -z '$secret_name' ]; then
            echo '  âŒ æ— æ³•è·å– $ns/$cert å…³è”çš„secretåç§°'
            echo '  é”™è¯¯ï¼šæ— æ³•è·å–å…³è”çš„secretåç§°' &gt;&gt; '$LOG_FILE'
            failed_certs=$((failed_certs + 1))
            continue
        fi
        
        # å¦‚æœå½“å‰durationä¸ç›®æ ‡ä¸åŒï¼Œåˆ™è¿›è¡Œæ›´æ–°
        if [ '$current_duration' != '$TARGET_DURATION' ]; then
            # ä½¿ç”¨kubectl patchæ›´æ–°duration
                backup_secret '$ns' '$secret_name'
            if kubectl patch certificate '$cert' -n '$ns' --type=merge -p '{\'spec\':{\'duration\':\'$TARGET_DURATION\'}}'; then
                echo '  âœ… å·²æ›´æ–° $ns/$cert: $current_duration -&gt; $TARGET_DURATION'
                echo '  å·²æ›´æ–°: $current_duration -&gt; $TARGET_DURATION' &gt;&gt; '$LOG_FILE'
                
                backup_secret '$ns' '$secret_name'
                
                # åˆ é™¤secretè§¦å‘æ›´æ–°
                echo '  åˆ é™¤secret $secret_name ä»¥è§¦å‘è¯ä¹¦æ›´æ–°...'
                if kubectl delete secret '$secret_name' -n '$ns' &gt;/dev/null 2&gt;&amp;1; then
                    echo '  å·²åˆ é™¤secret $secret_name'
                    echo '  å·²åˆ é™¤secret: $secret_name' &gt;&gt; '$LOG_FILE'
                    
                    # ç­‰å¾…æ–°secretç”Ÿæˆ
                    if wait_for_secret '$ns' '$secret_name'; then
                        # æ£€æŸ¥æ–°è¯ä¹¦çš„è¿‡æœŸæ—¶é—´
                        check_cert_expiry '$ns' '$secret_name'
                    fi
                    updated_certs=$((updated_certs + 1))
                else
                    echo '  âŒ æ— æ³•åˆ é™¤secret $secret_name'
                    echo '  é”™è¯¯ï¼šæ— æ³•åˆ é™¤secret $secret_name' &gt;&gt; '$LOG_FILE'
                    failed_certs=$((failed_certs + 1))
                fi
            else
                echo '  âŒ æ›´æ–° $ns/$cert å¤±è´¥'
                echo '  é”™è¯¯ï¼šæ›´æ–°Certificateå¤±è´¥' &gt;&gt; '$LOG_FILE'
                failed_certs=$((failed_certs + 1))
            fi
        else
            echo '  â­ï¸ $ns/$cert å·²ä¸ºç›®æ ‡æœ‰æ•ˆæœŸï¼Œæ— éœ€æ›´æ–°'
            echo '  æ— éœ€æ›´æ–°ï¼šå·²ä¸ºç›®æ ‡æœ‰æ•ˆæœŸ' &gt;&gt; '$LOG_FILE'
            # æ£€æŸ¥å½“å‰è¯ä¹¦çš„è¿‡æœŸæ—¶é—´
            check_cert_expiry '$ns' '$secret_name'
        fi
        echo ''
        echo '' &gt;&gt; '$LOG_FILE'
    done
done

# è¾“å‡ºæ€»ç»“ä¿¡æ¯
echo '===== æ“ä½œå®Œæˆ ====='
echo 'æ€»å¤„ç†Certificateèµ„æº: $total_certs'
echo 'æˆåŠŸæ›´æ–°: $updated_certs'
echo 'æ›´æ–°å¤±è´¥: $failed_certs'
echo 'Secretå¤‡ä»½ç›®å½•: $(realpath ${BACKUP_DIR})'
echo 'Certificateèµ„æºå¦‚ä¸‹'
kubectl get certificates --all-namespaces -o jsonpath='{range .items[*]}{.metadata.namespace}{'/'}{.metadata.name}{' '}{.spec.duration}{'\n'}{end}'
echo 'è¯¦ç»†æ—¥å¿—: $LOG_FILE'

echo ''
echo 'æ›´æ–°æ€»ç»“:' &gt;&gt; '$LOG_FILE'
echo 'æ€»å¤„ç†Certificateèµ„æº: $total_certs' &gt;&gt; '$LOG_FILE'
echo 'æˆåŠŸæ›´æ–°: $updated_certs' &gt;&gt; '$LOG_FILE'
echo 'æ›´æ–°å¤±è´¥: $failed_certs' &gt;&gt; '$LOG_FILE'
echo 'Secretå¤‡ä»½ç›®å½•: $(realpath ${BACKUP_DIR})' &gt;&gt; '$LOG_FILE'
echo 'æ“ä½œå®Œæˆæ—¶é—´: $(date)' &gt;&gt; '$LOG_FILE'

```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/79.html</guid><pubDate>Thu, 21 Aug 2025 05:35:05 +0000</pubDate></item><item><title>å¯¼å‡ºcert-manageråˆ›å»ºçš„è¯ä¹¦</title><link>https://longxiucai.github.io/post/78.html</link><description>```
#!/bin/bash

# åˆ›å»ºä¸€ä¸ªç›®å½•å­˜æ”¾å¯¼å‡ºçš„è¯ä¹¦
mkdir -p exported_certificates
cd exported_certificates || exit

# è·å–æ‰€æœ‰å‘½åç©ºé—´
namespaces=$(kubectl get namespaces -o jsonpath='{.items[*].metadata.name}')

# éå†æ¯ä¸ªå‘½åç©ºé—´
for ns in $namespaces; do
    echo 'Processing namespace: $ns'
    
    # è·å–è¯¥å‘½åç©ºé—´ä¸­æ‰€æœ‰åŒ…å«tlsè¯ä¹¦çš„secretï¼ˆä½¿ç”¨ä¸´æ—¶æ–‡ä»¶é¿å…ç®¡é“ä¸ºç©ºçš„é—®é¢˜ï¼‰
    temp_file=$(mktemp)
    kubectl get secrets -n '$ns' -o jsonpath='{range .items[?(@.type=='kubernetes.io/tls')]}{.metadata.name}{'\n'}{end}' 2&gt;/dev/null &gt; '$temp_file'
    secrets=$(cat '$temp_file')
    rm '$temp_file'
    
    # å¦‚æœæœ‰ç¬¦åˆæ¡ä»¶çš„secretï¼Œè¿›è¡Œå¤„ç†
    if [ -n '$secrets' ]; then
        # ä¸ºæ¯ä¸ªå‘½åç©ºé—´åˆ›å»ºå­ç›®å½•
        mkdir -p '$ns'
        cd '$ns' || continue
        
        # éå†æ¯ä¸ªsecret
        while IFS= read -r secret; do
            echo '  Exporting secret: $secret'
            
            # å¯¼å‡ºCAè¯ä¹¦ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if kubectl get secret '$secret' -n '$ns' -o jsonpath='{.data.ca\.crt}' &gt; /dev/null 2&gt;&amp;1; then
                kubectl get secret '$secret' -n '$ns' -o jsonpath='{.data.ca\.crt}' | base64 -d &gt; '${ns}_${secret}_ca.crt'
            fi
            
            # å¯¼å‡ºtlsè¯ä¹¦
            kubectl get secret '$secret' -n '$ns' -o jsonpath='{.data.tls\.crt}' | base64 -d &gt; '${ns}_${secret}_tls.crt'
            
            # å¯¼å‡ºtlsç§é’¥
            kubectl get secret '$secret' -n '$ns' -o jsonpath='{.data.tls\.key}' | base64 -d &gt; '${ns}_${secret}_tls.key'
        done &lt;&lt;&lt; '$secrets'
        
        cd .. || exit
    else
        echo '  No TLS secrets found in namespace: $ns'
    fi
done

echo 'Certificate export completed. Files are in exported_certificates directory.'
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/78.html</guid><pubDate>Thu, 21 Aug 2025 03:41:33 +0000</pubDate></item><item><title>kubernetes Canary</title><link>https://longxiucai.github.io/post/77.html</link><description>å‚è€ƒ ï¼š https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#canary
## åˆ›å»º2ä¸ªnginxç‰ˆæœ¬åˆ†åˆ«ä¸ºv1ä¸v2
```
# Nginx v1 é…ç½®
apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-config-v1
data:
  index.html: |
    &lt;p class='version'&gt;This is Nginx Version 1.0&lt;/p&gt;
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-v1
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx
      version: v1
  template:
    metadata:
      labels:
        app: nginx
        version: v1
    spec:
      containers:
      - name: nginx
        image: registry.kylincloud.org:4001/kcc/images/nginx:1.23.1
        ports:
        - containerPort: 80
        volumeMounts:
        - name: nginx-html-v1
          mountPath: /usr/share/nginx/html
      volumes:
      - name: nginx-html-v1
        configMap:
          name: nginx-config-v1
---
apiVersion: v1
kind: Service
metadata:
  name: nginx-service-v1
spec:
  selector:
    app: nginx
    version: v1
  ports:
  - port: 80
    targetPort: 80
  type: NodePort
---

# Nginx v2 é…ç½®
apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-config-v2
data:
  index.html: |
    &lt;p class='version'&gt;This is Nginx Version 2.0&lt;/p&gt;
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-v2
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx
      version: v2
  template:
    metadata:
      labels:
        app: nginx
        version: v2
    spec:
      containers:
      - name: nginx
        image: registry.kylincloud.org:4001/kcc/images/nginx:1.23.1
        ports:
        - containerPort: 80
        volumeMounts:
        - name: nginx-html-v2
          mountPath: /usr/share/nginx/html
      volumes:
      - name: nginx-html-v2
        configMap:
          name: nginx-config-v2
---
apiVersion: v1
kind: Service
metadata:
  name: nginx-service-v2
spec:
  selector:
    app: nginx
    version: v2
  ports:
  - port: 80
    targetPort: 80
  type: NodePort
```

## åˆ›å»ºingress
```
# ç¬¬ä¸€ä¸ªIngresså®šä¹‰ï¼Œç”¨äºå¸¸è§„æœåŠ¡
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: canary-v1  # å®šä¹‰Ingressçš„åç§°
spec:
  ingressClassName: ingress-nginx
  rules:
  - host: nginx.lyx.com  # è®¾ç½®ä¸»æœºåï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘åˆ°è¿™ä¸ªåŸŸåä¸‹çš„æœåŠ¡
    http:
      paths:
      - backend:
          service:
            name: nginx-service-v1
            port:
              number: 80  # æŒ‡å®šåç«¯æœåŠ¡ç›‘å¬çš„ç«¯å£
        path: /  # æ‰€æœ‰è®¿é—®æ ¹è·¯å¾„çš„è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘åˆ°æ­¤æœåŠ¡
        pathType: Prefix  # è·¯å¾„ç±»å‹ä¸ºå‰ç¼€ï¼Œè¡¨ç¤ºæ‰€æœ‰ä»¥'/'å¼€å¤´çš„è¯·æ±‚éƒ½å°†è¢«è½¬å‘åˆ°æ­¤æœåŠ¡
```
## æµé‡åˆ‡åˆ†
canaryè§„åˆ™æŒ‰ä¼˜å…ˆçº§é¡ºåºè¿›è¡Œè¯„ä¼°ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/77.html</guid><pubDate>Mon, 11 Aug 2025 07:57:21 +0000</pubDate></item><item><title>promethuesæ•°æ®å¯¼å…¥ä¸å¯¼å‡º</title><link>https://longxiucai.github.io/post/76.html</link><description>
# æ•°æ®å¯¼å‡º
## æ–¹å¼ä¸€ã€é€šè¿‡å¿«ç…§çš„æ–¹æ³•
### å¯åŠ¨admin api
å…ˆåˆ¤æ–­å½“å‰æ˜¯å¦å¯ç”¨äº†admin apiï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨ï¼Œéœ€è¦å¯ç”¨ï¼Œåˆ¤æ–­æ–¹æ³•ï¼š
```
kubectl get pod -n monitoring prometheus-k8s-0 -oyaml|grep admin
```
çœ‹æ˜¯å¦æœ‰`    - --web.enable-admin-api`ï¼Œå¦‚æœæ²¡æœ‰åˆ™éœ€è¦å¯ç”¨ï¼Œå¯ç”¨æ–¹æ³•ï¼š
```
kubectl -n monitoring patch prometheus k8s --type merge --patch '{'spec':{'enableAdminAPI':true}}'
```
### é€šè¿‡apiåˆ›å»ºå¿«ç…§
```
curl -XPOST http://&lt;masterip&gt;:30200/api/v1/admin/tsdb/snapshot
```
è¿”å›:{'status':'success','data':{'name':'20250609T091200Z-462edddd226ddbd5'}} å¯ä»¥åœ¨å®¹å™¨ä¸­/prometheus/snapshots/ä¸­æ‰¾åˆ°è¿™ä¸ªname çš„ç›®å½•
### å°†å¿«ç…§æ•°æ®æ‹·è´å‡ºæ¥ï¼ˆä¸‹é¢æ–¹æ³•äºŒé€‰ä¸€ï¼‰
#### kubectl cp
```
kubectl cp -n monitoring prometheus-k8s-0:/prometheus/snapshots  .
```
&gt; [!TIP]
&gt; é€šè¿‡kubectl cpæ–¹å¼æ—¶ï¼Œå½“å‰ç›®å½•ä¼šå­˜åœ¨`&lt;snapshots-name&gt;`ï¼Œè¿™é‡Œé¢ç›´æ¥æ˜¯å…ƒæ•°æ®ï¼Œä¾‹å¦‚`ls 20250610T022906Z-610813546f16aadd`å¯ä»¥çœ‹åˆ°å¾ˆå¤šç›®å½•ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/76.html</guid><pubDate>Tue, 10 Jun 2025 03:13:51 +0000</pubDate></item><item><title>ingressä»£ç†å¦ä¸€ä¸ªé›†ç¾¤ä¸­ingressä»£ç†æœåŠ¡</title><link>https://longxiucai.github.io/post/75.html</link><description>å‰ææ¡ä»¶ï¼šAç¯å¢ƒä¸­èƒ½å¤Ÿè§£æBæä¾›æœåŠ¡çš„åŸŸå

1.åœ¨Aç¯å¢ƒå¢åŠ ä¸€æ¡å†…éƒ¨â€œsvc-Bâ€çš„serviceèµ„æºï¼Œâ€œsvc-Bâ€çš„spec.typeä¸ºExternalNameã€spec.externalNameä¸ºé›†ç¾¤Bä¸­æœåŠ¡çš„åŸŸååœ°å€ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/75.html</guid><pubDate>Thu, 22 May 2025 07:14:41 +0000</pubDate></item><item><title>åŸŸåè§£æçš„åŸç†ä¸æ•…éšœæ’æŸ¥</title><link>https://longxiucai.github.io/post/74.html</link><description># åŸç†
å¦‚å›¾æ‰€ç¤ºï¼ŒåŸŸåæ˜¯ä¸€ç§æ ‘çŠ¶ç»“æ„ï¼Œæœ€é¡¶å±‚çš„åŸŸåæ˜¯æ ¹åŸŸåï¼ˆæ³¨æ„æ˜¯ä¸€ä¸ªç‚¹â€œ.â€ï¼Œå®ƒæ˜¯ .root çš„å«ä¹‰ï¼Œä¸è¿‡ç°åœ¨â€œ.rootâ€å·²ç»é»˜è®¤è¢«éšè—ï¼‰ï¼Œç„¶åæ˜¯é¡¶çº§åŸŸåï¼ˆTop Level Domainï¼Œç®€å†™ TLDï¼Œä¾‹å¦‚ .comï¼‰ï¼Œå†æ˜¯äºŒçº§åŸŸåï¼ˆä¾‹å¦‚ google.comï¼‰ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/74.html</guid><pubDate>Mon, 12 May 2025 06:06:39 +0000</pubDate></item><item><title>curlå‘½ä»¤å¯¹HTTPSè¯·æ±‚çš„å„ä¸ªé˜¶è¾“å‡ºè¯¦ç»†çš„å»¶è¿Ÿ</title><link>https://longxiucai.github.io/post/73.html</link><description># curl -wå‚æ•°è¯´æ˜
curl å‘½ä»¤æä¾›äº† -w å‚æ•°ï¼Œå…è®¸æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼æ‰“å°ä¸è¯·æ±‚ç›¸å…³çš„ä¿¡æ¯ï¼Œå…¶ä¸­éƒ¨åˆ†ä¿¡æ¯å¯ä»¥é€šè¿‡ç‰¹å®šçš„å˜é‡è¡¨ç¤ºï¼Œå¦‚ status_codeã€size_downloadã€time_namelookup ç­‰ç­‰ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/73.html</guid><pubDate>Mon, 12 May 2025 05:52:00 +0000</pubDate></item><item><title>promethues operatorä¸­alertmanageræŒ‚è½½è‡ªå®šä¹‰æ¨¡æ¿</title><link>https://longxiucai.github.io/post/72.html</link><description>1. åˆ›å»ºæ¨¡æ¿ä¸ºconfigmapï¼Œå†…å®¹å¦‚ä¸‹ï¼Œæ ¹æ®å®é™…éœ€æ±‚ä¿®æ”¹ï¼Œkubectl applyå³å¯
```
apiVersion: v1
kind: ConfigMap
metadata:
  name: alertmanager-templates
  namespace: monitoring  # æ ¹æ®ä½ çš„ Alertmanager å‘½åç©ºé—´è°ƒæ•´
data:
  kubediag.tmpl: |
    {{ define 'kubediag.payload' }}
    {{ .Alerts }}
    {{ end }}
```  
2. ä¿®æ”¹alertmanagerèµ„æºæ·»åŠ configMapsé…ç½®é¡¹ï¼ˆé…ç½®ä¼šæŒ‚è½½åˆ°`/etc/alertmanager/configmaps`ä¸­ï¼‰ï¼Œpatch.yamlæ–‡ä»¶å†…å®¹å¦‚ä¸‹
```
spec:
  configMaps:
  - alertmanager-templates
```
æ‰§è¡Œå‘½ä»¤`kubectl patch alertmanager main -n monitoring --type=merge --patch-file patch.yaml`
3. ä¿®æ”¹alertmanagerçš„é…ç½®ï¼Œæ ¹æ®å®é™…æƒ…å†µï¼Œæˆ‘çš„ç¯å¢ƒä¸ºkubectl get secrets -n monitoring  alertmanager-mainè¿™ä¸ªsecretã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/72.html</guid><pubDate>Tue, 29 Apr 2025 08:36:50 +0000</pubDate></item><item><title>promethues operatorä¸­alertmanagerconfigçš„ä½¿ç”¨</title><link>https://longxiucai.github.io/post/71.html</link><description>1. `kubectl patch alertmanager main -n monitoring --type=merge --patch-file patch.yaml`é…ç½®é€‰æ‹©å“ªäº›alertmanagerConfig

patch.yamlæ–‡ä»¶å†…å®¹å¦‚ä¸‹
```
spec:
  alertmanagerConfigSelector:
    matchLabels:
      alertmanagerConfig: main
```
2. åˆ›å»ºalertmanagerConfigèµ„æºï¼Œèµ„æºéœ€è¦æœ‰ä¸Šè¿°labelï¼š`alertmanagerConfig: main`
```
apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: kubediag-config
  namespace: monitoring
  labels:
    alertmanagerConfig: main
spec:
  route:
    receiver: 'kubediag'
    routes:
      - receiver: 'kubediag'
        matchers: 
        - name: 'strategy_type'
          value: 'user_strategy'
        - name: 'namespace'
          value: default
  receivers:
    - name: 'kubediag'
      webhookConfigs:
       - url: 'http://kubediag-master.kubediag.svc.cluster.local:8089/api/v1/alerts'
          sendResolved: true
          httpConfig:
            tlsConfig:
              insecureSkipVerify: true
          maxAlerts: 0
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/71.html</guid><pubDate>Tue, 29 Apr 2025 08:29:49 +0000</pubDate></item><item><title>k8s podæ—¥å¿—é»˜è®¤å­˜å‚¨å¤§å°</title><link>https://longxiucai.github.io/post/70.html</link><description>kubeadmæœ‰å‚æ•°containerLogMaxSizeï¼ˆé»˜è®¤10Mï¼‰ containerLogMaxFiles(é»˜è®¤5)

containerdæœ¬èº«æ²¡æœ‰ç®¡ç†å®¹å™¨æ—¥å¿—åˆ†å‰²ä¸é™åˆ¶å¤§å°çš„åŠŸèƒ½ï¼Œkubeletæœ‰å‚æ•°`--container-log-max-files=5 --container-log-max-size=100Mi`ä¸é…ç½®`'containerLogMaxSize': '100Mi','containerLogMaxFiles': 5`ï¼ŒéªŒè¯kubeletå¯¹æ—¥å¿—æ§åˆ¶çš„åŠŸèƒ½ï¼Œé»˜è®¤ä¸º400M 4ä¸ªå¤‡ä»½ï¼Œå‹ç¼©ä¹‹å30Mï¼Œä¸å­˜åœ¨ç©ºé—´çˆ†æ»¡çš„æƒ…å†µã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/70.html</guid><pubDate>Wed, 02 Apr 2025 08:21:39 +0000</pubDate></item><item><title>k6æ€§èƒ½æµ‹è¯•å·¥å…·ï¼ˆç¬”è®°ï¼‰</title><link>https://longxiucai.github.io/post/69.html</link><description># Load test types

## Smoke testing

```
import http from 'k6/http';
import { check, sleep } from 'k6';
export const options = {
  vus: 3, // Key for Smoke test. Keep it at 2, 3, max 5 VUs
  duration: '1m', // This can be shorter or just a few iterations
};
export default () =&gt; {
  const urlRes = http.get('https://quickpizza.grafana.com');
  sleep(1);
  // MORE STEPS
  // Add only the processes that will be on high demand
  // Step1
  // Step2
  // etc.
};
```

![The shape of the smoke test as configured in the preceding script](https://grafana.com/media/docs/k6-oss/chart-smoke-test-k6-script-example.png)

## Average-load testing

```
import http from 'k6/http';
import { sleep } from 'k6';
export const options = {
  // Key configurations for avg load test in this section
  stages: [
    { duration: '5m', target: 100 }, // traffic ramp-up from 1 to 100 users over 5 minutes.
    { duration: '30m', target: 100 }, // stay at 100 users for 30 minutes
    { duration: '5m', target: 0 }, // ramp-down to 0 users
  ],
};
export default () =&gt; {
  const urlRes = http.get('https://quickpizza.grafana.com');
  sleep(1);
};
```

![The shape of the average-load test as configured in the preceding script](https://grafana.com/media/docs/k6-oss/chart-average-load-test-k6-script-example.png)

## Stress testing

```
import http from 'k6/http';
import { sleep } from 'k6';

export const options = {
  // Key configurations for Stress in this section
  stages: [
    { duration: '10m', target: 200 }, // traffic ramp-up from 1 to a higher 200 users over 10 minutes.
    { duration: '30m', target: 200 }, // stay at higher 200 users for 30 minutes
    { duration: '5m', target: 0 }, // ramp-down to 0 users
  ],
};

export default () =&gt; {
  const urlRes = http.get('https://quickpizza.grafana.com');
  sleep(1);
};
```

![The shape of the stress test as configured in the preceding script](https://grafana.com/media/docs/k6-oss/chart-stress-test-k6-script-example.png)

## Soak testing

```
import http from 'k6/http';
import { sleep } from 'k6';

export const options = {
  // Key configurations for Soak test in this section
  stages: [
    { duration: '5m', target: 100 }, // traffic ramp-up from 1 to 100 users over 5 minutes.
    { duration: '8h', target: 100 }, // stay at 100 users for 8 hours!!!
    { duration: '5m', target: 0 }, // ramp-down to 0 users
  ],
};

export default () =&gt; {
  const urlRes = http.get('https://quickpizza.grafana.com');
  sleep(1);
};
```

![The shape of the soak test as configured in the preceding script](https://grafana.com/media/docs/k6-oss/chart-soak-test-k6-script-example.png)

## Spike testing

```
import http from 'k6/http';
import { sleep } from 'k6';

export const options = {
  // Key configurations for spike in this section
  stages: [
    { duration: '2m', target: 2000 }, // fast ramp-up to a high point
    // No plateau
    { duration: '1m', target: 0 }, // quick ramp-down to 0 users
  ],
};

export default () =&gt; {
  const urlRes = http.get('https://quickpizza.grafana.com');
  sleep(1);
};
```

![The shape of the spike test as configured in the preceding script](https://grafana.com/media/docs/k6-oss/chart-spike-test-k6-script-example.png)

## Breakpoint testing

```
import http from 'k6/http';
import { sleep } from 'k6';

export const options = {
  // Key configurations for breakpoint in this section
  executor: 'ramping-arrival-rate', //Assure load increase if the system slows
  stages: [
    { duration: '2h', target: 20000 }, // just slowly ramp-up to a HUGE load
  ],
};

export default () =&gt; {
  const urlRes = http.get('https://quickpizza.grafana.com');
  sleep(1);
};
```

![The shape of the breakpoint test as configured in the preceding script](https://grafana.com/media/docs/k6-oss/chart-breakpoint-test-k6-script-example.png)
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/69.html</guid><pubDate>Wed, 05 Mar 2025 05:58:33 +0000</pubDate></item><item><title>ingress controlleré»‘ç™½åå•</title><link>https://longxiucai.github.io/post/68.html</link><description>å‚è€ƒ: https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/

é»‘åå•
æ ¹æ®å®é™…æƒ…å†µï¼Œä¿®æ”¹éœ€è¦é…ç½®é»‘ç™½åå•çš„ingressèµ„æºï¼Œç¤ºä¾‹ï¼š
kubectl  edit  ingresses.networking.k8s.io -n xx xxxxx

å¢åŠ annotationsï¼š
nginx.ingress.kubernetes.io/denylist-source-range: ip1/mask,ip2/mask

ç™½åå•
ä½¿ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œå¢åŠ annotationsï¼š
nginx.ingress.kubernetes.io/whitelist-source-range: ip1/mask,ip2/mask

ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/68.html</guid><pubDate>Tue, 04 Mar 2025 08:02:53 +0000</pubDate></item><item><title>Gmeekä¸­æ–‡å­—spoilerå‰§é€æ•ˆæœ</title><link>https://longxiucai.github.io/post/67.html</link><description>#### å‚è€ƒ
https://hellodk.cn/post/1187

#### é…ç½®
```
    'style':'&lt;style&gt;@import url('https://longxiucai.github.io/spoiler.css');&lt;/style&gt;'
```
#### ä½¿ç”¨
```
æˆ‘æ‰çŸ¥é“å‘¨ä¹Ÿçš„çˆ¶äº²æ˜¯å«`Gmeek-html&lt;span class='spoiler'&gt;å‘¨ç§¦å¿«&lt;/span&gt;`ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/67.html</guid><pubDate>Mon, 03 Mar 2025 08:28:42 +0000</pubDate></item><item><title>mysqld-exporteréƒ¨ç½²ï¼ˆpromethues operator|multi-targetï¼‰</title><link>https://longxiucai.github.io/post/66.html</link><description>å‡†å¤‡
--

æ‚¨ä¹Ÿå¯ä»¥åœ¨æ‚¨çš„äº‘æœåŠ¡å™¨ä¸­é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œæˆæƒã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/66.html</guid><pubDate>Mon, 03 Mar 2025 06:50:36 +0000</pubDate></item><item><title>åˆ é™¤k8s namespaceå¡ä½</title><link>https://longxiucai.github.io/post/65.html</link><description>1. `kubectl get ns &lt;å¯¹åº”å‘½åç©ºé—´åç§°&gt; -o json   &gt;   abc.json`
æ‰§è¡Œå®Œè¿™æ¡å‘½ä»¤åï¼Œå½“å‰æ–‡ä»¶å¤¹ä¼šå‡ºç°abc.jsonè¿™ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œåˆ é™¤å­—æ®µspecå’Œfinalizersè¿™ä¸¤ä¸ªå­—æ®µåŒ…å«çš„å†…å®¹ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/65.html</guid><pubDate>Wed, 26 Feb 2025 06:55:24 +0000</pubDate></item><item><title>nfs-client-provisionerä»¥åŠlocal-path-provisioneréƒ¨ç½²</title><link>https://longxiucai.github.io/post/64.html</link><description># nfs-client
æ³¨æ„ä¿®æ”¹é•œåƒåœ°å€ï¼ˆspec.imageï¼‰ã€nfsçš„IPåœ°å€ä¸å…±äº«è·¯å¾„ï¼ˆvolumesä¸envä¸¤å¤„ï¼‰
```
# Source: pre-resource/templates/nfs.yaml
kind: ServiceAccount
apiVersion: v1
metadata:
  name: nfs-client-provisioner-common
  namespace: nfs-storage
---
# Source: pre-resource/templates/nfs.yaml
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: nfs-storage
provisioner: common-nfs-storage
parameters:
  archiveOnDelete: 'true'
---
# Source: pre-resource/templates/nfs.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: nfs-client-provisioner-runner-common
rules:
  - apiGroups: ['']
    resources: ['persistentvolumes']
    verbs: ['get', 'list', 'watch', 'create', 'delete']
  - apiGroups: ['']
    resources: ['persistentvolumeclaims']
    verbs: ['get', 'list', 'watch', 'update']
  - apiGroups: ['storage.k8s.io']
    resources: ['storageclasses']
    verbs: ['get', 'list', 'watch']
  - apiGroups: ['']
    resources: ['events']
    verbs: ['create', 'update', 'patch']
---
# Source: pre-resource/templates/nfs.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: run-nfs-client-provisioner-common
  namespace: nfs-storage
subjects:
  - kind: ServiceAccount
    name: nfs-client-provisioner-common
    namespace: nfs-storage
roleRef:
  kind: ClusterRole
  name: nfs-client-provisioner-runner-common
  apiGroup: rbac.authorization.k8s.io
---
# Source: pre-resource/templates/nfs.yaml
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: leader-locking-nfs-client-provisioner-common
  namespace: nfs-storage
rules:
  - apiGroups: ['']
    resources: ['endpoints']
    verbs: ['get', 'list', 'watch', 'create', 'update', 'patch']
---
# Source: pre-resource/templates/nfs.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: leader-locking-nfs-client-provisioner-common
  namespace: nfs-storage
subjects:
  - kind: ServiceAccount
    name: nfs-client-provisioner-common
    namespace: nfs-storage
roleRef:
  kind: Role
  name: leader-locking-nfs-client-provisioner-common
  apiGroup: rbac.authorization.k8s.io
---
# Source: pre-resource/templates/nfs.yaml
kind: Deployment
apiVersion: apps/v1
metadata:
  name: nfs-client-provisioner-common
  namespace: nfs-storage
spec:
  replicas: 1
  strategy:
    type: Recreate
  selector:
    matchLabels:
      k8s-app: nfs-client-provisioner-common
  template:
    metadata:
      labels:
        k8s-app: nfs-client-provisioner-common
    spec:
      imagePullSecrets:
      - name: regcred
      serviceAccountName: nfs-client-provisioner-common
      containers:
        - name: nfs-client-provisioner-common
          image: nfs-client-provisioner:20230912
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: nfs-client-root
              mountPath: /persistentvolumes
            - mountPath: /etc/localtime
              name: localtime              
          ports:
            - containerPort: 9200
          env:
            - name: PROVISIONER_NAME
              value: common-nfs-storage 
            - name: NFS_SERVER
              value: XX.XX.XX.XX
            - name: NFS_PATH
              value: /XX/xx
      volumes:
        - name: nfs-client-root
          nfs:
            server: XX.XX.XX.XX
            path: /XX/xx
        - name: localtime
          hostPath:
            path: /etc/localtime

```
# local-path
æ³¨æ„ä¿®æ”¹è·¯å¾„ï¼ˆconfig.jsonï¼‰
```
apiVersion: v1
kind: Namespace
metadata:
  name: local-path-storage

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: local-path-provisioner-service-account
  namespace: local-path-storage

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: local-path-provisioner-role
rules:
  - apiGroups: [ '' ]
    resources: [ 'nodes', 'persistentvolumeclaims', 'configmaps' ]
    verbs: [ 'get', 'list', 'watch' ]
  - apiGroups: [ '' ]
    resources: [ 'endpoints', 'persistentvolumes', 'pods' ]
    verbs: [ '*' ]
  - apiGroups: [ '' ]
    resources: [ 'events' ]
    verbs: [ 'create', 'patch' ]
  - apiGroups: [ 'storage.k8s.io' ]
    resources: [ 'storageclasses' ]
    verbs: [ 'get', 'list', 'watch' ]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: local-path-provisioner-bind
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: local-path-provisioner-role
subjects:
  - kind: ServiceAccount
    name: local-path-provisioner-service-account
    namespace: local-path-storage

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: local-path-provisioner
  namespace: local-path-storage
spec:
  replicas: 1
  selector:
    matchLabels:
      app: local-path-provisioner
  template:
    metadata:
      labels:
        app: local-path-provisioner
    spec:
      serviceAccountName: local-path-provisioner-service-account
      containers:
        - name: local-path-provisioner
          image: local-path-provisioner:v0.0.24
          imagePullPolicy: IfNotPresent
          command:
            - local-path-provisioner
            - --debug
            - start
            - --config
            - /etc/config/config.json
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config/
          env:
            - name: POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
      volumes:
        - name: config-volume
          configMap:
            name: local-path-config

---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: local-path
provisioner: rancher.io/local-path
volumeBindingMode: WaitForFirstConsumer
reclaimPolicy: Delete

---
kind: ConfigMap
apiVersion: v1
metadata:
  name: local-path-config
  namespace: local-path-storage
data:
  config.json: |-
    {
            'nodePathMap':[
            {
                    'node':'DEFAULT_PATH_FOR_NON_LISTED_NODES',
                    'paths':['/opt/local-path-provisioner']
            }
            ]
    }
  setup: |-
    #!/bin/sh
    set -eu
    mkdir -m 0777 -p '$VOL_DIR'
  teardown: |-
    #!/bin/sh
    set -eu
    rm -rf '$VOL_DIR'
  helperPod.yaml: |-
    apiVersion: v1
    kind: Pod
    metadata:
      name: helper-pod
    spec:
      containers:
      - name: helper-pod
        image: busybox:1.36.0
        imagePullPolicy: IfNotPresent

```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/64.html</guid><pubDate>Wed, 26 Feb 2025 03:27:22 +0000</pubDate></item><item><title>.gitignoreç”¨æ³•</title><link>https://longxiucai.github.io/post/63.html</link><description>`.gitignore` æ–‡ä»¶ç”¨äºå‘Šè¯‰ Git å¿½ç•¥å“ªäº›æ–‡ä»¶æˆ–ç›®å½•ï¼Œä½¿å…¶ä¸ä¼šè¢« Git è¿½è¸ªå’Œæäº¤ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/63.html</guid><pubDate>Fri, 21 Feb 2025 02:56:35 +0000</pubDate></item><item><title>ã€goã€‘slogä½¿ç”¨ä»¥åŠé…åˆç¬¬ä¸‰æ–¹åº“å®ç°log rotation</title><link>https://longxiucai.github.io/post/62.html</link><description># ç¤ºä¾‹
ä½¿ç”¨slogå°†æ—¥å¿—ä¿å­˜åˆ°æ–‡ä»¶ï¼ŒåŒæ—¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/62.html</guid><pubDate>Tue, 18 Feb 2025 01:06:38 +0000</pubDate></item><item><title>apisix2.10&amp;apisix-ingress-controller1.4.0é…ç½®è·¯ç”±è¿‡æ»¤</title><link>https://longxiucai.github.io/post/59.html</link><description>å‚è€ƒï¼šhttps://625a9090d04b9a6953165811--2-11-old-docs-apache-apisix.netlify.app/zh/docs/apisix/2.10/plugins/uri-blocker
ä½¿ç”¨uri-blockeræ’ä»¶ï¼Œè¯¥æ’ä»¶å¯å¸®åŠ©æˆ‘ä»¬æ‹¦æˆªç”¨æˆ·è¯·æ±‚ï¼Œåªéœ€è¦æŒ‡å®šblock_ruleså³å¯ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/59.html</guid><pubDate>Tue, 11 Feb 2025 01:54:30 +0000</pubDate></item><item><title>node-exporterå„collectoræŒ‡æ ‡</title><link>https://longxiucai.github.io/post/58.html</link><description>|     |     |     |     |     |
| --- | --- | --- | --- | --- |
| Description | metricsä¸­çš„ä¿¡æ¯ | æŒ‡æ ‡åç§°ï¼ˆrelease-1.3ï¼‰ | å€¼çš„æ¥æº | å¤‡æ³¨  |
| Exposes ARP statistics from/proc/net/arp. | æ­£å¸¸  | node\_arp\_entries | /proc/net/arp |     |
| Exposes the number of configured and active slaves of Linux bonding interfaces. | æ­£å¸¸  | node\_bonding\_active  &lt;br&gt;node\_bonding\_slaves | /sys/class/net/&lt;bond name&gt;/\* |     |
| Exposes btrfs statistics | æ­£å¸¸  | node\_btrfs\_allocation\_ratio  &lt;br&gt;node\_btrfs\_device\_size\_bytes  &lt;br&gt;node\_btrfs\_global\_rsv\_size\_bytes  &lt;br&gt;node\_btrfs\_info  &lt;br&gt;node\_btrfs\_reserved\_bytes  &lt;br&gt;node\_btrfs\_size\_bytes  &lt;br&gt;node\_btrfs\_used\_bytes | /sys/fs/btrfs/\*-\*/ |     |
| Exposes statistics of memory fragments as reported by /proc/buddyinfo. | æ­£å¸¸  | node\_buddyinfo\_blocks | /proc/buddyinfo |     |
| Shows conntrack statistics (does nothing if no/proc/sys/net/netfilter/present). | æ­£å¸¸  | node\_nf\_conntrack\_entries  &lt;br&gt;node\_nf\_conntrack\_entries\_limit  &lt;br&gt;node\_nf\_conntrack\_stat\_found  &lt;br&gt;node\_nf\_conntrack\_stat\_invalid  &lt;br&gt;node\_nf\_conntrack\_stat\_ignore  &lt;br&gt;node\_nf\_conntrack\_stat\_insert  &lt;br&gt;node\_nf\_conntrack\_stat\_insert\_failed  &lt;br&gt;node\_nf\_conntrack\_stat\_drop  &lt;br&gt;node\_nf\_conntrack\_stat\_early\_drop  &lt;br&gt;node\_nf\_conntrack\_stat\_search\_restart | /proc/net/stat/nf\_conntrack |     |
| Exposes CPU statistics | æ­£å¸¸  | node\_cpu\_seconds\_total  &lt;br&gt;node\_cpu\_info  &lt;br&gt;node\_cpu\_flag\_info  &lt;br&gt;node\_cpu\_bug\_info  &lt;br&gt;node\_cpu\_guest\_seconds\_total  &lt;br&gt;node\_cpu\_core\_throttles\_total  &lt;br&gt;node\_cpu\_package\_throttles\_total | /proc/cpuinfo |     |
| Exposes disk I/O statistics. | æ­£å¸¸  | node\_disk\_reads\_completed\_total  &lt;br&gt;node\_disk\_read\_bytes\_total  &lt;br&gt;node\_disk\_writes\_completed\_total  &lt;br&gt;node\_disk\_written\_bytes\_total  &lt;br&gt;node\_disk\_io\_time\_seconds\_total  &lt;br&gt;node\_disk\_read\_time\_seconds\_total  &lt;br&gt;node\_disk\_write\_time\_seconds\_total  &lt;br&gt;node\_disk\_info  &lt;br&gt;node\_disk\_reads\_merged\_total  &lt;br&gt;node\_disk\_writes\_merged\_total  &lt;br&gt;node\_disk\_io\_now  &lt;br&gt;node\_disk\_io\_time\_weighted\_seconds\_total  &lt;br&gt;node\_disk\_discards\_completed\_total  &lt;br&gt;node\_disk\_discards\_merged\_total  &lt;br&gt;node\_disk\_discarded\_sectors\_total  &lt;br&gt;node\_disk\_discard\_time\_seconds\_total  &lt;br&gt;node\_disk\_flush\_requests\_total  &lt;br&gt;node\_disk\_flush\_requests\_time\_seconds\_total | /proc/diskstats |     |
| Expose Desktop Management Interface (DMI) info from/sys/class/dmi/id/ | æ­£å¸¸  | node\_dmi\_info | /sys/class/dmi/id/ |     |
| Exposes available entropy. | æ­£å¸¸  | node\_entropy\_available\_bits  &lt;br&gt;node\_entropy\_pool\_size\_bits | /proc/sys/kernel/random/ |     |
| Exposes file descriptor statistics from/proc/sys/fs/file-nr. | æ­£å¸¸  | node\_filefd\_allocated  &lt;br&gt;node\_filefd\_maximum | /proc/sys/fs/file-nr |     |
| Exposes filesystem statistics, such as disk space used. | æ­£å¸¸  | node\_filesystem\_size\_bytes  &lt;br&gt;node\_filesystem\_free\_bytes  &lt;br&gt;node\_filesystem\_avail\_bytes  &lt;br&gt;node\_filesystem\_files  &lt;br&gt;node\_filesystem\_files\_free  &lt;br&gt;node\_filesystem\_readonly  &lt;br&gt;node\_filesystem\_device\_error | /proc/1/mounts |     |
| Exposes detailed interrupts statistics. | æ­£å¸¸  | node\_interrupts\_total | /proc/interrupts |     |
| Exposes IPVS status from/proc/net/ip\_vsand stats from/proc/net/ip\_vs\_stats. | æ­£å¸¸  | node\_ipvs\_connections\_total  &lt;br&gt;node\_ipvs\_incoming\_packets\_total  &lt;br&gt;node\_ipvs\_outgoing\_packets\_total  &lt;br&gt;node\_ipvs\_incoming\_bytes\_total  &lt;br&gt;node\_ipvs\_outgoing\_bytes\_total  &lt;br&gt;node\_ipvs\_backend\_connections\_active  &lt;br&gt;node\_ipvs\_backend\_connections\_inactive  &lt;br&gt;node\_ipvs\_backend\_weight | /proc/net/ip\_vs  &lt;br&gt;/proc/net/ip\_vs\_stats |     |
| Exposes stats from/proc/net/stat/. | æ­£å¸¸  | node\_lnstat\_allocs\_total  &lt;br&gt;node\_lnstat\_delete\_list\_total  &lt;br&gt;node\_lnstat\_delete\_total  &lt;br&gt;node\_lnstat\_destroys\_total  &lt;br&gt;node\_lnstat\_drop\_total  &lt;br&gt;node\_lnstat\_early\_drop\_total  &lt;br&gt;node\_lnstat\_entries\_total  &lt;br&gt;node\_lnstat\_expect\_create\_total  &lt;br&gt;node\_lnstat\_expect\_delete\_total  &lt;br&gt;node\_lnstat\_expect\_new\_total  &lt;br&gt;node\_lnstat\_forced\_gc\_runs\_total  &lt;br&gt;node\_lnstat\_found\_total  &lt;br&gt;node\_lnstat\_gc\_dst\_overflow\_total  &lt;br&gt;node\_lnstat\_gc\_goal\_miss\_total  &lt;br&gt;node\_lnstat\_gc\_ignored\_total  &lt;br&gt;node\_lnstat\_gc\_total\_total  &lt;br&gt;node\_lnstat\_hash\_grows\_total  &lt;br&gt;node\_lnstat\_hits\_total  &lt;br&gt;node\_lnstat\_icmp\_error\_total  &lt;br&gt;node\_lnstat\_ignore\_total  &lt;br&gt;node\_lnstat\_in\_brd\_total  &lt;br&gt;node\_lnstat\_in\_hit\_total  &lt;br&gt;node\_lnstat\_in\_hlist\_search\_total  &lt;br&gt;node\_lnstat\_in\_martian\_dst\_total&lt;br&gt;node\_lnstat\_in\_martian\_src\_total  &lt;br&gt;node\_lnstat\_in\_no\_route\_total  &lt;br&gt;node\_lnstat\_in\_slow\_mc\_total  &lt;br&gt;node\_lnstat\_in\_slow\_tot\_total  &lt;br&gt;node\_lnstat\_insert\_failed\_total  &lt;br&gt;node\_lnstat\_insert\_total  &lt;br&gt;node\_lnstat\_invalid\_total  &lt;br&gt;node\_lnstat\_lookups\_total  &lt;br&gt;node\_lnstat\_new\_total  &lt;br&gt;node\_lnstat\_out\_hit\_total  &lt;br&gt;node\_lnstat\_out\_hlist\_search\_total  &lt;br&gt;node\_lnstat\_out\_slow\_mc\_total  &lt;br&gt;node\_lnstat\_out\_slow\_tot\_total  &lt;br&gt;node\_lnstat\_periodic\_gc\_runs\_total  &lt;br&gt;node\_lnstat\_rcv\_probes\_mcast\_total  &lt;br&gt;node\_lnstat\_rcv\_probes\_ucast\_total  &lt;br&gt;node\_lnstat\_res\_failed\_total  &lt;br&gt;node\_lnstat\_search\_restart\_total  &lt;br&gt;node\_lnstat\_searched\_total  &lt;br&gt;node\_lnstat\_table\_fulls\_total  &lt;br&gt;node\_lnstat\_unresolved\_discards\_total| /proc/net/stat/ | æŒ‡æ ‡åç§°æ ¹æ®/proc/net/stat/\*ç¬¬ä¸€è¡Œ |
| Exposes load average. | æ­£å¸¸  | node\_load1  &lt;br&gt;node\_load15  &lt;br&gt;node\_load5 | /proc/loadavg |     |
| Exposes memory statistics. | æ­£å¸¸  | node\_memory\_Active\_anon\_bytes  &lt;br&gt;node\_memory\_Active\_bytes  &lt;br&gt;node\_memory\_Active\_file\_bytes  &lt;br&gt;node\_memory\_AnonHugePages\_bytes  &lt;br&gt;node\_memory\_AnonPages\_bytes  &lt;br&gt;node\_memory\_Bounce\_bytes  &lt;br&gt;node\_memory\_Buffers\_bytes  &lt;br&gt;node\_memory\_Cached\_bytes  &lt;br&gt;node\_memory\_CommitLimit\_bytes  &lt;br&gt;node\_memory\_Committed\_AS\_bytes  &lt;br&gt;node\_memory\_DirectMap1G\_bytes  &lt;br&gt;node\_memory\_DirectMap2M\_bytes  &lt;br&gt;node\_memory\_DirectMap4k\_bytes  &lt;br&gt;node\_memory\_Dirty\_bytes  &lt;br&gt;node\_memory\_HardwareCorrupted\_bytes  &lt;br&gt;node\_memory\_HugePages\_Free  &lt;br&gt;node\_memory\_HugePages\_Rsvd  &lt;br&gt;node\_memory\_HugePages\_Surp  &lt;br&gt;node\_memory\_HugePages\_Total  &lt;br&gt;node\_memory\_Hugepagesize\_bytes  &lt;br&gt;node\_memory\_Hugetlb\_bytes  &lt;br&gt;node\_memory\_Inactive\_anon\_bytes  &lt;br&gt;node\_memory\_Inactive\_bytes   &lt;br&gt;node\_memory\_Inactive\_file\_bytes  &lt;br&gt;node\_memory\_KernelStack\_bytes  &lt;br&gt;node\_memory\_Mapped\_bytes  &lt;br&gt;node\_memory\_MemAvailable\_bytes  &lt;br&gt;node\_memory\_MemFree\_bytes  &lt;br&gt;node\_memory\_MemTotal\_bytes  &lt;br&gt;node\_memory\_Mlocked\_bytes  &lt;br&gt;node\_memory\_NFS\_Unstable\_bytes  &lt;br&gt;node\_memory\_PageTables\_bytes  &lt;br&gt;node\_memory\_Percpu\_bytes  &lt;br&gt;node\_memory\_SReclaimable\_bytes  &lt;br&gt;node\_memory\_SUnreclaim\_bytes  &lt;br&gt;node\_memory\_ShmemHugePages\_bytes  &lt;br&gt;node\_memory\_ShmemPmdMapped\_bytes  &lt;br&gt;node\_memory\_Shmem\_bytes  &lt;br&gt;node\_memory\_Slab\_bytes  &lt;br&gt;node\_memory\_SwapCached\_bytes  &lt;br&gt;node\_memory\_SwapFree\_bytes  &lt;br&gt;node\_memory\_SwapTotal\_bytes  &lt;br&gt;node\_memory\_Unevictable\_bytes  &lt;br&gt;node\_memory\_VmallocChunk\_bytes  &lt;br&gt;node\_memory\_VmallocTotal\_bytes  &lt;br&gt;node\_memory\_VmallocUsed\_bytes  &lt;br&gt;node\_memory\_WritebackTmp\_bytes  &lt;br&gt;node\_memory\_Writeback\_bytes| /proc/meminfo | æŒ‡æ ‡åç§°æ ¹æ®/proc/meminfoç¬¬ä¸€åˆ— |
| Exposes memory statistics from/proc/meminfo\_numa. | æ­£å¸¸  | node\_memory\_numa\_Active  &lt;br&gt;node\_memory\_numa\_Active\_anon  &lt;br&gt;node\_memory\_numa\_Active\_file  &lt;br&gt;node\_memory\_numa\_AnonHugePages  &lt;br&gt;node\_memory\_numa\_AnonPages  &lt;br&gt;node\_memory\_numa\_Bounce  &lt;br&gt;node\_memory\_numa\_Dirty  &lt;br&gt;node\_memory\_numa\_FilePages  &lt;br&gt;node\_memory\_numa\_HugePages\_Free  &lt;br&gt;node\_memory\_numa\_HugePages\_Surp  &lt;br&gt;node\_memory\_numa\_HugePages\_Total  &lt;br&gt;node\_memory\_numa\_Inactive  &lt;br&gt;node\_memory\_numa\_Inactive\_anon  &lt;br&gt;node\_memory\_numa\_Inactive\_file  &lt;br&gt;node\_memory\_numa\_KernelStack  &lt;br&gt;node\_memory\_numa\_Mapped  &lt;br&gt;node\_memory\_numa\_MemFree  &lt;br&gt;node\_memory\_numa\_MemTotal&lt;br&gt; node\_memory\_numa\_MemUsed  &lt;br&gt;node\_memory\_numa\_Mlocked  &lt;br&gt;node\_memory\_numa\_NFS\_Unstable  &lt;br&gt;node\_memory\_numa\_PageTables  &lt;br&gt;node\_memory\_numa\_SReclaimable  &lt;br&gt;node\_memory\_numa\_SUnreclaim  &lt;br&gt;node\_memory\_numa\_Shmem  &lt;br&gt;node\_memory\_numa\_ShmemHugePages  &lt;br&gt;node\_memory\_numa\_ShmemPmdMapped  &lt;br&gt;node\_memory\_numa\_Slab  &lt;br&gt;node\_memory\_numa\_Unevictable  &lt;br&gt;node\_memory\_numa\_Writeback  &lt;br&gt;node\_memory\_numa\_WritebackTmp  &lt;br&gt;node\_memory\_numa\_interleave\_hit\_total  &lt;br&gt;node\_memory\_numa\_local\_node\_total  &lt;br&gt;node\_memory\_numa\_numa\_foreign\_total  &lt;br&gt;node\_memory\_numa\_numa\_hit\_total  &lt;br&gt;node\_memory\_numa\_numa\_miss\_total  &lt;br&gt;node\_memory\_numa\_other\_node\_total&lt;br&gt; node\_memory\_numa\_MemUsed  &lt;br&gt;node\_memory\_numa\_Mlocked  &lt;br&gt;node\_memory\_numa\_NFS\_Unstable  &lt;br&gt;node\_memory\_numa\_PageTables  &lt;br&gt;node\_memory\_numa\_SReclaimable  &lt;br&gt;node\_memory\_numa\_SUnreclaim  &lt;br&gt;node\_memory\_numa\_Shmem  &lt;br&gt;node\_memory\_numa\_ShmemHugePages  &lt;br&gt;node\_memory\_numa\_ShmemPmdMapped  &lt;br&gt;node\_memory\_numa\_Slab  &lt;br&gt;node\_memory\_numa\_Unevictable  &lt;br&gt;node\_memory\_numa\_Writeback  &lt;br&gt;node\_memory\_numa\_WritebackTmp  &lt;br&gt;node\_memory\_numa\_interleave\_hit\_total  &lt;br&gt;node\_memory\_numa\_local\_node\_total  &lt;br&gt;node\_memory\_numa\_numa\_foreign\_total  &lt;br&gt;node\_memory\_numa\_numa\_hit\_total  &lt;br&gt;node\_memory\_numa\_numa\_miss\_total  &lt;br&gt;node\_memory\_numa\_other\_node\_total | /proc/meminfo\_numa | æŒ‡æ ‡åç§°æ ¹æ®/sys/devices/system/node/node\[0-9\]/meminfo |
| Exposes network interface info from/sys/class/net/ | æ­£å¸¸  | node\_network\_info  &lt;br&gt;node\_network\_up  &lt;br&gt;node\_network\_address\_assign\_type  &lt;br&gt;node\_network\_carrier  &lt;br&gt;node\_network\_carrier\_changes\_total  &lt;br&gt;node\_network\_carrier\_up\_changes\_total  &lt;br&gt;node\_network\_carrier\_down\_changes\_total  &lt;br&gt;node\_network\_device\_id  &lt;br&gt;node\_network\_dormant  &lt;br&gt;node\_network\_flags  &lt;br&gt;node\_network\_iface\_id  &lt;br&gt;node\_network\_iface\_link  &lt;br&gt;node\_network\_iface\_link\_mode  &lt;br&gt;node\_network\_mtu\_bytes  &lt;br&gt;node\_network\_name\_assign\_type  &lt;br&gt;node\_network\_net\_dev\_group  &lt;br&gt;node\_network\_speed\_bytes  &lt;br&gt;node\_network\_transmit\_queue\_length  &lt;br&gt;node\_network\_protocol\_type | /sys/class/net/ |     |
| Exposes network interface statistics such as bytes transferred. | æ­£å¸¸  | node\_network\_receive\_bytes\_total  &lt;br&gt;node\_network\_receive\_packets\_total  &lt;br&gt;node\_network\_receive\_errs\_total  &lt;br&gt;node\_network\_receive\_drop\_total  &lt;br&gt;node\_network\_receive\_fifo\_total  &lt;br&gt;node\_network\_receive\_frame\_total  &lt;br&gt;node\_network\_receive\_compressed\_total  &lt;br&gt;node\_network\_receive\_multicast\_total  &lt;br&gt;node\_network\_transmit\_bytes\_total  &lt;br&gt;node\_network\_transmit\_packets\_total  &lt;br&gt;node\_network\_transmit\_errs\_total  &lt;br&gt;node\_network\_transmit\_drop\_total  &lt;br&gt;node\_network\_transmit\_fifo\_total  &lt;br&gt;node\_network\_transmit\_frame\_total  &lt;br&gt;node\_network\_transmit\_compressed\_total  &lt;br&gt;node\_network\_transmit\_multicast\_total | /proc/net/dev | æŒ‡æ ‡åç§°æ ¹æ®/proc/net/dev |
| Exposes network statistics from/proc/net/netstat. This is the same information asnetstat -s. | æ­£å¸¸  | node\_netstat\_Icmp6\_InErrors  &lt;br&gt;node\_netstat\_Icmp6\_InMsgs  &lt;br&gt;node\_netstat\_Icmp6\_OutMsgs  &lt;br&gt;node\_netstat\_Icmp\_InErrors  &lt;br&gt;node\_netstat\_Icmp\_InMsgs  &lt;br&gt;node\_netstat\_Icmp\_OutMsgs  &lt;br&gt;node\_netstat\_Ip6\_InOctets  &lt;br&gt;node\_netstat\_Ip6\_OutOctets  &lt;br&gt;node\_netstat\_IpExt\_InOctets  &lt;br&gt;node\_netstat\_IpExt\_OutOctets  &lt;br&gt;node\_netstat\_Ip\_Forwarding  &lt;br&gt;node\_netstat\_TcpExt\_ListenDrops  &lt;br&gt;node\_netstat\_TcpExt\_ListenOverflows  &lt;br&gt;node\_netstat\_TcpExt\_SyncookiesFailed  &lt;br&gt;node\_netstat\_TcpExt\_SyncookiesRecv  &lt;br&gt;node\_netstat\_TcpExt\_SyncookiesSent  &lt;br&gt;node\_netstat\_TcpExt\_TCPSynRetrans  &lt;br&gt;node\_netstat\_TcpExt\_TCPTimeouts  &lt;br&gt;node\_netstat\_Tcp\_ActiveOpens  &lt;br&gt;node\_netstat\_Tcp\_CurrEstab  &lt;br&gt;node\_netstat\_Tcp\_InErrs  &lt;br&gt;node\_netstat\_Tcp\_InSegs  &lt;br&gt;node\_netstat\_Tcp\_OutRsts  &lt;br&gt;node\_netstat\_Tcp\_OutSegs  &lt;br&gt;node\_netstat\_Tcp\_PassiveOpens  &lt;br&gt;node\_netstat\_Tcp\_RetransSegs  &lt;br&gt;node\_netstat\_Udp6\_InDatagrams  &lt;br&gt;node\_netstat\_Udp6\_InErrors  &lt;br&gt;node\_netstat\_Udp6\_NoPorts  &lt;br&gt;node\_netstat\_Udp6\_OutDatagrams  &lt;br&gt;node\_netstat\_Udp6\_RcvbufErrors  &lt;br&gt;node\_netstat\_Udp6\_SndbufErrors  &lt;br&gt;node\_netstat\_UdpLite6\_InErrors  &lt;br&gt;node\_netstat\_UdpLite\_InErrors  &lt;br&gt;node\_netstat\_Udp\_InDatagrams  &lt;br&gt;node\_netstat\_Udp\_InErrors  &lt;br&gt;node\_netstat\_Udp\_NoPorts  &lt;br&gt;node\_netstat\_Udp\_OutDatagrams  &lt;br&gt;node\_netstat\_Udp\_RcvbufErrors  &lt;br&gt;node\_netstat\_Udp\_SndbufErrors| /proc/net/netstat | æŒ‡æ ‡åç§°æ ¹æ®/proc/net/snmpã€/proc/net/netstatã€/proc/net/snmp6 |
| Exposes the routing table as metrics | æ­£å¸¸  | node\_network\_route\_info  &lt;br&gt;node\_network\_routes | [github.com/mdlayher/netlink](https://github.com/mdlayher/netlink 'https://github.com/mdlayher/netlink') |     |
| Exposes NFS client statistics from/proc/net/rpc/nfs. This is the same information asnfsstat -c. | æ­£å¸¸  | node\_nfs\_packets\_total  &lt;br&gt;node\_nfs\_connections\_total  &lt;br&gt;node\_nfs\_rpcs\_total  &lt;br&gt;node\_nfs\_rpc\_retransmissions\_total  &lt;br&gt;node\_nfs\_rpc\_authentication\_refreshes\_total  &lt;br&gt;node\_nfs\_requests\_total | /proc/net/rpc/nfs |     |
| Exposes NFS kernel server statistics from/proc/net/rpc/nfsd. This is the same information asnfsstat -s. | æ­£å¸¸  | node\_nfsd\_requests\_total  &lt;br&gt;node\_nfsd\_reply\_cache\_hits\_total  &lt;br&gt;node\_nfsd\_reply\_cache\_misses\_total  &lt;br&gt;node\_nfsd\_reply\_cache\_nocache\_total  &lt;br&gt;node\_nfsd\_file\_handles\_stale\_total  &lt;br&gt;node\_nfsd\_disk\_bytes\_read\_total  &lt;br&gt;node\_nfsd\_disk\_bytes\_written\_total  &lt;br&gt;node\_nfsd\_server\_threads  &lt;br&gt;node\_nfsd\_read\_ahead\_cache\_size\_blocks  &lt;br&gt;node\_nfsd\_read\_ahead\_cache\_not\_found\_total  &lt;br&gt;node\_nfsd\_packets\_total  &lt;br&gt;node\_nfsd\_connections\_total  &lt;br&gt;node\_nfsd\_rpc\_errors\_total  &lt;br&gt;node\_nfsd\_server\_rpcs\_total | /proc/net/rpc/nfsd |     |
| Expose OS release info from/etc/os-releaseor/usr/lib/os-release | æ­£å¸¸  | node\_os\_info  &lt;br&gt;node\_os\_version | /etc/os-release  &lt;br&gt;/usr/lib/os-release | /etc/os-releaseä¸­VERSION\_IDçš„å€¼ä¸ç¬¦åˆæ­£åˆ™\`^\[0-9\]+\\.?\[0-9\]\*\`æ‰€ä»¥æ²¡æœ‰node\_os\_versionæŒ‡æ ‡ |
| Exposes aggregate process statistics from/proc. | æ­£å¸¸  | node\_processes\_max\_processes  &lt;br&gt;node\_processes\_max\_threads  &lt;br&gt;node\_processes\_pids  &lt;br&gt;node\_processes\_state  &lt;br&gt;node\_processes\_threads  &lt;br&gt;node\_processes\_threads\_state | /proc/\* |     |
| Exposesqueuing disciplinestatistics | æ­£å¸¸  | node\_qdisc\_backlog  &lt;br&gt;node\_qdisc\_bytes\_total  &lt;br&gt;node\_qdisc\_current\_queue\_length  &lt;br&gt;node\_qdisc\_drops\_total  &lt;br&gt;node\_qdisc\_overlimits\_total  &lt;br&gt;node\_qdisc\_packets\_total  &lt;br&gt;node\_qdisc\_requeues\_total | [github.com/mdlayher/netlink](https://github.com/mdlayher/netlink 'github.com/mdlayher/netlink') |     |
| Exposes task scheduler statistics from/proc/schedstat. | æ­£å¸¸  | node\_schedstat\_timeslices\_total  &lt;br&gt;node\_schedstat\_waiting\_seconds\_total  &lt;br&gt;node\_schedstat\_running\_seconds\_total | /proc/schedstat |     |
| Exposes various statistics from/proc/net/sockstat. | æ­£å¸¸  | node\_sockstat\_FRAG6\_inuse  &lt;br&gt;node\_sockstat\_FRAG6\_memory  &lt;br&gt;node\_sockstat\_FRAG\_inuse  &lt;br&gt;node\_sockstat\_FRAG\_memory  &lt;br&gt;node\_sockstat\_RAW6\_inuse  &lt;br&gt;node\_sockstat\_RAW\_inuse  &lt;br&gt;node\_sockstat\_TCP6\_inuse  &lt;br&gt;node\_sockstat\_TCP\_alloc  &lt;br&gt;node\_sockstat\_TCP\_inuse  &lt;br&gt;node\_sockstat\_TCP\_mem  &lt;br&gt;node\_sockstat\_TCP\_mem\_bytes  &lt;br&gt;node\_sockstat\_TCP\_orphan  &lt;br&gt;node\_sockstat\_TCP\_tw  &lt;br&gt;node\_sockstat\_UDP6\_inuse  &lt;br&gt;node\_sockstat\_UDPLITE6\_inuse  &lt;br&gt;node\_sockstat\_UDPLITE\_inuse  &lt;br&gt;node\_sockstat\_UDP\_inuse  &lt;br&gt;node\_sockstat\_UDP\_mem  &lt;br&gt;node\_sockstat\_UDP\_mem\_bytes  &lt;br&gt;node\_sockstat\_sockets\_used | /proc/net/sockstat |     |
| Exposes statistics from/proc/net/softnet\_stat. | æ­£å¸¸  | node\_softnet\_dropped\_total  &lt;br&gt;node\_softnet\_processed\_total  &lt;br&gt;node\_softnet\_times\_squeezed\_total | /proc/net/softnet\_stat |     |
| Exposes various statistics from/proc/stat. This includes boot time, forks and interrupts. | æ­£å¸¸  | node\_intr\_total  &lt;br&gt;node\_context\_switches\_total  &lt;br&gt;node\_forks\_total  &lt;br&gt;node\_boot\_time\_seconds  &lt;br&gt;node\_procs\_running  &lt;br&gt;node\_procs\_blocked | /proc/stat |     |
| Exposes TCP connection status information from/proc/net/tcpand/proc/net/tcp6. (Warning: the current version has potential performance issues in high load situations.) | æ­£å¸¸  | node\_tcp\_connection\_states | /proc/net/tcp  &lt;br&gt;/proc/net/tcp6 |     |
| Exposes statistics read from local disk. The\--collector.textfile.directoryflag must be set. | æ­£å¸¸  | node\_textfile\_mtime\_seconds  &lt;br&gt;node\_textfile\_scrape\_error | æ ¹æ®å‚æ•°æŒ‡å®šçš„æ–‡ä»¶ |     |
| Exposes thermal zone &amp; cooling device statistics from/sys/class/thermal. | æ­£å¸¸  | node\_thermal\_zone\_temp  &lt;br&gt;node\_cooling\_device\_cur\_state  &lt;br&gt;node\_cooling\_device\_max\_state | /sys/class/thermal |     |
| Exposes the current system time. | æ­£å¸¸  | node\_time\_seconds  &lt;br&gt;node\_time\_zone\_offset\_seconds  &lt;br&gt;node\_time\_clocksource\_available\_info  &lt;br&gt;node\_time\_clocksource\_current\_info | /sys/devices/system/clocksource/ |     |
| Exposes selected adjtimex(2) system call stats. | æ­£å¸¸  | node\_timex\_estimated\_error\_seconds  &lt;br&gt;node\_timex\_frequency\_adjustment\_ratio  &lt;br&gt;node\_timex\_loop\_time\_constant  &lt;br&gt;node\_timex\_maxerror\_seconds  &lt;br&gt;node\_timex\_offset\_seconds  &lt;br&gt;node\_timex\_pps\_calibration\_total  &lt;br&gt;node\_timex\_pps\_error\_total  &lt;br&gt;node\_timex\_pps\_frequency\_hertz  &lt;br&gt;node\_timex\_pps\_jitter\_seconds  &lt;br&gt;node\_timex\_pps\_jitter\_total  &lt;br&gt;node\_timex\_pps\_shift\_seconds  &lt;br&gt;node\_timex\_pps\_stability\_exceeded\_total  &lt;br&gt;node\_timex\_pps\_stability\_hertz  &lt;br&gt;node\_timex\_status  &lt;br&gt;node\_timex\_sync\_status  &lt;br&gt;node\_timex\_tai\_offset\_seconds  &lt;br&gt;node\_timex\_tick\_seconds | unix.Adjtimex |     |
| Exposes UDP total lengths of the rx\_queue and tx\_queue from/proc/net/udpand/proc/net/udp6. | æ­£å¸¸  | node\_udp\_queues | /proc/net/udp  &lt;br&gt;/proc/net/udp6 |     |
| Exposes system information as provided by the uname system call. | æ­£å¸¸  | node\_uname\_info | unix.Uname |     |
| Exposes statistics from/proc/vmstat. | æ­£å¸¸  | node\_vmstat\_oom\_kill  &lt;br&gt;node\_vmstat\_pgfault  &lt;br&gt;node\_vmstat\_pgmajfault  &lt;br&gt;node\_vmstat\_pgpgin  &lt;br&gt;node\_vmstat\_pgpgout  &lt;br&gt;node\_vmstat\_pswpin  &lt;br&gt;node\_vmstat\_pswpout | /proc/vmstat | æŒ‡æ ‡åç§°æ ¹æ®/proc/vmstat |
| Exposes XFS runtime statistics. | æ­£å¸¸  | node\_xfs\_allocation\_btree\_compares\_total  &lt;br&gt;node\_xfs\_allocation\_btree\_lookups\_total  &lt;br&gt;node\_xfs\_allocation\_btree\_records\_deleted\_total  &lt;br&gt;node\_xfs\_allocation\_btree\_records\_inserted\_total  &lt;br&gt;node\_xfs\_block\_map\_btree\_compares\_total  &lt;br&gt;node\_xfs\_block\_map\_btree\_lookups\_total  &lt;br&gt;node\_xfs\_block\_map\_btree\_records\_deleted\_total  &lt;br&gt;node\_xfs\_block\_map\_btree\_records\_inserted\_total  &lt;br&gt;node\_xfs\_block\_mapping\_extent\_list\_compares\_total  &lt;br&gt;node\_xfs\_block\_mapping\_extent\_list\_deletions\_total  &lt;br&gt;node\_xfs\_block\_mapping\_extent\_list\_insertions\_total  &lt;br&gt;node\_xfs\_block\_mapping\_extent\_list\_lookups\_total  &lt;br&gt;node\_xfs\_block\_mapping\_reads\_total  &lt;br&gt;node\_xfs\_block\_mapping\_unmaps\_total  &lt;br&gt;node\_xfs\_block\_mapping\_writes\_total  &lt;br&gt;node\_xfs\_directory\_operation\_create\_total  &lt;br&gt;node\_xfs\_directory\_operation\_getdents\_total  &lt;br&gt;node\_xfs\_directory\_operation\_lookup\_total  &lt;br&gt;node\_xfs\_directory\_operation\_remove\_total  &lt;br&gt;node\_xfs\_extent\_allocation\_blocks\_allocated\_total  &lt;br&gt;node\_xfs\_extent\_allocation\_blocks\_freed\_total  &lt;br&gt;node\_xfs\_extent\_allocation\_extents\_allocated\_total  &lt;br&gt;node\_xfs\_extent\_allocation\_extents\_freed\_total  &lt;br&gt;node\_xfs\_inode\_operation\_attempts\_total  &lt;br&gt;node\_xfs\_inode\_operation\_attribute\_changes\_total  &lt;br&gt;node\_xfs\_inode\_operation\_duplicates\_total  &lt;br&gt;node\_xfs\_inode\_operation\_found\_total  &lt;br&gt;node\_xfs\_inode\_operation\_missed\_total  &lt;br&gt;node\_xfs\_inode\_operation\_reclaims\_total  &lt;br&gt;node\_xfs\_inode\_operation\_recycled\_total  &lt;br&gt;node\_xfs\_read\_calls\_total  &lt;br&gt;node\_xfs\_vnode\_active\_total  &lt;br&gt;node\_xfs\_vnode\_allocate\_total  &lt;br&gt;node\_xfs\_vnode\_get\_total  &lt;br&gt;node\_xfs\_vnode\_hold\_total  &lt;br&gt;node\_xfs\_vnode\_reclaim\_total  &lt;br&gt;node\_xfs\_vnode\_release\_total  &lt;br&gt;node\_xfs\_vnode\_remove\_total  &lt;br&gt;node\_xfs\_write\_calls\_total| /sys/fs/xfs/\*/stats/stats |     |
| Exposes NUMA memory zone metrics. | æ­£å¸¸  | node\_zoneinfo\_high\_pages  &lt;br&gt;node\_zoneinfo\_low\_pages  &lt;br&gt;node\_zoneinfo\_managed\_pages  &lt;br&gt;node\_zoneinfo\_min\_pages  &lt;br&gt;node\_zoneinfo\_nr\_active\_anon\_pages  &lt;br&gt;node\_zoneinfo\_nr\_active\_file\_pages  &lt;br&gt;node\_zoneinfo\_nr\_anon\_pages  &lt;br&gt;node\_zoneinfo\_nr\_anon\_transparent\_hugepages  &lt;br&gt;node\_zoneinfo\_nr\_dirtied\_total  &lt;br&gt;node\_zoneinfo\_nr\_dirty\_pages  &lt;br&gt;node\_zoneinfo\_nr\_file\_pages  &lt;br&gt;node\_zoneinfo\_nr\_free\_pages  &lt;br&gt;node\_zoneinfo\_nr\_inactive\_anon\_pages  &lt;br&gt;node\_zoneinfo\_nr\_inactive\_file\_pages  &lt;br&gt;node\_zoneinfo\_nr\_isolated\_anon\_pages  &lt;br&gt;node\_zoneinfo\_nr\_isolated\_file\_pages  &lt;br&gt;node\_zoneinfo\_nr\_kernel\_stacks  &lt;br&gt;node\_zoneinfo\_nr\_mapped\_pages  &lt;br&gt;node\_zoneinfo\_nr\_shmem\_pages  &lt;br&gt;node\_zoneinfo\_nr\_slab\_reclaimable\_pages&lt;br&gt;node\_zoneinfo\_nr\_slab\_unreclaimable\_pages  &lt;br&gt;node\_zoneinfo\_nr\_unevictable\_pages  &lt;br&gt;node\_zoneinfo\_nr\_writeback\_pages  &lt;br&gt;node\_zoneinfo\_nr\_written\_total  &lt;br&gt;node\_zoneinfo\_numa\_foreign\_total  &lt;br&gt;node\_zoneinfo\_numa\_hit\_total  &lt;br&gt;node\_zoneinfo\_numa\_interleave\_total  &lt;br&gt;node\_zoneinfo\_numa\_local\_total  &lt;br&gt;node\_zoneinfo\_numa\_miss\_total  &lt;br&gt;node\_zoneinfo\_numa\_other\_total  &lt;br&gt;node\_zoneinfo\_present\_pages  &lt;br&gt;node\_zoneinfo\_spanned\_pages  &lt;br&gt;node\_zoneinfo\_protection\_0  &lt;br&gt;node\_zoneinfo\_protection\_1  &lt;br&gt;node\_zoneinfo\_protection\_2  &lt;br&gt;node\_zoneinfo\_protection\_3  &lt;br&gt;node\_zoneinfo\_protection\_4 | /proc/zoneinfo | æŒ‡æ ‡node\_zoneinfo\_protection\_xæ ¹æ®/proc/zoneinfo |
| Exposes fibre channel information and statistics from/sys/class/fc\_host/. | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_fibrechannel\_dumped\_frames\_total  &lt;br&gt;node\_fibrechannel\_loss\_of\_signal\_total  &lt;br&gt;node\_fibrechannel\_loss\_of\_sync\_total  &lt;br&gt;node\_fibrechannel\_rx\_frames\_total  &lt;br&gt;node\_fibrechannel\_error\_frames\_total  &lt;br&gt;node\_fibrechannel\_invalid\_tx\_words\_total  &lt;br&gt;node\_fibrechannel\_seconds\_since\_last\_reset\_total  &lt;br&gt;node\_fibrechannel\_tx\_words\_total  &lt;br&gt;node\_fibrechannel\_invalid\_crc\_total  &lt;br&gt;node\_fibrechannel\_nos\_total  &lt;br&gt;node\_fibrechannel\_fcp\_packet\_aborts\_total  &lt;br&gt;node\_fibrechannel\_rx\_words\_total  &lt;br&gt;node\_fibrechannel\_tx\_frames\_total  &lt;br&gt;node\_fibrechannel\_link\_failure\_total  &lt;br&gt;node\_fibrechannel\_name  &lt;br&gt;node\_fibrechannel\_speed  &lt;br&gt;node\_fibrechannel\_port\_state  &lt;br&gt;node\_fibrechannel\_port\_type  &lt;br&gt;node\_fibrechannel\_symbolic\_name  &lt;br&gt;node\_fibrechannel\_node\_name  &lt;br&gt;node\_fibrechannel\_port\_id  &lt;br&gt;node\_fibrechannel\_port\_name  &lt;br&gt;node\_fibrechannel\_fabric\_name  &lt;br&gt;node\_fibrechannel\_dev\_loss\_tmo  &lt;br&gt;node\_fibrechannel\_supported\_classes  &lt;br&gt;node\_fibrechannel\_supported\_speeds | /sys/class/fc\_host/ |     |
| Expose hardware monitoring and sensor data from/sys/class/hwmon/. | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_hwmon\_chip\_names  &lt;br&gt;node\_hwmon\_sensor\_label  &lt;br&gt;node\_hwmon\_beep\_enabled  &lt;br&gt;node\_hwmon\_voltage\_regulator\_version  &lt;br&gt;node\_hwmon\_update\_interval\_seconds  &lt;br&gt;node\_hwmon\_beep\_enable\_\*  &lt;br&gt;node\_hwmon\_vrm\_\*  &lt;br&gt;node\_hwmon\_update\_interval\_\* | /sys/class/hwmon/ | æŒ‡æ ‡åç§°\*æ ¹æ®/sys/class/hwmon/ |
| Exposes kernel and system statistics from/sys/kernel/mm/ksm. | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_ksmd\_full\_scans\_total  &lt;br&gt;node\_ksmd\_merge\_across\_nodes  &lt;br&gt;node\_ksmd\_pages\_shared  &lt;br&gt;node\_ksmd\_pages\_sharing  &lt;br&gt;node\_ksmd\_pages\_to\_scan  &lt;br&gt;node\_ksmd\_pages\_unshared  &lt;br&gt;node\_ksmd\_pages\_volatile  &lt;br&gt;node\_ksmd\_run  &lt;br&gt;node\_ksmd\_sleep\_seconds | /sys/kernel/mm/ksm |     |
| Exposes NVMe info from/sys/class/nvme/ | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_nvme\_info | /sys/class/nvme/ |     |
| Exposes Power Supply statistics from/sys/class/power\_supply | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_power\_supply\_authentic  &lt;br&gt;node\_power\_supply\_calibrate  &lt;br&gt;node\_power\_supply\_capacity  &lt;br&gt;node\_power\_supply\_capacity\_alert\_max  &lt;br&gt;node\_power\_supply\_capacity\_alert\_min  &lt;br&gt;node\_power\_supply\_cyclecount  &lt;br&gt;node\_power\_supply\_online  &lt;br&gt;node\_power\_supply\_present  &lt;br&gt;node\_power\_supply\_time\_to\_empty\_seconds  &lt;br&gt;node\_power\_supply\_time\_to\_full\_seconds  &lt;br&gt;node\_power\_supply\_current\_boot  &lt;br&gt;node\_power\_supply\_current\_max  &lt;br&gt;node\_power\_supply\_current\_ampere  &lt;br&gt;node\_power\_supply\_energy\_empty  &lt;br&gt;node\_power\_supply\_energy\_empty\_design  &lt;br&gt;node\_power\_supply\_energy\_full  &lt;br&gt;node\_power\_supply\_energy\_full\_design  &lt;br&gt;node\_power\_supply\_energy\_watthour  &lt;br&gt;node\_power\_supply\_voltage\_boot  &lt;br&gt;node\_power\_supply\_voltage\_max  &lt;br&gt;node\_power\_supply\_voltage\_max\_design  &lt;br&gt;node\_power\_supply\_voltage\_min  &lt;br&gt;node\_power\_supply\_voltage\_min\_design &lt;br&gt;node\_power\_supply\_voltage\_volt  &lt;br&gt;node\_power\_supply\_voltage\_ocv  &lt;br&gt;node\_power\_supply\_charge\_control\_limit  &lt;br&gt;node\_power\_supply\_charge\_control\_limit\_max  &lt;br&gt;node\_power\_supply\_charge\_counter  &lt;br&gt;node\_power\_supply\_charge\_empty  &lt;br&gt;node\_power\_supply\_charge\_empty\_design  &lt;br&gt;node\_power\_supply\_charge\_full  &lt;br&gt;node\_power\_supply\_charge\_full\_design  &lt;br&gt;node\_power\_supply\_charge\_ampere  &lt;br&gt;node\_power\_supply\_charge\_term\_current  &lt;br&gt;node\_power\_supply\_constant\_charge\_current  &lt;br&gt;node\_power\_supply\_constant\_charge\_current\_max  &lt;br&gt;node\_power\_supply\_constant\_charge\_voltage  &lt;br&gt;node\_power\_supply\_constant\_charge\_voltage\_max  &lt;br&gt;node\_power\_supply\_precharge\_current  &lt;br&gt;node\_power\_supply\_input\_current\_limit  &lt;br&gt;node\_power\_supply\_power\_watt  &lt;br&gt;node\_power\_supply\_temp\_celsius  &lt;br&gt;node\_power\_supply\_temp\_alert\_max\_celsius  &lt;br&gt;node\_power\_supply\_temp\_alert\_min\_celsius  &lt;br&gt;node\_power\_supply\_temp\_ambient\_celsius  &lt;br&gt;node\_power\_supply\_temp\_ambient\_max\_celsius  &lt;br&gt;node\_power\_supply\_temp\_ambient\_min\_celsius  &lt;br&gt;node\_power\_supply\_temp\_max\_celsius  &lt;br&gt;node\_power\_supply\_temp\_min\_celsius| /sys/class/power\_supply |     |
| Exposes pressure stall statistics from/proc/pressure/. | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_pressure\_cpu\_waiting\_seconds\_total  &lt;br&gt;node\_pressure\_io\_waiting\_seconds\_total  &lt;br&gt;node\_pressure\_io\_stalled\_seconds\_total  &lt;br&gt;node\_pressure\_memory\_waiting\_seconds\_total  &lt;br&gt;node\_pressure\_memory\_stalled\_seconds\_total | /proc/pressure/ |     |
| Exposes various statistics from/sys/class/powercap. | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_rapl\_\*\*\*\*\_joules\_total | /sys/class/powercap | æŒ‡æ ‡åç§°ä¸­çš„\*æ ¹æ®/sys/class/powercapä¸­æ–‡ä»¶ä¸­çš„å€¼ç¡®å®š |
| Exposes statistics from/sys/class/scsi\_tape. | ç³»ç»Ÿæ²¡æœ‰è¯¥ç›®å½•æˆ–è€…ç›®å½•ä¸ºç©º | node\_tape\_io\_now  &lt;br&gt;node\_tape\_io\_time\_seconds\_total  &lt;br&gt;node\_tape\_io\_others\_total  &lt;br&gt;node\_tape\_read\_bytes\_total  &lt;br&gt;node\_tape\_reads\_completed\_total  &lt;br&gt;node\_tape\_read\_time\_seconds\_total  &lt;br&gt;node\_tape\_written\_bytes\_total  &lt;br&gt;node\_tape\_writes\_completed\_total  &lt;br&gt;node\_tape\_write\_time\_seconds\_total  &lt;br&gt;node\_tape\_residual\_total | /sys/class/scsi\_tape |     |
| A summary of the number of active and enabled cgroups | æ²¡æŒ‡æ ‡ | node\_cgroups\_cgroups  &lt;br&gt;node\_cgroups\_enabled | /proc/cgroups | release-1.4åŠ å…¥çš„collector |
| Exposes device statistics | æ²¡æŒ‡æ ‡ | node\_devstat\_bytes\_total  &lt;br&gt;node\_devstat\_transfers\_total  &lt;br&gt;node\_devstat\_blocks\_total |     | ä¸æ”¯æŒlinux |
| Exposes network interface information and network driver statistics equivalent toethtool,ethtool -S, andethtool -i. | æ²¡æŒ‡æ ‡ | node\_ethtool\_info  &lt;br&gt;node\_ethtool\_\*  &lt;br&gt;node\_ethtool\_received\_bytes\_total  &lt;br&gt;node\_ethtool\_received\_dropped\_total  &lt;br&gt;node\_ethtool\_received\_errors\_total  &lt;br&gt;node\_ethtool\_received\_packets\_total  &lt;br&gt;node\_ethtool\_transmitted\_bytes\_total  &lt;br&gt;node\_ethtool\_transmitted\_errors\_total  &lt;br&gt;node\_ethtool\_transmitted\_packets\_total  &lt;br&gt;node\_network\_supported\_port\_info  &lt;br&gt;node\_network\_supported\_speed\_bytes  &lt;br&gt;node\_network\_autonegotiate\_supported  &lt;br&gt;node\_network\_pause\_supported  &lt;br&gt;node\_network\_asymmetricpause\_supported  &lt;br&gt;node\_network\_advertised\_speed\_bytes  &lt;br&gt;node\_network\_autonegotiate\_advertised  &lt;br&gt;node\_network\_pause\_advertised  &lt;br&gt;node\_network\_asymmetricpause\_advertised  &lt;br&gt;node\_network\_autonegotiate |     | æŒ‡æ ‡åç§°node\_ethtool\_\*æ ¹æ®ä¸åŒç½‘å£è®¾å¤‡è¿˜æœ‰å…¶ä»–å‚æ•° |
| Exposes statistics about devices in/proc/mdstat(does nothing if no/proc/mdstatpresent). | æ²¡æŒ‡æ ‡ | node\_md\_state  &lt;br&gt;node\_md\_disks  &lt;br&gt;node\_md\_disks\_required  &lt;br&gt;node\_md\_blocks  &lt;br&gt;node\_md\_blocks\_synced | /proc/mdstat |     |
| Exposes filesystem statistics from/proc/self/mountstats. Exposes detailed NFS client statistics. | æ²¡æŒ‡æ ‡ | node\_mountstats\_nfs\_age\_seconds\_total  &lt;br&gt;node\_mountstats\_nfs\_read\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_write\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_direct\_read\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_direct\_write\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_total\_read\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_total\_write\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_read\_pages\_total  &lt;br&gt;node\_mountstats\_nfs\_write\_pages\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_bind\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_connect\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_idle\_time\_seconds  &lt;br&gt;node\_mountstats\_nfs\_transport\_sends\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_receives\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_bad\_transaction\_ids\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_backlog\_queue\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_maximum\_rpc\_slots  &lt;br&gt;node\_mountstats\_nfs\_transport\_sending\_queue\_total  &lt;br&gt;node\_mountstats\_nfs\_transport\_pending\_queue\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_requests\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_transmissions\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_major\_timeouts\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_sent\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_received\_bytes\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_queue\_time\_seconds\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_response\_time\_seconds\_total  &lt;br&gt;node\_mountstats\_nfs\_operations\_request\_time\_seconds\_total &lt;br&gt;node\_mountstats\_nfs\_event\_inode\_revalidate\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_dnode\_revalidate\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_data\_invalidate\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_attribute\_invalidate\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_open\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_lookup\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_access\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_update\_page\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_read\_page\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_read\_pages\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_write\_page\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_write\_pages\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_getdents\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_setattr\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_flush\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_fsync\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_lock\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_vfs\_file\_release\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_truncation\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_write\_extension\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_silly\_rename\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_short\_read\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_short\_write\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_jukebox\_delay\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_pnfs\_read\_total  &lt;br&gt;node\_mountstats\_nfs\_event\_pnfs\_write\_total  | /proc/self/mountstats |     |
| Exposes slab statistics from/proc/slabinfo. Note that permission of/proc/slabinfois usually 0400, so set it appropriately. | æ²¡æŒ‡æ ‡ | node\_slabinfo\_active\_objects  &lt;br&gt;node\_slabinfo\_objects  &lt;br&gt;node\_slabinfo\_object\_size\_bytes  &lt;br&gt;node\_slabinfo\_objects\_per\_slab  &lt;br&gt;node\_slabinfo\_pages\_per\_slab | /proc/slabinfo | release-1.4åŠ å…¥çš„collector |
| Exposes detailed softirq statistics from/proc/softirqs. | æ²¡æŒ‡æ ‡ | node\_softirqs\_functions\_total | /proc/softirqs | release-1.6åŠ å…¥çš„collector |
| Expose sysctl values from/proc/sys. Use\--collector.sysctl.include(-info)to configure. | æ²¡æŒ‡æ ‡ | node\_sysctl\_\* | /proc/sys | release-1.4åŠ å…¥çš„collector;  &lt;br&gt;æŒ‡æ ‡åç§°\*ä¸å‚æ•°â€˜--collector.sysctl.includeâ€™çš„å€¼æœ‰å…³ |
| Exposes CPU frequency statistics | æ²¡æŒ‡æ ‡ | node\_cpu\_frequency\_hertz  &lt;br&gt;node\_cpu\_frequency\_min\_hertz  &lt;br&gt;node\_cpu\_frequency\_max\_hertz  &lt;br&gt;node\_cpu\_scaling\_frequency\_hertz  &lt;br&gt;node\_cpu\_scaling\_frequency\_min\_hertz  &lt;br&gt;node\_cpu\_scaling\_frequency\_max\_hertz | /sys/devices/system/cpu/cpu\[0-9\]\*/cpufreq |     |
| Exposes system boot time derived from thekern.boottimesysctl. | æ²¡æŒ‡æ ‡ | node\_boot\_time\_seconds |     | ä¸æ”¯æŒlinux |
| Exposes netisr statistics | æ²¡æŒ‡æ ‡ | numthreads  &lt;br&gt;maxprot  &lt;br&gt;defaultqlimit  &lt;br&gt;maxqlimit  &lt;br&gt;bindthreads  &lt;br&gt;maxthreads |     | ä¸æ”¯æŒlinuxï¼Œrelease-1.6åŠ å…¥çš„collector |
| Exposes Distributed Replicated Block Device statistics (to version 8.4) | æ²¡æµ‹è¯• | node\_drdb\_network\_sent\_bytes\_total  &lt;br&gt;node\_drdb\_network\_received\_bytes\_total  &lt;br&gt;node\_drdb\_disk\_written\_bytes\_total  &lt;br&gt;node\_drdb\_disk\_read\_bytes\_total  &lt;br&gt;node\_drdb\_activitylog\_writes\_total  &lt;br&gt;node\_drdb\_bitmap\_writes\_total  &lt;br&gt;node\_drdb\_local\_pending  &lt;br&gt;node\_drdb\_remote\_pending  &lt;br&gt;node\_drdb\_remote\_unacknowledged  &lt;br&gt;node\_drdb\_application\_pending  &lt;br&gt;node\_drdb\_epochs  &lt;br&gt;node\_drdb\_out\_of\_sync\_bytes  &lt;br&gt;node\_drdb\_node\_role\_is\_primary  &lt;br&gt;node\_drdb\_disk\_state\_is\_up\_to\_date  &lt;br&gt;node\_drdb\_connected | /proc/drdb |     |
| Exposes error detection and correction statistics. | æ²¡æµ‹è¯• | node\_edac\_correctable\_errors\_total  &lt;br&gt;node\_edac\_uncorrectable\_errors\_total  &lt;br&gt;node\_edac\_csrow\_correctable\_errors\_total  &lt;br&gt;node\_edac\_csrow\_uncorrectable\_errors\_total | /sys/devices/system/edac/mc/mc\[0-9\]\* |     |
| Exposes execution statistics. | æ²¡æµ‹è¯• | node\_exec\_context\_switches\_total  &lt;br&gt;node\_exec\_traps\_total  &lt;br&gt;node\_exec\_system\_calls\_total  &lt;br&gt;node\_exec\_device\_interrupts\_total  &lt;br&gt;node\_exec\_software\_interrupts\_total  &lt;br&gt;node\_exec\_forks\_total |     | ä¸æ”¯æŒlinux |
| Exposes network statistics specific to InfiniBand and Intel OmniPath configurations. | æ²¡æµ‹è¯• | node\_infiniband\_info  &lt;br&gt;node\_infiniband\_legacy\_multicast\_packets\_received\_total  &lt;br&gt;node\_infiniband\_legacy\_multicast\_packets\_transmitted\_total  &lt;br&gt;node\_infiniband\_legacy\_data\_received\_bytes\_total  &lt;br&gt;node\_infiniband\_legacy\_packets\_received\_total  &lt;br&gt;node\_infiniband\_legacy\_unicast\_packets\_received\_total  &lt;br&gt;node\_infiniband\_legacy\_unicast\_packets\_transmitted\_total  &lt;br&gt;node\_infiniband\_legacy\_data\_transmitted\_bytes\_total  &lt;br&gt;node\_infiniband\_legacy\_packets\_transmitted\_total  &lt;br&gt;node\_infiniband\_excessive\_buffer\_overrun\_errors\_total  &lt;br&gt;node\_infiniband\_link\_downed\_total  &lt;br&gt;node\_infiniband\_link\_error\_recovery\_total  &lt;br&gt;node\_infiniband\_local\_link\_integrity\_errors\_total  &lt;br&gt;node\_infiniband\_multicast\_packets\_received\_total  &lt;br&gt;node\_infiniband\_multicast\_packets\_transmitted\_total  &lt;br&gt;node\_infiniband\_physical\_state\_id  &lt;br&gt;node\_infiniband\_port\_constraint\_errors\_received\_total  &lt;br&gt;node\_infiniband\_port\_constraint\_errors\_transmitted\_total  &lt;br&gt;node\_infiniband\_port\_data\_received\_bytes\_total  &lt;br&gt;node\_infiniband\_port\_data\_transmitted\_bytes\_total  &lt;br&gt;node\_infiniband\_port\_discards\_received\_total  &lt;br&gt;node\_infiniband\_port\_discards\_transmitted\_total  &lt;br&gt;node\_infiniband\_port\_errors\_received\_total  &lt;br&gt;node\_infiniband\_port\_packets\_received\_total  &lt;br&gt;node\_infiniband\_port\_packets\_transmitted\_total  &lt;br&gt;node\_infiniband\_port\_transmit\_wait\_total  &lt;br&gt;node\_infiniband\_rate\_bytes\_per\_second  &lt;br&gt;node\_infiniband\_state\_id  &lt;br&gt;node\_infiniband\_unicast\_packets\_received\_total  &lt;br&gt;node\_infiniband\_unicast\_packets\_transmitted\_total  &lt;br&gt;node\_infiniband\_port\_receive\_remote\_physical\_errors\_total  &lt;br&gt;node\_infiniband\_port\_receive\_switch\_relay\_errors\_total  &lt;br&gt;node\_infiniband\_symbol\_error\_total  &lt;br&gt;node\_infiniband\_vl15\_dropped\_total | /sys/class/infiniband/&lt;device&gt; |     |
| Exposes session counts fromlogind. | æ²¡æµ‹è¯• | node\_logind\_sessions | dbus |     |
| Exposes perf based metrics (Warning: Metrics are dependent on kernel configuration and settings). | æ²¡æµ‹è¯• | node\_perf\_cpucycles\_total  &lt;br&gt;node\_perf\_instructions\_total  &lt;br&gt;node\_perf\_branch\_instructions\_total  &lt;br&gt;node\_perf\_branch\_misses\_total  &lt;br&gt;node\_perf\_cache\_refs\_total  &lt;br&gt;node\_perf\_cache\_misses\_total  &lt;br&gt;node\_perf\_ref\_cpucycles\_total  &lt;br&gt;node\_perf\_page\_faults\_total  &lt;br&gt;node\_perf\_context\_switches\_total  &lt;br&gt;node\_perf\_cpu\_migrations\_total  &lt;br&gt;node\_perf\_minor\_faults\_total  &lt;br&gt;node\_perf\_major\_faults\_total  &lt;br&gt;node\_perf\_cache\_l1d\_read\_hits\_total  &lt;br&gt;node\_perf\_cache\_l1d\_read\_misses\_total  &lt;br&gt;node\_perf\_cache\_l1d\_write\_hits\_total  &lt;br&gt;node\_perf\_cache\_l1\_instr\_read\_misses\_total  &lt;br&gt;node\_perf\_cache\_tlb\_instr\_read\_hits\_total  &lt;br&gt;node\_perf\_cache\_tlb\_instr\_read\_misses\_total  &lt;br&gt;node\_perf\_cache\_ll\_read\_hits\_total  &lt;br&gt;node\_perf\_cache\_ll\_read\_misses\_total  &lt;br&gt;node\_perf\_cache\_ll\_write\_hits\_total  &lt;br&gt;node\_perf\_cache\_ll\_write\_misses\_total  &lt;br&gt;node\_perf\_cache\_bpu\_read\_hits\_total  &lt;br&gt;node\_perf\_cache\_bpu\_read\_misses\_total | [github.com/hodgesds/perf-utils](https://github.com/hodgesds/perf-utils) |     |
| Exposes service and system status fromsystemd. | æ²¡æµ‹è¯• | node\_systemd\_unit\_state  &lt;br&gt;node\_systemd\_unit\_start\_time\_seconds  &lt;br&gt;node\_systemd\_unit\_tasks\_current  &lt;br&gt;node\_systemd\_unit\_tasks\_max  &lt;br&gt;node\_systemd\_system\_running  &lt;br&gt;node\_systemd\_units  &lt;br&gt;node\_systemd\_service\_restart\_total  &lt;br&gt;node\_systemd\_timer\_last\_trigger\_seconds  &lt;br&gt;node\_systemd\_socket\_accepted\_connections\_total  &lt;br&gt;node\_systemd\_socket\_current\_connections  &lt;br&gt;node\_systemd\_socket\_refused\_connections\_total  &lt;br&gt;node\_systemd\_version | dbus |     |
| Exposes WiFi device and station statistics. | æ²¡æµ‹è¯• | node\_wifi\_interface\_frequency\_hertz  &lt;br&gt;node\_wifi\_station\_info  &lt;br&gt;node\_wifi\_station\_connected\_seconds\_total  &lt;br&gt;node\_wifi\_station\_inactive\_seconds  &lt;br&gt;node\_wifi\_station\_receive\_bits\_per\_second  &lt;br&gt;node\_wifi\_station\_transmit\_bits\_per\_second  &lt;br&gt;node\_wifi\_station\_receive\_bytes\_total  &lt;br&gt;node\_wifi\_station\_transmit\_bytes\_total  &lt;br&gt;node\_wifi\_station\_signal\_dbm  &lt;br&gt;node\_wifi\_station\_transmit\_retries\_total  &lt;br&gt;node\_wifi\_station\_transmit\_failed\_total  &lt;br&gt;node\_wifi\_station\_beacon\_loss\_total | [github.com/mdlayher/wifi](https://github.com/mdlayher/wifi 'github.com/mdlayher/wifi') |     |
| ExposesZFSperformance statistics. | æ²¡æµ‹è¯• | node\_zfs\_pool\_state  &lt;br&gt;node\_zfs\_zpool\_dataset\_\*  &lt;br&gt;node\_zfs\_zpool\_\*  &lt;br&gt;node\_zfs\_abd\_\*  &lt;br&gt;node\_zfs\_arc\_\*  &lt;br&gt;node\_zfs\_dbuf\_\*  &lt;br&gt;node\_zfs\_dmu\_tx\_\*  &lt;br&gt;node\_zfs\_dnode\_\*  &lt;br&gt;node\_zfs\_fm\_\*  &lt;br&gt;node\_zfs\_vdev\_cache\_\*  &lt;br&gt;node\_zfs\_vdev\_mirror\_\*  &lt;br&gt;node\_zfs\_xuio\_\*  &lt;br&gt;node\_zfs\_zfetch\_\*  &lt;br&gt;node\_zfs\_zil\_\* | /proc/spl/kstat/zfs/\* | \*ç”±kstat-zfs-misc-x-xæ›¿æ¢ï¼Œå…·ä½“æ ¹æ®/proc/spl/kstat/zfs/\*ç¡®å®š |ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/58.html</guid><pubDate>Tue, 21 Jan 2025 03:11:00 +0000</pubDate></item><item><title>process-exporteræŒ‡æ ‡</title><link>https://longxiucai.github.io/post/57.html</link><description>ä½¿ç”¨ä»¥ä¸‹é…ç½®metricsä¸­å…¨éƒ¨æŒ‡æ ‡æ­£å¸¸
[root@amd ~]# cat filename.yml 
```
process_names:
  - name: '{{.Comm}}'
    cmdline:
    - '.+'
 ```
```
docker run -d  -p 9256:9256 --privileged -v /[proc:/host/proc](http://proc/host/proc) -v `pwd`:/config ncabatoff/process-exporter --procfs /host/proc -config.path /config/filename.yml
```

| æŒ‡æ ‡åç§°                                     | æè¿°                                                                                                   | æ¥æº                                                                                                  |
|----------------------------------------------|--------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
| namedprocess_namegroup_num_procs             | Number of processes in this group                                                                      | ç¨‹åºç´¯åŠ                                                                                               |
| namedprocess_namegroup_cpu_seconds_total     | CPU user usage in seconds                                                                              | /proc/[pid]/stat çš„ utime(14) å’Œ stime(15) å­—æ®µ                                                        |
| namedprocess_namegroup_read_bytes_total      | Number of bytes read by this group                                                                     | /proc/[pid]/io çš„ read_bytes å­—æ®µ                                                                      |
| namedprocess_namegroup_write_bytes_total     | Number of bytes written by this group                                                                  | /proc/[pid]/io çš„ write_bytes å­—æ®µ                                                                     |
| namedprocess_namegroup_major_page_faults_total | Major page faults                                                                                     | /proc/[pid]/stat çš„ majflt(12) å­—æ®µ                                                                    |
| namedprocess_namegroup_minor_page_faults_total | Minor page faults                                                                                     | /proc/[pid]/stat çš„ minflt(10) å­—æ®µ                                                                    |
| namedprocess_namegroup_context_switches_total | Context switches                                                                                      | /proc/[pid]/status çš„ voluntary_ctxt_switches å­—æ®µ                                                     |
| namedprocess_namegroup_memory_bytes          | Number of bytes of memory in use                                                                       | resident: /proc/[pid]/stat çš„ rss(24) å­—æ®µ&lt;br&gt;virtual: /proc/[pid]/stat çš„ vsize(23) å­—æ®µ&lt;br&gt;swapped: /proc/[pid]/status çš„ VmSwap å­—æ®µ&lt;br&gt;proportionalResident: /proc/[pid]/smaps çš„ 'Pss' å­—æ®µä¹‹å’Œ&lt;br&gt;proportionalSwapped: /proc/[pid]/smaps çš„ 'SwapPss' å­—æ®µä¹‹å’Œ |
| namedprocess_namegroup_open_filedesc         | Number of open file descriptors for this group                                                         | è®¡ç®—ç›®å½• /proc/[pid]/fd ä¸­æœ‰å¤šå°‘æ¡ç›®                                                                   |
| namedprocess_namegroup_worst_fd_ratio        | The worst (closest to 1) ratio between open fds and max fds among all procs in this group              | /proc/[pid]/limits çš„ fd è½¯é™åˆ¶                                                                        |
| namedprocess_namegroup_oldest_start_time_seconds | Start time in seconds since 1970/01/01 of oldest process in group                                     | /proc/[pid]/stat ä¸­çš„ starttime(22) å­—æ®µæ´¾ç”Ÿå‡ºæ¥çš„                                                     |
| namedprocess_namegroup_num_threads           | Number of threads                                                                                      | Based on field num_threads(20) from /proc/[pid]/stat                                                  |
| namedprocess_namegroup_states                | Number of processes in states Running, Sleeping, Waiting, Zombie, or Other                             | /proc/[pid]/stat çš„ num_threads(20) å­—æ®µ                                                              |
| namedprocess_scrape_errors                   | General scrape errors: no proc metrics collected during a cycle                                        | ç¨‹åºç´¯åŠ                                                                                               |
| namedprocess_scrape_procread_errors          | Incremented each time a proc's metrics collection fails                                                | ç¨‹åºç´¯åŠ                                                                                               |
| namedprocess_scrape_partial_errors           | Incremented each time a tracked proc's metrics collection fails partially, e.g. unreadable I/O stats   | ç¨‹åºç´¯åŠ                                                                                               |
| namedprocess_namegroup_threads_wchan         | Number of threads in this group waiting on each wchan                                                  | /proc/[pid]/wchan                                                                                     |
| namedprocess_namegroup_thread_count          | Number of threads in this group with same threadname                                                   | ç¨‹åºç´¯åŠ                                                                                               |
| namedprocess_namegroup_thread_cpu_seconds_total | CPU user/system usage in seconds                                                                      | ä¸cpu_user_seconds_totalå’Œcpu_system_seconds_totalç›¸åŒï¼Œä½†åˆ†è§£ä¸ºæ¯ä¸ªçº¿ç¨‹å­ç»„ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/57.html</guid><pubDate>Tue, 21 Jan 2025 02:55:42 +0000</pubDate></item><item><title>systemd-exporteræŒ‡æ ‡</title><link>https://longxiucai.github.io/post/56.html</link><description>https://github.com/prometheus-community/systemd_exporter

| æŒ‡æ ‡åç§°                                      | æè¿°                                                     | æ¥æº                                             | æ˜¯å¦éœ€è¦æ·»åŠ è¿è¡Œå‚æ•°                          |
|-----------------------------------------------|----------------------------------------------------------|--------------------------------------------------|-----------------------------------------------|
| systemd_process_open_fds                      | Number of open file descriptors                          | /proc/&lt;pid&gt;/fd/* æ•°é‡                            | --systemd.collector.enable-file-descriptor-size |
| systemd_service_ip_egress_bytes               | Service unit egress IP accounting in bytes               | dbus Service ç±»å‹ IPEgressBytes å±æ€§             | --systemd.collector.enable-ip-accounting       |
| systemd_service_ip_egress_packets_total       | Service unit egress IP accounting in packets             | dbus Service ç±»å‹ IPEgressPackets å±æ€§           | å¦                                           |
| systemd_service_ip_ingress_bytes              | Service unit ingress IP accounting in bytes              | dbus Service ç±»å‹ IPIngressBytes å±æ€§            | å¦                                           |
| systemd_service_ip_ingress_packets_total      | Service unit ingress IP accounting in packets            | dbus Service ç±»å‹ IPIngressPackets å±æ€§          | å¦                                           |
| systemd_service_restart_total                 | Service unit count of Restart triggers                   | dbus Service ç±»å‹ NRestarts å±æ€§                 | --systemd.collector.enable-restart-count      |
| systemd_exporter_build_info                   | A metric with a constant '1' value labeled by version, revision, branch, and goversion from which systemd_exporter was built. | -                                              | å¦                                           |
| systemd_process_cpu_seconds_total             | Total user and system CPU time spent in seconds          | /proc/&lt;pid&gt;/stat ä¸­ç¬¬ 14 ä¸ 15 ä¸ªå€¼çš„å’Œå†é™¤ä»¥ 100 | å¦                                           |
| systemd_process_max_fds                       | Maximum number of open file descriptors                  | /proc/&lt;pid&gt;/limits ä¸­ â€˜Max open filesâ€™ çš„ â€˜Soft Limitâ€™ å€¼ | å¦                                           |
| systemd_process_resident_memory_bytes         | Resident memory size in bytes                            | /proc/&lt;pid&gt;/stat ä¸­ç¬¬ 24 ä¸ªå€¼ä¹˜ pagesize         | å¦                                           |
| systemd_process_virtual_memory_bytes          | Virtual memory size in bytes                             | /proc/&lt;pid&gt;/stat ä¸­ç¬¬ 23 ä¸ªå€¼                    | å¦                                           |
| systemd_process_virtual_memory_max_bytes      | Maximum amount of virtual memory available in bytes      | /proc/&lt;pid&gt;/limits ä¸­ â€˜Max address spaceâ€™ çš„ â€˜Soft Limitâ€™ å€¼ | å¦                                           |
| systemd_socket_accepted_connections_total     | Total number of accepted socket connections              | dbus Service ç±»å‹ NAccepted å±æ€§                 | å¦                                           |
| systemd_socket_current_connections            | Current number of socket connections                     | dbus Service ç±»å‹ NConnections å±æ€§              | å¦                                           |
| systemd_socket_refused_connections_total      | Total number of refused socket connections               | dbus Service ç±»å‹ NRefused å±æ€§                  | å¦                                           |
| systemd_timer_last_trigger_seconds            | Seconds since epoch of last trigger                      | dbus Timer ç±»å‹ LastTriggerUSec å±æ€§å†é™¤ä»¥ 1e6   | å¦                                           |
| systemd_unit_cpu_seconds_total                | Unit CPU time in seconds                                 | cgroup ä¸­çš„ cpuacct.usage_all                    | å¦                                           |
| systemd_unit_info                             | Mostly-static metadata for all unit types                | dbus Service ç±»å‹ Type å±æ€§ã€servicename         | å¦                                           |
| systemd_unit_start_time_seconds               | Start time of the unit since unix epoch in seconds       | dbus Service ç±»å‹ ActiveEnterTimestamp å±æ€§å†é™¤ä»¥ 1e6 | å¦                                           |
| systemd_unit_state                            | Systemd unit                                             | dbus è¿æ¥è·å–æœåŠ¡åˆ—è¡¨æ—¶çš„å€¼                      | å¦                                           |
| systemd_unit_tasks_current                    | Current number of tasks per Systemd unit                 | dbus Service ç±»å‹ TasksCurrent å±æ€§              | å¦                                           |
| systemd_unit_tasks_max                        | Maximum number of tasks per Systemd unit                 | dbus Service ç±»å‹ TasksMax å±æ€§                  | å¦                                           |
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/56.html</guid><pubDate>Tue, 21 Jan 2025 02:46:23 +0000</pubDate></item><item><title>gitå°†ä¸¤ä¸ªåˆ†æ”¯ä¹‹é—´çš„æäº¤ä»¥åŠä¿®æ”¹çš„æ–‡ä»¶è¾“å‡ºä¸ºè¡¨æ ¼</title><link>https://longxiucai.github.io/post/55.html</link><description>```
#!/bin/bash
start_branch=v1.30.7
end_bransh=release-4.17
input_file='input.txt'
git log $(git merge-base $start_branch $end_bransh)..$end_bransh --oneline --reverse --no-merges |grep carry &gt; $input_file
output_file='output.tsv'
# éå†æ¯ä¸€è¡Œï¼Œæå– commit å’Œ messageï¼Œå¹¶è·å– diff æ–‡ä»¶å†…å®¹
while IFS= read -r line; do
    # æå– commit å’Œ message
    commit=$(echo '$line' | awk '{print $1}')
    message=$(echo '$line' | awk '{$1=''; print $0}' | sed 's/^ *//')
    # è·å– diff æ–‡ä»¶å†…å®¹
    diff_output=$(git show $commit|grep '^diff'|cut -d ' ' -f3|cut -d '/' -f 2-)
    # æ‹¼æ¥è¾“å‡ºå†…å®¹å¹¶å†™å…¥æ–‡ä»¶
    echo -e '$commit\t$message\t\'$diff_output\'' &gt;&gt; '$output_file'
done &lt; '$input_file'

echo 'å·²å®Œæˆå¤„ç†ï¼Œç»“æœä¿å­˜åˆ° $output_file'
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/55.html</guid><pubDate>Mon, 20 Jan 2025 09:07:54 +0000</pubDate></item><item><title>vimé”®ä½å‚è€ƒ</title><link>https://longxiucai.github.io/post/54.html</link><description>![image](https://github.com/user-attachments/assets/ceca58b8-1b04-45e5-a38d-bc8222d55a45)&#13;
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/54.html</guid><pubDate>Thu, 16 Jan 2025 02:17:33 +0000</pubDate></item><item><title>kubernetes dnsPolicy</title><link>https://longxiucai.github.io/post/53.html</link><description># dnsPolicyçš„4ç§ç”¨æ³•&#13;
ç­–ç•¥åç§° | è¯´æ˜ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯&#13;
-- | -- | -- | --&#13;
ClusterFirst | é»˜è®¤ç­–ç•¥ï¼Œä¼˜å…ˆé€šè¿‡é›†ç¾¤çš„ DNS è§£æ Kubernetes æœåŠ¡åŸŸåï¼Œæ— æ³•è§£ææ—¶é€€å›åˆ°å®¿ä¸»æœºçš„ DNS è®¾ç½®ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/53.html</guid><pubDate>Wed, 08 Jan 2025 06:37:27 +0000</pubDate></item><item><title>è¿ç»´å¸¸ç”¨å‘½ä»¤/è„šæœ¬</title><link>https://longxiucai.github.io/post/52.html</link><description>1. è·å–kubernetes cluster masterèŠ‚ç‚¹ipåœ°å€&#13;
```&#13;
kubectl get nodes --selector=node-role.kubernetes.io/control-plane='' -o=jsonpath='{.items[*].status.addresses[?(@.type=='InternalIP')].address}'&#13;
&#13;
```&#13;
2.  è·å–kubernetes cluster nodeèŠ‚ç‚¹ipåœ°å€&#13;
```&#13;
kubectl get nodes --selector=node-role.kubernetes.io/node='' -o=jsonpath='{.items[*].status.addresses[?(@.type=='InternalIP')].address}'&#13;
```&#13;
3. é€šè¿‡`ping`è·å–ä¸¢åŒ…ç‡ä¸å¹³å‡å»¶è¿Ÿ&#13;
```shell&#13;
# æ‰§è¡Œpingå‘½ä»¤å¹¶è·å–ç»Ÿè®¡ä¿¡æ¯&#13;
ping_result=$(ping -c 5 '$target' | tail -2)&#13;
# æå–ä¸¢åŒ…ç‡å’Œå¹³å‡å»¶è¿Ÿ&#13;
packet_loss=$(echo '$ping_result' | grep -oP '\d+(?=% packet loss)')&#13;
avg_latency=$(echo '$ping_result' | grep -oP '(?&lt;=rtt min/avg/max/mdev = )[\d.]+/[\d.]+/[\d.]+/[\d.]+' | awk -F '/' '{print $2}')&#13;
```&#13;
4. cpuä½¿ç”¨ç‡&#13;
```&#13;
top -bn1 | grep 'Cpu(s)' | sed 's/.*, *\([0-9.]*\)%* id.*/\1/' | awk '{print 100 - $1}'&#13;
```&#13;
5. å†…å­˜ä½¿ç”¨ç‡&#13;
```&#13;
free | awk 'FNR==2{printf '%.2f', $3/$2*100}'&#13;
```&#13;
6. éšæœºé€‰æ‹©ä¸€ä¸ªipåœ°å€&#13;
```&#13;
echo $IPs | tr ' ' '\n' | shuf -n 1&#13;
```&#13;
7. æ–‡ä»¶æ•°é‡é™åˆ¶ï¼Œæ¸…é™¤å¤šä½™æ–‡ä»¶&#13;
```&#13;
cleanup_old_files() {&#13;
  local DIR='$1'&#13;
  local MAX_FILES='$2'&#13;
&#13;
  # æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨&#13;
  if [ ! -d '$DIR' ]; then&#13;
    echo 'Directory $DIR does not exist.'&#13;
    return 1&#13;
  fi&#13;
&#13;
  # è·å–æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶æŒ‰æ—¶é—´æ’åº&#13;
  FILES=$(ls -1t '$DIR')&#13;
&#13;
  COUNT=$(echo '$FILES' | wc -l)&#13;
&#13;
  # å¦‚æœæ–‡ä»¶æ•°é‡è¶…è¿‡æœ€å¤§é™åˆ¶ï¼Œåˆ™åˆ é™¤æœ€æ—§çš„æ–‡ä»¶&#13;
  if [ $COUNT -gt $MAX_FILES ]; then&#13;
    # è·å–æœ€æ—§çš„æ–‡ä»¶&#13;
    OLD_FILES=$(echo '$FILES' | tail -n $((COUNT - MAX_FILES)))&#13;
    # åˆ é™¤è¿™äº›æ—§çš„æ–‡ä»¶&#13;
    for FILE in $OLD_FILES; do&#13;
      rm '$DIR/$FILE'&#13;
      echo 'Deleted old file: $FILE'&#13;
    done&#13;
  fi&#13;
}&#13;
## ä¾‹å¦‚ç›®å½•/opt/testä¸­åªä¿ç•™5ä»½ï¼š&#13;
cleanup_old_files /opt/test 5&#13;
```&#13;
ä¾‹å¦‚éœ€è¦é€šè¿‡sshè¿œç«¯è°ƒç”¨æ­¤å‡½æ•°&#13;
```&#13;
ssh -q -o StrictHostKeyChecking=no 'root@10.20.30.40' '$(typeset -f cleanup_old_files); cleanup_old_files /opt/test 5'&#13;
```&#13;
8. `dd`æµ‹è¯•å†™é€Ÿç‡&#13;
```&#13;
# ddè¾“å‡ºå¦‚ä¸‹&#13;
[root@abcdefg01 ~]# dd if=/dev/zero of=.tmp.test bs=1M count=100&#13;
è®°å½•äº†100+0 çš„è¯»å…¥&#13;
è®°å½•äº†100+0 çš„å†™å‡º&#13;
104857600å­—èŠ‚ï¼ˆ105 MBï¼Œ100 MiBï¼‰å·²å¤åˆ¶ï¼Œ0.233213 sï¼Œ450 MB/s&#13;
# è¾“å‡ºå†™é€Ÿç‡&#13;
dd if=/dev/zero of=.tmp.test bs=1M count=100 2&gt;&amp;1 | awk 'NR==3{print $0}' | grep -oP '\d+(\.\d+)?\s+[A-Za-z]+/s'&#13;
# ä¸è¦å•ä½&#13;
dd if=/dev/zero of=.tmp.test bs=1M count=100 2&gt;&amp;1 | awk 'NR==3{print $0}' | grep -oP '\d+(\.\d+)?(?=\s+[A-Za-z]+/s)'&#13;
```&#13;
9. alertmanagerå‘Šè­¦æ¥å£ï¼Œäº§ç”Ÿå‘Šè­¦&#13;
```&#13;
curl -X POST http://172.20.41.32:30300/api/v2/alerts \&#13;
  -H 'Content-Type: application/json' \&#13;
  -d '[&#13;
    {&#13;
      'labels': {&#13;
        'alertname': 'ç³»ç»Ÿè¿ç»­å´©æºƒï¼Œå·²ç»å‡ºç°é›ªå´©çŠ¶å†µï¼',&#13;
        'dev': 'sda1',&#13;
        'instance': 'å®ä¾‹1',&#13;
        'msgtype': 'testing'&#13;
      },&#13;
      'annotations': {&#13;
        'info': 'ç¨‹åºå‘˜å°ç‹æç¤ºæ‚¨ï¼šè¿™ä¸ªç³»ç»Ÿé›ªå´©äº†ï¼Œå¿«å¤„ç†ï¼',&#13;
        'summary': 'è¯·æ£€æŸ¥å®ä¾‹ç¤ºä¾‹1'&#13;
      }&#13;
    },&#13;
    {&#13;
      'labels': {&#13;
        'alertname': 'ç®¡ç†ç³»ç»ŸæŸå',&#13;
        'dev': 'sda2',&#13;
        'instance': 'å®ä¾‹1',&#13;
        'msgtype': 'testing'&#13;
      },&#13;
      'annotations': {&#13;
        'info': 'ç¨‹åºå‘˜å°ç‹æç¤ºæ‚¨ï¼šç”µå­å•†åŠ¡ç®¡ç†ç³»ç»Ÿä¸­è®¢å•ï¼Œä»“åº“æ¨¡å—å·²ç»é›ªå´©ï¼Œå¿«å¤„ç†ï¼',&#13;
        'summary': 'è¯·æ£€æŸ¥å®ä¾‹ç¤ºä¾‹1',&#13;
        'runbook': 'ä»¥ä¸‹é“¾æ¥http://192.168.5.128:9093/api/v2/alertsåº”è¯¥æ˜¯å¯ç‚¹å‡»çš„'&#13;
      }&#13;
    }&#13;
  ]'&#13;
&#13;
```&#13;
10. é›†ç¾¤ä¸­å…¨éƒ¨å®¹å™¨è¿è¡Œdateå‘½ä»¤æ£€æŸ¥æ—¶åŒºï¼ˆdateå‘½ä»¤ä¸å­˜åœ¨çš„æƒ…å†µä¸‹æŠ¥é”™ï¼‰&#13;
```&#13;
kubectl get pods -A -o 'jsonpath={range .items[*]}{.metadata.namespace}{'\t'}{.metadata.name}{'\t'}{range .spec.containers[*]}{.name}{'\t'}{end}{'\n'}{end}' | while IFS=$'\t' read -r namespace pod containers; do&#13;
    for container in $containers; do&#13;
        if [[ -z '$container' ]]; then&#13;
            echo -e '$namespace,$pod,No container found,-'&#13;
            continue&#13;
        fi&#13;
        output=$(kubectl exec -n '$namespace' '$pod' -c '$container' -- date 2&gt;&amp;1)&#13;
        echo -e '$namespace,$pod,$container,$output'&#13;
    done&#13;
done&#13;
```&#13;
11. å»é™¤é‡å¤è¡Œ&#13;
```&#13;
awk '!a[$0]++' /path/to/file&#13;
```&#13;
12. æ‹‰å–å¤–ç½‘é•œåƒä¸Šä¼ åˆ°å†…ç½‘harborï¼Œé€šè¿‡ä»£ç†æ‹‰é•œåƒï¼Œé€šè¿‡docker manifeståšmultiã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/52.html</guid><pubDate>Tue, 10 Dec 2024 07:49:40 +0000</pubDate></item><item><title>calico network policyåªå¼€é€špodé—´tcpæµé‡</title><link>https://longxiucai.github.io/post/51.html</link><description># èµ„æºæ–‡ä»¶&#13;
```&#13;
apiVersion: v1&#13;
kind: Pod&#13;
metadata:&#13;
  name: busybox-pod1&#13;
  labels:&#13;
    app: busybox-pod1&#13;
spec:&#13;
  containers:&#13;
  - name: busybox&#13;
    image: busybox:1.28&#13;
    command: ['sleep', '360000']&#13;
    tty: true&#13;
---&#13;
apiVersion: v1&#13;
kind: Pod&#13;
metadata:&#13;
  name: busybox-pod2&#13;
  labels:&#13;
    app: busybox-pod2&#13;
spec:&#13;
  containers:&#13;
  - name: busybox&#13;
    image: busybox:1.28&#13;
    command: ['sleep', '360000']&#13;
    tty: true&#13;
---&#13;
apiVersion: networking.k8s.io/v1&#13;
kind: NetworkPolicy&#13;
metadata:&#13;
  name: allow-tcp-block-icmp&#13;
  namespace: default  # æ ¹æ®æ‚¨çš„å®é™… namespace ä¿®æ”¹&#13;
spec:&#13;
  podSelector:&#13;
    matchLabels:&#13;
      app: busybox-pod1  # é€‰æ‹© busybox-pod1ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´&#13;
  policyTypes:&#13;
  - Ingress&#13;
  - Egress&#13;
  ingress:&#13;
  - from:&#13;
    - podSelector:&#13;
        matchLabels:&#13;
          app: busybox-pod2  # å…è®¸ busybox-pod2 å‘é€çš„æµé‡&#13;
    ports:&#13;
    - protocol: TCP&#13;
      port: 8080  # æŒ‡å®šè¦å…è®¸çš„ TCP ç«¯å£å·ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹&#13;
  egress:&#13;
  - to:&#13;
    - podSelector:&#13;
        matchLabels:&#13;
          app: busybox-pod2  # å…è®¸ busybox-pod1 è®¿é—® busybox-pod2&#13;
    ports:&#13;
    - protocol: TCP&#13;
      port: 8080  # åŒæ ·æŒ‡å®šè¦å…è®¸çš„ TCP ç«¯å£å·&#13;
```&#13;
# éªŒè¯&#13;
* pod1æ‰§è¡Œkubectl exec -it busybox-pod1 -- nc -l -p 8080&#13;
* pod2æ‰§è¡Œkubectl exec -it busybox-pod1 -- nc &lt;pod1çš„ipåœ°å€&gt; 8080ï¼Œç„¶åè¾“å…¥ä»»æ„å­—ç¬¦å›è½¦ï¼Œpod1ç«¯ä¼šæœ‰æ‰“å°ï¼Œtcpè¿æ¥æˆåŠŸã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/51.html</guid><pubDate>Tue, 22 Oct 2024 07:05:22 +0000</pubDate></item><item><title>äº¤å‰ç¼–è¯‘æ‰“åŒ…dockeré•œåƒï¼ˆgoç¨‹åºï¼‰</title><link>https://longxiucai.github.io/post/50.html</link><description>## Dockerfile&#13;
```&#13;
# Build the manager binary&#13;
FROM --platform=${BUILDPLATFORM} golang:1.19 as builder&#13;
WORKDIR /workspace&#13;
# Copy the Go Modules manifests&#13;
COPY go.mod go.mod&#13;
COPY go.sum go.sum&#13;
# Copy the go source&#13;
COPY pkg/ pkg/&#13;
COPY cmd/ cmd/&#13;
COPY internal/ internal/&#13;
COPY lib/ lib/&#13;
COPY controllers/ controllers/&#13;
COPY vendor/ vendor/&#13;
&#13;
# Build&#13;
ARG TARGETARCH&#13;
RUN echo 'Building for $TARGETARCH platform' &amp;&amp; \&#13;
    CGO_ENABLED=0 GOOS=linux GOARCH=$TARGETARCH go build -mod=vendor -a -o controller cmd/machine-config-controller/main.go&#13;
&#13;
# Use distroless as minimal base image to package the manager binary&#13;
FROM --platform=${BUILDPLATFORM} harbor.kylincloudnative.com/docker.io/library/alpine:latest&#13;
WORKDIR /&#13;
COPY --from=builder /workspace/controller .&#13;
USER 65532:65532&#13;
&#13;
ENTRYPOINT ['/controller']&#13;
```&#13;
## Makefile&#13;
```&#13;
PLATFORMS ?= linux/arm64,linux/amd64 ###,linux/s390x,linux/ppc64le&#13;
.PHONY: docker-buildx&#13;
#make docker-buildx IMG=harbor.kylincloudnative.com/longyuxiang/mco-controller:v1-20231221&#13;
docker-buildx: version  ## Build and push docker image for the manager for cross-platform support&#13;
	- docker buildx create --name project-v3-builder&#13;
	- docker buildx use project-v3-builder&#13;
	- docker buildx build --push --platform=$(PLATFORMS) --tag ${IMG} -f Dockerfile .&#13;
	- docker buildx rm project-v3-builder&#13;
```&#13;
## use&#13;
```&#13;
make docker-buildx IMG=harbor.xxx.com/longyuxiang/mco-daemon:v1-20231221&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/50.html</guid><pubDate>Fri, 18 Oct 2024 02:27:58 +0000</pubDate></item><item><title>kubelet kubelet-client-current.pemè¯ä¹¦è¿‡æœŸæ‰‹åŠ¨ç”Ÿæˆ</title><link>https://longxiucai.github.io/post/49.html</link><description>* é¦–å…ˆå¤‡ä»½kubeletè¯ä¹¦ç›®å½•ï¼Œé»˜è®¤ä¸º`/var/lib/kubelet/pki`ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/49.html</guid><pubDate>Fri, 13 Sep 2024 01:33:39 +0000</pubDate></item><item><title>kubernetes IPv4/IPv6åŒæ ˆé…ç½®</title><link>https://longxiucai.github.io/post/48.html</link><description>calicoå‚è€ƒï¼šhttps://docs.tigera.io/calico/latest/networking/ipam/ipv6#enable-dual-stack
k8så‚è€ƒï¼šhttps://kubernetes.io/docs/concepts/services-networking/dual-stack/#configure-ipv4-ipv6-dual-stack

# å…ˆå†³æ¡ä»¶
1. å†…æ ¸å‚æ•°`net.ipv6.conf.all.forwarding`éœ€è¦è®¾ç½®ä¸º1
2. é›†ç¾¤èŠ‚ç‚¹ä¹‹é—´ipv6éœ€è¦è¿é€š
3. Kubernetes 1.20 ç‰ˆæœ¬æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆä½ç‰ˆæœ¬å‚è€ƒç‰ˆæœ¬æ–‡æ¡£ä¿®æ”¹k8sé…ç½®ï¼Œå¦‚[v1.19](https://github.com/kubernetes/website/blob/release-1.19/content/zh/docs/concepts/services-networking/dual-stack.md)ï¼‰
4. æ”¯æŒåŒåè®®æ ˆçš„[ç½‘ç»œæ’ä»¶](https://kubernetes.io/zh-cn/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/)ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/48.html</guid><pubDate>Thu, 05 Sep 2024 07:31:58 +0000</pubDate></item><item><title>åŠ¨æ€è§„åˆ’-01èƒŒåŒ…</title><link>https://longxiucai.github.io/post/47.html</link><description>### 01 èƒŒåŒ…é—®é¢˜&#13;
&#13;
- **ç‰©å“ä»·å€¼**: `5, 10, 3, 6, 3`&#13;
- **ç‰©å“é‡é‡**: `2, 5, 1, 4, 3`&#13;
- **èƒŒåŒ…å®¹é‡**: `6`&#13;
&#13;
|ä¸‹æ ‡ |	0 | 	1| 	2 |	3 | 	4  &#13;
|-------|---|---|---|---|---|&#13;
|ä»·å€¼ | 5| 10| 3| 6 |	3|&#13;
|é‡é‡ |  2|5| 1|	4|	3|&#13;
&#13;
| ç‰©å“ \ èƒŒåŒ…å®¹é‡ | 0 | 1 | 2 | 3 | 4 | 5 | 6 |&#13;
|-----------------|---|---|---|---|---|---|---|&#13;
|0	| 0 | 0 |	0|	0|	0|	0|	0&#13;
|1	| 0 |0|	5|	5|	5|	5|	5&#13;
|2	| 0 |0|	5|	5|	5|	10|	10&#13;
|3	| 0 |3|	5|	8|	8|	10|13&#13;
|4	| 0 |3|	5|	8|	8|	10|	13&#13;
|5	| 0 |3|	5|	8|	8|	10|	13&#13;
### è¯´æ˜ï¼š&#13;
- dpè¡¨æ ¼ä¸­å­˜åœ¨i=0çš„è¡Œï¼Œè¡¨ç¤ºä¸é€‰ä»»ä½•ç‰©å“ï¼Œdpçš„è¡Œæ•°ä¸ºç‰©å“æ•°é‡+1ï¼Œå› æ­¤åœ¨è·å–ç‰©å“ä»·å€¼ä¸ç‰©å“é‡é‡çš„æ—¶å€™éœ€è¦ä¸‹æ ‡i-1&#13;
- **è¡Œ**: è¡¨ç¤ºå‰ `i` ä¸ªç‰©å“ï¼ˆä¸‹æ ‡&lt;=i-1ï¼‰ï¼ˆç‰©å“ç¼–å·ä» 0 åˆ° 5ï¼‰&#13;
- **åˆ—**: è¡¨ç¤ºèƒŒåŒ…å®¹é‡ `j`ï¼ˆå®¹é‡ä» 0 åˆ° 6ï¼‰&#13;
- **dp[i][j]**: è¡¨ç¤ºè€ƒè™‘å‰ `i` ä¸ªç‰©å“ï¼ˆä¸‹æ ‡&lt;=i-1ï¼‰ï¼Œåœ¨èƒŒåŒ…å®¹é‡ä¸º `j` æ—¶çš„æœ€å¤§ä»·å€¼&#13;
### æ€è·¯&#13;
å¾€dpè¡¨æ ¼ä¸­è®¡ç®—å¡«å†™å€¼ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/47.html</guid><pubDate>Wed, 28 Aug 2024 08:56:30 +0000</pubDate></item><item><title>gitlabè½¯ä»¶åŒ…å‘å¸ƒã€cicdã€‘</title><link>https://longxiucai.github.io/post/46.html</link><description>ä»¥goç¨‹åºä¸ºä¾‹ï¼Œbuild.shç¼–è¯‘è¾“å‡ºç‰©æ–™ä¸º`_output`ç›®å½•ï¼Œç„¶åå°†å…¶æ‰“åŒ…ä¸º`è½¯ä»¶åç§°-åˆ†æ”¯åç§°-æ—¥æœŸ.tar`ï¼Œç„¶åé€šè¿‡apiæ¥å‘å¸ƒ&#13;
å®˜æ–¹æ–‡æ¡£å‚è€ƒï¼š https://docs.gitlab.com/ee/user/packages/generic_packages/index.html#publish-a-generic-package-by-using-&#13;
```yaml1&#13;
stages:&#13;
  - build-and-uploads&#13;
&#13;
build_job:&#13;
  stage: build-and-uploads&#13;
  script:&#13;
    - bash build.sh aarch64&#13;
    - bash build.sh x86_64&#13;
    - mv _output installer-apiserver-$CI_COMMIT_REF_NAME-$(date +%Y%m%d)&#13;
    - tar -cf installer-apiserver-$CI_COMMIT_REF_NAME-$(date +%Y%m%d).tar installer-apiserver-$CI_COMMIT_REF_NAME-$(date +%Y%m%d)/&#13;
    - |&#13;
      curl --header 'JOB-TOKEN: $CI_JOB_TOKEN' --upload-file installer-apiserver-$CI_COMMIT_REF_NAME-$(date +%Y%m%d).tar '${CI_API_V4_URL}/projects/${CI_PROJECT_ID}/packages/generic/installer-apiserver-output/$CI_COMMIT_REF_NAME/installer-apiserver-$CI_COMMIT_REF_NAME-$(date +%Y%m%d).tar'&#13;
```&#13;
ç„¶åå³å¯åœ¨é¡µé¢æŸ¥çœ‹ï¼š&#13;
![1723798006765](https://github.com/user-attachments/assets/92ac40ef-c330-40e5-82ce-2144e66e3008)&#13;
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/46.html</guid><pubDate>Fri, 16 Aug 2024 08:50:10 +0000</pubDate></item><item><title>gitä½¿ç”¨æ‰‹å†Œ</title><link>https://longxiucai.github.io/post/45.html</link><description># Git é€ŸæŸ¥è¡¨&#13;
&#13;
## åˆ›å»º&#13;
&#13;
| æ“ä½œ | å‘½ä»¤ |&#13;
| --- | --- |&#13;
| å…‹éš†ç°æœ‰ä»“åº“ | `git clone ssh://user@domain.com/repo.git` |&#13;
| åˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬åœ°ä»“åº“ | `git init` |&#13;
&#13;
## æœ¬åœ°ä¿®æ”¹&#13;
&#13;
| æ“ä½œ | å‘½ä»¤ |&#13;
| --- | --- |&#13;
| æŸ¥çœ‹å·¥ä½œç›®å½•ä¸­å·²æ›´æ”¹çš„æ–‡ä»¶ï¼ˆå³æŸ¥çœ‹ Git çŠ¶æ€ï¼‰ | `git status` |&#13;
| æŸ¥çœ‹è·Ÿè¸ªæ–‡ä»¶çš„æ›´æ”¹ï¼ˆå³è¿œç¨‹ä»“åº“ä¸æœ¬åœ°ä»“åº“æ–‡ä»¶çš„ä¸åŒï¼‰ | `git diff` |&#13;
| å°†æ‰€æœ‰å½“å‰æ›´æ”¹æ·»åŠ åˆ°ä¸‹ä¸€æ¬¡æäº¤ï¼ˆå³å…¨éƒ¨æäº¤ï¼‰ | `git add .` |&#13;
| å°†æŸä¸ªæ–‡ä»¶çš„æ›´æ”¹æ·»åŠ åˆ°ä¸‹ä¸€æ¬¡æäº¤ï¼ˆå³éƒ¨åˆ†æäº¤ï¼‰ | `git add -p &lt;file&gt;` |&#13;
| æäº¤è·Ÿè¸ªæ–‡ä»¶ä¸­çš„æ‰€æœ‰æœ¬åœ°æ›´æ”¹ | `git commit -a` |&#13;
| æäº¤å…ˆå‰è¿›è¡Œçš„æ›´æ”¹ | `git commit` |&#13;
| æ›´æ”¹æœ€åä¸€æ¬¡æäº¤ï¼ˆä¸è¦ä¿®æ”¹å·²å‘å¸ƒçš„æäº¤ï¼‰ | `git commit --amend` |&#13;
&#13;
## æäº¤å†å²&#13;
&#13;
| æ“ä½œ | å‘½ä»¤ |&#13;
| --- | --- |&#13;
| æ˜¾ç¤ºæ‰€æœ‰æäº¤ï¼Œä»æœ€æ–°çš„æäº¤å¼€å§‹ | `git log` |&#13;
| æ˜¾ç¤ºç‰¹å®šæ–‡ä»¶éšæ—¶é—´çš„ä¿®æ”¹ | `git log -p &lt;file&gt;` |&#13;
| æŸ¥çœ‹ç‰¹å®šæ–‡ä»¶ä»€ä¹ˆæ—¶é—´è¢«ä»€ä¹ˆäººä¿®æ”¹äº†ä»€ä¹ˆå†…å®¹ | `git blame &lt;file&gt;` |&#13;
&#13;
## åˆ†æ”¯å’Œæ ‡ç­¾&#13;
&#13;
| æ“ä½œ | å‘½ä»¤ |&#13;
| --- | --- |&#13;
| åˆ—å‡ºæ‰€æœ‰ç°æœ‰åˆ†æ”¯ | `git branch -av` |&#13;
| åˆ‡æ¢å½“å‰åˆ†æ”¯ | `git checkout &lt;branch&gt;` |&#13;
| åŸºäºå½“å‰ HEAD æŒ‡é’ˆåˆ›å»ºæ–°åˆ†æ”¯ | `git branch &lt;new-branch&gt;` |&#13;
| åŸºäºå½“å‰è¿œç¨‹åˆ†æ”¯åˆ›å»ºä¸€ä¸ªæ–°è·Ÿè¸ªåˆ†æ”¯ | `git checkout --track &lt;remote/branch&gt;` |&#13;
| åˆ é™¤ä¸€ä¸ªæœ¬åœ°åˆ†æ”¯ | `git branch -d &lt;branch&gt;` |&#13;
| å°†ä¸€æ¬¡æäº¤æ ‡è®°ä¸ºä¸€ä¸ªæ ‡ç­¾ | `git tag &lt;tag-name&gt;` |&#13;
&#13;
## æ›´æ–°å’Œæ¨é€&#13;
&#13;
| æ“ä½œ | å‘½ä»¤ |&#13;
| --- | --- |&#13;
| åˆ—å‡ºå½“å‰ä»“åº“å…³è”çš„æ‰€æœ‰è¿œç¨‹ä»“åº“ | `git remote -v` |&#13;
| æ˜¾ç¤ºè¿œç¨‹ä»“åº“çš„è¯¦ç»†ä¿¡æ¯ | `git remote show &lt;remote&gt;` |&#13;
| å…³è”ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°ä»“åº“ | `git remote add &lt;shortname&gt; &lt;url&gt;` |&#13;
| ä»…æ‹‰å–è¿œç¨‹ä»“åº“æ‰€æœ‰æ›´æ”¹ï¼Œä¸åˆå¹¶åˆ°æœ¬åœ°ä»“åº“ | `git fetch &lt;remote&gt;` |&#13;
| æ‹‰å–è¿œç¨‹ä»“åº“æ‰€æœ‰æ›´æ”¹ï¼Œå¹¶åˆå¹¶åˆ°æœ¬åœ°ä»“åº“ | `git pull &lt;remote&gt; &lt;branch&gt;` |&#13;
| æ¨é€æœ¬åœ°ä»“åº“ä¿®æ”¹åˆ°è¿œç¨‹ä»“åº“ | `git push &lt;remote&gt; &lt;branch&gt;` |&#13;
| åˆ é™¤è¿œç¨‹ä»“åº“çš„ä¸€ä¸ªåˆ†æ”¯ | `git branch -dr &lt;remote/branch&gt;` |&#13;
| æ¨é€æ‰€æœ‰æœ¬åœ°ä»“åº“æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“ | `git push --tags` |&#13;
&#13;
## åˆå¹¶å’Œå˜åŸº&#13;
&#13;
| æ“ä½œ | å‘½ä»¤ |&#13;
| --- | --- |&#13;
| åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ | `git merge &lt;branch&gt;` |&#13;
| å˜åŸº | `git rebase &lt;branch&gt;` |&#13;
| æ”¾å¼ƒå˜åŸº | `git rebase --abort` |&#13;
| è§£å†³å†²çªä¹‹åç»§ç»­å˜åŸº | `git rebase --continue` |&#13;
| è¿è¡Œåˆå¹¶å†²çªè§£å†³å·¥å…·æ¥è§£å†³åˆå¹¶å†²çª | `git mergetool` |&#13;
| ä½¿ç”¨ç¼–è¾‘å™¨æ‰‹åŠ¨è§£å†³å†²çªï¼Œå¹¶ï¼ˆåœ¨è§£å†³ä¹‹åï¼‰å°†æ–‡ä»¶æ ‡è®°ä¸ºå·²è§£å†³ | `git add &lt;resolved-file&gt;`&lt;br&gt;`git rm &lt;resolved-file&gt;` |&#13;
&#13;
## æ’¤é”€&#13;
&#13;
| æ“ä½œ | å‘½ä»¤ |&#13;
| --- | --- |&#13;
| æ”¾å¼ƒå·¥ä½œç›®å½•ä¸­çš„æ‰€æœ‰æœ¬åœ°æ›´æ”¹ | `git reset --hard HEAD` |&#13;
| æ”¾å¼ƒç‰¹å®šæ–‡ä»¶ä¸­çš„æœ¬åœ°æ›´æ”¹ | `git checkout HEAD &lt;file&gt;` |&#13;
| è¿˜åŸæäº¤ | `git revert &lt;commit&gt;` |&#13;
| å°†ä½ çš„ HEAD æŒ‡é’ˆé‡ç½®ä¸ºä¸Šä¸€æ¬¡æäº¤ï¼Œå¹¶æ”¾å¼ƒæ­¤åçš„æ‰€æœ‰æ›´æ”¹ | `git reset --hard &lt;commit&gt;` |&#13;
| é‡ç½® HEAD æŒ‡é’ˆï¼Œå¹¶å°†æ‰€æœ‰æ›´æ”¹ä¿ç•™ä¸ºæœªæäº¤çš„æ›´æ”¹ | `git reset &lt;commit&gt;` |&#13;
| é‡ç½® HEAD æŒ‡é’ˆï¼Œå¹¶ä¿ç•™æœªæäº¤çš„æœ¬åœ°æ›´æ”¹ | `git reset --keep &lt;commit&gt;` |&#13;
&#13;
# åŸºç¡€çŸ¥è¯†&#13;
## é…ç½®&#13;
```&#13;
git config --global user.name 'Your Name'&#13;
git config --global user.email 'email@example.com'&#13;
```&#13;
ä¸Šè¿°å‘½ä»¤é‡Œçš„nameå’ŒEmailæ˜¯ä½ æ³¨å†ŒGitHubæ—¶ä½¿ç”¨çš„nameå’ŒEmail&#13;
&gt; [!TIP]&#13;
&gt; git configå‘½ä»¤çš„â€“globalå‚æ•°,ç”¨äº†è¿™ä¸ªå‚æ•°,è¡¨ç¤ºä½ è¿™å°æœºå™¨ä¸Šæ‰€æœ‰çš„Gitä»“åº“éƒ½ä¼šä½¿ç”¨è¿™ä¸ªé…ç½®,å½“ç„¶ä¹Ÿå¯ä»¥å¯¹æŸä¸ªä»“åº“æŒ‡å®šä¸åŒçš„ç”¨æˆ·åå’ŒEmailåœ°å€ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/45.html</guid><pubDate>Fri, 16 Aug 2024 03:38:46 +0000</pubDate></item><item><title>ã€goã€‘åˆ‡ç‰‡æ‰©å®¹</title><link>https://longxiucai.github.io/post/44.html</link><description>ä¸€èˆ¬éƒ½æ˜¯åœ¨å‘ `slice` è¿½åŠ äº†å…ƒç´ ä¹‹åï¼Œæ‰ä¼šå¼•èµ·æ‰©å®¹ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/44.html</guid><pubDate>Mon, 12 Aug 2024 08:05:00 +0000</pubDate></item><item><title>ã€goã€‘æ¥å£-åº•å±‚å®ç°</title><link>https://longxiucai.github.io/post/42.html</link><description>iface å’Œ eface éƒ½æ˜¯ Go ä¸­æè¿°æ¥å£çš„åº•å±‚ç»“æ„ä½“ï¼ŒåŒºåˆ«åœ¨äº iface æè¿°çš„æ¥å£åŒ…å«æ–¹æ³•ï¼Œè€Œ eface åˆ™æ˜¯ä¸åŒ…å«ä»»ä½•æ–¹æ³•çš„ç©ºæ¥å£ï¼šinterface{}ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/42.html</guid><pubDate>Fri, 09 Aug 2024 07:04:55 +0000</pubDate></item><item><title>ã€goã€‘æ¥å£-å¤šæ€</title><link>https://longxiucai.github.io/post/41.html</link><description>Go è¯­è¨€å¹¶æ²¡æœ‰è®¾è®¡è¯¸å¦‚è™šå‡½æ•°ã€çº¯è™šå‡½æ•°ã€ç»§æ‰¿ã€å¤šé‡ç»§æ‰¿ç­‰æ¦‚å¿µï¼Œä½†å®ƒé€šè¿‡æ¥å£å´éå¸¸ä¼˜é›…åœ°æ”¯æŒäº†é¢å‘å¯¹è±¡çš„ç‰¹æ€§ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/41.html</guid><pubDate>Fri, 09 Aug 2024 06:19:17 +0000</pubDate></item><item><title>ã€goã€‘channelçš„åº”ç”¨</title><link>https://longxiucai.github.io/post/40.html</link><description>Channel å’Œ goroutine çš„ç»“åˆæ˜¯ Go å¹¶å‘ç¼–ç¨‹çš„å¤§æ€å™¨ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/40.html</guid><pubDate>Fri, 09 Aug 2024 06:11:20 +0000</pubDate></item><item><title>ã€goã€‘channelçš„æ•°æ®ç»“æ„</title><link>https://longxiucai.github.io/post/39.html</link><description>```&#13;
type hchan struct {&#13;
	// chan é‡Œå…ƒç´ æ•°é‡&#13;
	qcount   uint&#13;
	// chan åº•å±‚å¾ªç¯æ•°ç»„çš„é•¿åº¦&#13;
	dataqsiz uint&#13;
	// æŒ‡å‘åº•å±‚å¾ªç¯æ•°ç»„çš„æŒ‡é’ˆ&#13;
	// åªé’ˆå¯¹æœ‰ç¼“å†²çš„ channel&#13;
	buf      unsafe.Pointer&#13;
	// chan ä¸­å…ƒç´ å¤§å°&#13;
	elemsize uint16&#13;
	// chan æ˜¯å¦è¢«å…³é—­çš„æ ‡å¿—&#13;
	closed   uint32&#13;
	// chan ä¸­å…ƒç´ ç±»å‹&#13;
	elemtype *_type // element type&#13;
	// å·²å‘é€å…ƒç´ åœ¨å¾ªç¯æ•°ç»„ä¸­çš„ç´¢å¼•&#13;
	sendx    uint   // send index&#13;
	// å·²æ¥æ”¶å…ƒç´ åœ¨å¾ªç¯æ•°ç»„ä¸­çš„ç´¢å¼•&#13;
	recvx    uint   // receive index&#13;
	// ç­‰å¾…æ¥æ”¶çš„ goroutine é˜Ÿåˆ—&#13;
	recvq    waitq  // list of recv waiters&#13;
	// ç­‰å¾…å‘é€çš„ goroutine é˜Ÿåˆ—&#13;
	sendq    waitq  // list of send waiters&#13;
&#13;
	// ä¿æŠ¤ hchan ä¸­æ‰€æœ‰å­—æ®µ&#13;
	lock mutex&#13;
}&#13;
```&#13;
`buf` æŒ‡å‘åº•å±‚å¾ªç¯æ•°ç»„ï¼Œåªæœ‰**ç¼“å†²å‹**çš„ `channel` æ‰æœ‰ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/39.html</guid><pubDate>Fri, 09 Aug 2024 01:22:25 +0000</pubDate></item><item><title>ã€goã€‘æ¥å£-ç±»å‹è½¬æ¢ä¸æ–­è¨€</title><link>https://longxiucai.github.io/post/38.html</link><description>æˆ‘ä»¬çŸ¥é“ï¼ŒGo è¯­è¨€ä¸­ä¸å…è®¸éšå¼ç±»å‹è½¬æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´ `=` ä¸¤è¾¹ï¼Œä¸å…è®¸å‡ºç°ç±»å‹ä¸ç›¸åŒçš„å˜é‡ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/38.html</guid><pubDate>Thu, 08 Aug 2024 09:10:43 +0000</pubDate></item><item><title>logrotate</title><link>https://longxiucai.github.io/post/37.html</link><description>## å‘½ä»¤æ ¼å¼&#13;
```&#13;
logrotateÂ [OPTION...]Â &lt;configfile&gt;&#13;
-d, --debug ï¼šdebugæ¨¡å¼ï¼Œæµ‹è¯•é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é”™è¯¯ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/37.html</guid><pubDate>Wed, 07 Aug 2024 02:55:13 +0000</pubDate></item><item><title>linuxæ ¹åˆ†åŒºæ‰©å®¹</title><link>https://longxiucai.github.io/post/36.html</link><description>```&#13;
[root@master1 ~]# pvcreate /dev/sdb &#13;
  Physical volume '/dev/sdb' successfully created.&#13;
[root@master1 ~]# vgextend klas /dev/sdb&#13;
  Volume group 'klas' successfully extended&#13;
[root@master1 ~]# lvextend /dev/klas/root /dev/sdb &#13;
  Size of logical volume klas/root changed from &lt;61.34 GiB (15703 extents) to &lt;141.34 GiB (36182 extents).&#13;
  Logical volume klas/root successfully resized.&#13;
[root@master1 ~]# xfs_growfs /&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/36.html</guid><pubDate>Tue, 06 Aug 2024 07:01:13 +0000</pubDate></item><item><title>gocolor</title><link>https://longxiucai.github.io/post/35.html</link><description>```&#13;
import ct 'github.com/daviddengcn/go-colortext'&#13;
&#13;
func PrintYellow(out io.Writer, content string) {&#13;
	ct.ChangeColor(ct.Yellow, false, ct.None, false)&#13;
	fmt.Fprint(out, content)&#13;
	ct.ResetColor()&#13;
}&#13;
...&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/35.html</guid><pubDate>Thu, 01 Aug 2024 03:36:20 +0000</pubDate></item><item><title>è®°å½•maxcaleæ‰¾ä¸åˆ°ä¸»çš„å¼‚å¸¸</title><link>https://longxiucai.github.io/post/34.html</link><description>### é—®é¢˜ç°è±¡&#13;
maxcaleçš„podä¸­æŸ¥çœ‹å¦‚ä¸‹å›¾æ‰€ç¤º&#13;
![å¾®ä¿¡å›¾ç‰‡_20240730141907](https://github.com/user-attachments/assets/40abae26-c65a-48fa-b714-fd4a0cf5023a)&#13;
&#13;
### æ’æŸ¥&#13;
1.æŸ¥çœ‹æ—¥å¿—ï¼Œå¯ä»¥çŸ¥é“æ²¡æœ‰æ‰¾åˆ°masterï¼Œæœ‰åªè¯»é”™è¯¯&#13;
![å¾®ä¿¡å›¾ç‰‡_20240730142747](https://github.com/user-attachments/assets/ae1d81e5-9f0b-44f9-8ab0-152ac1da6f72)&#13;
&#13;
2.æŸ¥çœ‹monitorï¼Œå‘ç°3ä¸ªèŠ‚ç‚¹éƒ½æ˜¯åªè¯»&#13;
```&#13;
maxctrl list monitors&#13;
maxctrl show monitor MariaDB-Monitor&#13;
```&#13;
![å¾®ä¿¡å›¾ç‰‡_20240730143048](https://github.com/user-attachments/assets/2fc22344-bd6a-4bda-922a-642614f8bcbc)&#13;
&#13;
### è§£å†³é—®é¢˜&#13;
* æ‰‹åŠ¨ä¿®æ”¹ä¸»èŠ‚ç‚¹ï¼Œå…³é—­åªè¯»&#13;
```&#13;
SET GLOBAL read_only = OFF;&#13;
```&#13;
æ­¤æ—¶åˆ é™¤maxcaleçš„podï¼Œé‡æ–°æ‹‰èµ·ä¹‹åï¼Œå‘ç°ä¾ç„¶æ²¡æœ‰æ‰¾åˆ°ä¸»èŠ‚ç‚¹ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/34.html</guid><pubDate>Tue, 30 Jul 2024 06:46:05 +0000</pubDate></item><item><title>ä½¿ç”¨hugoæ­å»ºé™æ€ç½‘é¡µ</title><link>https://longxiucai.github.io/post/33.html</link><description>Hugoå®˜æ–¹ä¸»é¡µï¼šhttps://gohugo.io/&#13;
HugoäºŒè¿›åˆ¶ä¸‹è½½åœ°å€ï¼šhttps://github.com/spf13/hugo/releases&#13;
&#13;
1ã€ä¸‹è½½ä¹‹åæ‰§è¡Œä¸‹é¢å‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•åˆ›å»ºtestæ–‡ä»¶å¤¹&#13;
```&#13;
hugo new site test&#13;
```&#13;
2ã€è¿›å…¥ç”Ÿæˆçš„æ–‡ä»¶å¤¹å†…ä¼šæœ‰å¦‚ä¸‹æ–‡ä»¶ä¸æ–‡ä»¶å¤¹&#13;
```&#13;
archetypes  assets  content  data  hugo.toml  i18n  layouts  public  static  themes&#13;
```&#13;
3ã€åˆ›å»ºæ–‡ç« ï¼Œå¦‚ä¸‹å‘½ä»¤ä¼šåœ¨contentç›®å½•åˆ›å»ºtest.mdæ–‡ä»¶å¹¶ä¸”åœ¨æ–‡ä»¶é¦–éƒ¨å¢åŠ ä¸€äº›ä¿¡æ¯&#13;
```&#13;
hugo new test.md&#13;
```&#13;
4ã€æŸ¥çœ‹test.mdï¼Œå¯ä»¥è‡ªå·±åœ¨é‡Œé¢è¡¥å……å†…å®¹&#13;
```&#13;
+++&#13;
title = 'Test'&#13;
date = 2024-07-26T14:37:18+08:00&#13;
draft = true&#13;
+++&#13;
```&#13;
5ã€è‡ªå·±æ‰‹åŠ¨ç¼–åˆ›å»ºæ–‡ç« ï¼Œç›´æ¥åœ¨contentç›®å½•ä¸­ç¼–å†™Markdownæ–‡ä»¶å¹¶ä¸”å¼€å¤´å¢åŠ ä¸‹é¢çš„å†…å®¹å³å¯&#13;
```&#13;
+++&#13;
title = 'XXXXXX'&#13;
date = 2024-07-26T14:37:18+08:00&#13;
draft = true&#13;
+++&#13;
```&#13;
6ã€éœ€è¦åœ¨themesç›®å½•ä¸­æ·»åŠ çš®è‚¤ï¼Œæ›´å¤šçš®è‚¤è§https://github.com/gohugoio/hugoThemes&#13;
```&#13;
cd themes&#13;
git clone https://github.com/spf13/hyde.git&#13;
```&#13;
7ã€è¿è¡Œç«™ç‚¹&#13;
```&#13;
hugo server --theme=hyde --buildDrafts --watch&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/33.html</guid><pubDate>Fri, 26 Jul 2024 06:44:03 +0000</pubDate></item><item><title>linuxä¿®æ”¹å¯†ç ä¸ç³»ç»Ÿæ•‘æ´</title><link>https://longxiucai.github.io/post/32.html</link><description>## éœ€è¦isoæ¥å½“æœ¬åœ°yumæºçš„éœ€æå‰æ·»åŠ cd-romå¹¶é€‰æ‹©å¥½å¯¹åº”çš„isoæ–‡ä»¶&#13;
![](https://github.com/user-attachments/assets/b6940c91-1798-4f32-aa79-2d2b59bf371d)&#13;
&#13;
## é‡å¯ä¹‹ååœ¨grubç•Œé¢æŒ‰`e`&#13;
![](https://github.com/user-attachments/assets/fe06fe3f-5a37-4176-ad5c-ae4e55a2d665)&#13;
&#13;
## æ‰¾åˆ°å¦‚ä¸‹è¡Œï¼Œå¹¶ä¸”åˆ é™¤åœˆå‡ºæ¥çš„éƒ¨åˆ†&#13;
æ‰¾åˆ°`linux`å¼€å¤´çš„è¡Œï¼Œåˆ é™¤`ro`ä¸`rhgb`ï¼Œrhgbä¸åˆ é™¤å¯èƒ½ä¼šæŠ¥é”™æ— æ³•è¿›å…¥æ•‘æ´æ¨¡å¼&#13;
![](https://github.com/user-attachments/assets/629f57e0-482e-4499-a04c-fef6f450c1be)&#13;
&#13;
## å¢åŠ åœˆå‡ºæ¥çš„éƒ¨åˆ†ï¼Œctrl+xè¿›å…¥æ•‘æ´æ¨¡å¼ï¼Œä¸éœ€è¦rootå¯†ç &#13;
å¢åŠ `rw init=/bin/bash console=tty0`&#13;
![](https://github.com/user-attachments/assets/58e7d784-0b96-4604-9483-26a5c6181faa)&#13;
&#13;
## æ•‘æ´æ¨¡å¼ä¸‹æŸ¥çœ‹cd-romä¸º/dev/sr0ï¼ŒæŒ‚è½½ä¹‹åå¯ä»¥å½“åšæœ¬åœ°yumæºï¼Œç”¨äºè¿˜åŸåŒ…çš„ç‰ˆæœ¬ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/32.html</guid><pubDate>Fri, 26 Jul 2024 03:26:33 +0000</pubDate></item><item><title>åœ¨çº¿å¯è§†åŒ–æ­£åˆ™è¡¨è¾¾å¼</title><link>https://longxiucai.github.io/post/30.html</link><description># åŸé¡¹ç›®&#13;
https://github.com/gskinner/regexr/&#13;
https://regexr.com/&#13;
&#13;
# ä¸­æ–‡ç¿»è¯‘é¡¹ç›®&#13;
http://github.com/skys215/regexr/&#13;
https://regexr-cn.com/ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/30.html</guid><pubDate>Tue, 23 Jul 2024 01:45:51 +0000</pubDate></item><item><title>è®°å½•ä¸€æ¬¡podç½‘ç»œé—®é¢˜ï¼Œdns minå‚æ•°å¯¹ç½‘ç»œå½±å“</title><link>https://longxiucai.github.io/post/29.html</link><description>## é—®é¢˜ç°è±¡&#13;
å®¹å™¨å†…æ‰§è¡Œç¨‹åºæŠ¥é”™ï¼Œç¨‹åºéœ€è¦è¿æ¥æŒ‡å®šçš„svc&#13;
![ç°è±¡](https://github.com/user-attachments/assets/6eaf7525-06c1-4b75-b0b3-e042572224e2)&#13;
&#13;
## ç½‘ç»œæ’æŸ¥&#13;
1ã€podå†…nslookupèƒ½å¤Ÿè§£æå‡ºæ­£ç¡®çš„ipåœ°å€ï¼Œcorednsæ²¡é—®é¢˜&#13;
![](https://github.com/user-attachments/assets/4d683d92-ee8e-4e56-954c-09b8e807cd74)&#13;
&#13;
2ã€podå†…pingæœ‰æŠ¥é”™&#13;
![å¾®ä¿¡å›¾ç‰‡_20240723091634](https://github.com/user-attachments/assets/e3e91ad8-ad37-41ec-b5bf-ef7b13e0a264)&#13;
&#13;
3ã€æ‰‹åŠ¨ä¿®æ”¹å®¹å™¨å†…/etc/hostsï¼Œç¨‹åºæ‰§è¡Œæ²¡é—®é¢˜&#13;
![](https://github.com/user-attachments/assets/439151cb-dcbd-4a75-8976-6ded8d055c3c)&#13;
&#13;
4ã€æŸ¥çœ‹å®¹å™¨å†…/etc/resolv.conf,å‘ç°æœ«å°¾æœ‰minå­—æ®µ&#13;
![](https://github.com/user-attachments/assets/3fd3e5bd-37fc-4ec4-86ec-0fec5b70bb4d)&#13;
&#13;
5ã€ä¿®æ”¹å»é™¤minå­—æ®µï¼Œåˆ é™¤/etc/hostsè§£æï¼Œç¨‹åºæ²¡é—®é¢˜&#13;
![](https://github.com/user-attachments/assets/13379954-03ee-4f54-aa60-0e19d26c24b2)&#13;
&#13;
## é…ç½®æ’æŸ¥&#13;
1ã€æŸ¥çœ‹podçš„dnsè§£æç­–ç•¥ï¼Œæ²¡é—®é¢˜&#13;
![](https://github.com/user-attachments/assets/d6b1ae96-715d-433f-a215-e5daad117c5a)&#13;
&#13;
2ã€æŸ¥çœ‹corednsé…ç½®ï¼Œæ²¡é—®é¢˜&#13;
![](https://github.com/user-attachments/assets/12d44482-6545-4974-b86d-3ac9eacefac9)&#13;
&#13;
3ã€æŸ¥çœ‹å®¿ä¸»æœº/etc/resolv.confï¼Œæœ‰minå­—æ®µ&#13;
![](https://github.com/user-attachments/assets/537a3892-5fcc-440d-9852-a815212bdfa4)&#13;
&#13;
## è§£å†³æ–¹æ³•&#13;
å®¿ä¸»æœº/etc/resolv.confåˆ é™¤minå­—æ®µä¹‹åï¼Œpodåˆ é™¤é‡æ–°æ‹‰èµ·ï¼Œå®¹å™¨æ¢å¤æ­£å¸¸ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/29.html</guid><pubDate>Tue, 23 Jul 2024 01:35:38 +0000</pubDate></item><item><title>MarkDownè¯­æ³•</title><link>https://longxiucai.github.io/post/28.html</link><description>README&#13;
===========================&#13;
&#13;
è¯¥æ–‡ä»¶ç”¨æ¥æµ‹è¯•å’Œå±•ç¤ºä¹¦å†™READMEçš„å„ç§markdownè¯­æ³•ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/28.html</guid><pubDate>Mon, 22 Jul 2024 03:03:31 +0000</pubDate></item><item><title>Markdown emoji</title><link>https://longxiucai.github.io/post/27.html</link><description>Emojiè¡¨æƒ…&#13;
=========&#13;
å°†å¯¹åº”emojiè¡¨æƒ…çš„ç¬¦å·ç å¤åˆ¶åè¾“å…¥ä½ çš„markdownæ–‡æœ¬å³å¯æ˜¾ç¤ºemojiè¡¨æƒ…ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/27.html</guid><pubDate>Mon, 22 Jul 2024 01:55:06 +0000</pubDate></item><item><title>æ’åºç®—æ³•è¯¦è§£</title><link>https://longxiucai.github.io/post/26.html</link><description># å¤æ‚åº¦&#13;
&#13;
| æ’åºæ–¹æ³•  | æ—¶é—´å¤æ‚åº¦ï¼ˆå¹³å‡ï¼‰ | æ—¶é—´å¤æ‚åº¦ï¼ˆæœ€åï¼‰ | æ—¶é—´å¤æ‚åº¦ï¼ˆæœ€å¥½ï¼‰ | ç©ºé—´å¤æ‚åº¦ | ç¨³å®šæ€§ |&#13;
| -------- | ------------------ | ------------------ | ------------------ | ---------- | ------ |&#13;
| æ’å…¥æ’åº | O(n^2)             | O(n^2)             | O(n)               | O(1)       | ç¨³å®š   |&#13;
| å¸Œå°”æ’åº | O(n^1.3)           | O(n^2)             | O(n)               | O(1)       | ä¸ç¨³å®š |&#13;
| é€‰æ‹©æ’åº | O(n^2)             | O(n^2)             | O(n^2)             | O(1)       | ä¸ç¨³å®š |&#13;
| å †æ’åº   | O(nlogâ‚‚n)          | O(nlogâ‚‚n)          | O(nlogâ‚‚n)          | O(1)       | ä¸ç¨³å®š |&#13;
| å†’æ³¡æ’åº | O(n^2)             | O(n^2)             | O(n)               | O(1)       | ç¨³å®š   |&#13;
| å¿«é€Ÿæ’åº | O(nlogâ‚‚n)          | O(n^2)             | O(nlogâ‚‚n)          | O(nlogâ‚‚n)  | ä¸ç¨³å®š |&#13;
| å½’å¹¶æ’åº | O(nlogâ‚‚n)          | O(nlogâ‚‚n)          | O(nlogâ‚‚n)          | O(n)       | ç¨³å®š   |&#13;
&#13;
# æ’åºç®—æ³•è¯¦è§£&#13;
## ä¸€ã€ç›´æ¥æ’å…¥ï¼ˆInsertion Sortï¼‰&#13;
æ’å…¥æ’åºï¼ˆInsertion-Sortï¼‰çš„ç®—æ³•æè¿°æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/26.html</guid><pubDate>Fri, 19 Jul 2024 08:24:08 +0000</pubDate></item><item><title>podçš„åˆ›å»ºæµç¨‹</title><link>https://longxiucai.github.io/post/25.html</link><description># è¯¦ç»†æ­¥éª¤&#13;
1. **ç”¨æˆ·æäº¤é«˜çº§èµ„æºå®šä¹‰**ï¼šé€šè¿‡ kubectl apply -f deployment.yaml æˆ– API è¯·æ±‚æ¥æäº¤ Deploymentã€ReplicaSet ç­‰é«˜çº§èµ„æºå®šä¹‰ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/25.html</guid><pubDate>Fri, 19 Jul 2024 07:30:59 +0000</pubDate></item><item><title>systemd-exporteræŒ‡æ ‡è¯´æ˜</title><link>https://longxiucai.github.io/post/24.html</link><description>æŒ‡æ ‡åç§°|æè¿°|	æ¥æº|	æ˜¯å¦éœ€è¦æ·»åŠ è¿è¡Œå‚æ•°&#13;
--------- | --------|--------|--------|&#13;
systemd_process_open_fds|	Number of open file descriptors	|/proc/&lt;pid&gt;/fd/*   æ•°é‡|	--systemd.collector.enable-file-descriptor-size&#13;
systemd_service_ip_egress_bytes|	Service unit egress IP accounting in bytes	|dbus Serviceç±»å‹ IPEgressByteså±æ€§	|--systemd.collector.enable-ip-accounting&#13;
systemd_service_ip_egress_packets_total|	Service unit egress IP accounting in packets|	dbus Serviceç±»å‹ IPEgressPacketså±æ€§|--systemd.collector.enable-ip-accounting&#13;
systemd_service_ip_ingress_bytes|	Service unit ingress IP accounting in bytes|	dbus Serviceç±»å‹ IPIngressByteså±æ€§|--systemd.collector.enable-ip-accounting&#13;
systemd_service_ip_ingress_packets_total|	Service unit ingress IP accounting in packets|	dbus Serviceç±»å‹ IPIngressPacketså±æ€§|--systemd.collector.enable-ip-accounting&#13;
systemd_service_restart_total|	Service unit count of Restart triggers|	dbus Serviceç±»å‹ NRestartså±æ€§|	--systemd.collector.enable-restart-count&#13;
systemd_exporter_build_info|	A metric with a constant '1' value labeled by version, revision, branch, and goversion from which systemd_exporter was built.	|| å¦&#13;
systemd_process_cpu_seconds_total|	Total user and system CPU time spent in seconds|	/proc/&lt;pid&gt;/statä¸­ç¬¬14ä¸15ä¸ªå€¼çš„å’Œå†é™¤ä»¥100	|å¦&#13;
systemd_process_max_fds|	Maximum number of open file descriptors	| /proc/&lt;pid&gt;/limitsä¸­â€˜Max open filesâ€™çš„â€˜Soft Limitâ€™å€¼	|å¦&#13;
systemd_process_resident_memory_bytes|	Resident memory size in bytes|	/proc/&lt;pid&gt;/statä¸­ç¬¬24ä¸ªå€¼ä¹˜pagesize	|å¦&#13;
systemd_process_virtual_memory_bytes|	Virtual memory size in bytes|	/proc/&lt;pid&gt;/statä¸­ç¬¬23ä¸ªå€¼	|å¦&#13;
systemd_process_virtual_memory_max_bytes|	Maximum amount of virtual memory available in bytes|	/proc/&lt;pid&gt;/limitsä¸­â€˜Max address spaceâ€™çš„â€˜Soft Limitâ€™å€¼	|å¦&#13;
systemd_socket_accepted_connections_total|	Total number of accepted socket connections|	dbus Serviceç±»å‹ NAcceptedå±æ€§	|å¦&#13;
systemd_socket_current_connections|	Current number of socket connections|	dbus Serviceç±»å‹ NConnectionså±æ€§	|å¦&#13;
systemd_socket_refused_connections_total|	Total number of refused socket connections|	dbus Serviceç±»å‹ NRefusedå±æ€§	|å¦&#13;
systemd_timer_last_trigger_seconds|	Seconds since epoch of last trigger.|	dbus Timerç±»å‹ LastTriggerUSecå±æ€§å†é™¤ä»¥1e6	|å¦&#13;
systemd_unit_cpu_seconds_total|	Unit CPU time in seconds|	cgroupä¸­çš„cpuacct.usage_all	|å¦&#13;
systemd_unit_info|	Mostly-static metadata for all unit types|	dbus Serviceç±»å‹ Typeå±æ€§ã€servicename	|å¦&#13;
systemd_unit_start_time_seconds|	Start time of the unit since unix epoch in seconds|	dbus Serviceç±»å‹ ActiveEnterTimestampå±æ€§å†é™¤ä»¥1e6	|å¦&#13;
systemd_unit_state|	Systemd unit|	dbusè¿æ¥è·å–æœåŠ¡åˆ—è¡¨æ—¶çš„å€¼	|å¦&#13;
systemd_unit_tasks_current|	Current number of tasks per Systemd unit|	dbus Serviceç±»å‹ TasksCurrentå±æ€§	|å¦&#13;
systemd_unit_tasks_max|	Maximum number of tasks per Systemd unit|	dbus Serviceç±»å‹ TasksMaxå±æ€§	|å¦ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/24.html</guid><pubDate>Tue, 16 Jul 2024 07:56:23 +0000</pubDate></item><item><title>æ—¥å¿—å·¥å…·vectorè‡ªå®šä¹‰æ—¥å¿—è§£æä¸è¿‡æ»¤ï¼ŒåŒ…å«vrlè¯­æ³•è§£é‡Šä¸httpåç«¯demoï¼ˆgoç¼–å†™ï¼‰</title><link>https://longxiucai.github.io/post/23.html</link><description>æºç ï¼šhttps://github.com/vectordotdev/vector&#13;
&#13;
helm repo:   https://helm.vector.dev/&#13;
&#13;
repo chart: https://github.com/vectordotdev/helm-charts/tree/develop&#13;
&#13;
æ–‡æ¡£ï¼š https://vector.dev/docs/&#13;
&#13;
# éªŒè¯ä¸æµ‹è¯•æ–¹æ³•&#13;
1ã€å½“å‰ç›®å½•ä¸­åˆ›å»ºvector.yamlæ–‡ä»¶ï¼Œæ–‡ä»¶åå¿…é¡»ä¸ºvector.yaml&#13;
2ã€æ‰§è¡Œå‘½ä»¤éªŒè¯&#13;
```&#13;
alias vector='nerdctl run -it -v $(pwd)/:/etc/vector/ -v /var/log/:/var/log/ --rm harbor.kylincloudnative.com/docker.io/timberio/vector:0.39.0-alpine'&#13;
nerdctl pull harbor.kylincloudnative.com/docker.io/timberio/vector:0.39.0-alpine&#13;
vector&#13;
```&#13;
# ingress-controlleræ—¥å¿—ç¤ºä¾‹(/var/log/test-pod-log-ingress)&#13;
```&#13;
2024-07-15T14:28:37+08:00       error   ingress/controller.go:653       upstream is not referenced      {'cluster': 'name=default; base_url=http://apisix-admin.apisix-system:9180/apisix/admin', 'upstream': 'default_kubelet_10250'}&#13;
2024-07-15T14:28:37+08:00       error   ingress/controller.go:653       upstream is not referenced      {'cluster': 'name=default; base_url=http://apisix-admin.apisix-system:9180/apisix/admin', 'upstream': 'default_kubelet_10250'}&#13;
2024-07-15T14:28:37+08:00       warn    ingress/controller.go:653       upstream is not referenced      {'cluster': 'name=default; base_url=http://apisix-admin.apisix-system:9180/apisix/admin', 'upstream': 'default_kubelet_10255'}&#13;
2024-07-15T14:28:37+08:00       warn    ingress/controller.go:653       upstream is not referenced      {'cluster': 'name=default; base_url=http://apisix-admin.apisix-system:9180/apisix/admin', 'upstream': 'default_kubelet_4194'}&#13;
2024-07-15T14:28:38+08:00       error   ingress/controller.go:653       upstream is not referenced      {'cluster': 'name=default; base_url=http://apisix-admin.apisix-system:9180/apisix/admin', 'upstream': 'default_kubelet_10250'}&#13;
2024-07-15T14:28:38+08:00       warn    ingress/controller.go:653       upstream is not referenced      {'cluster': 'name=default; base_url=http://apisix-admin.apisix-system:9180/apisix/admin', 'upstream': 'default_kubelet_10255'}&#13;
2024-07-15T14:28:38+08:00       warn    ingress/controller.go:653       upstream is not referenced      {'cluster': 'name=default; base_url=http://apisix-admin.apisix-system:9180/apisix/admin', 'upstream': 'default_kubelet_4194'}&#13;
```&#13;
# vector.yamlé…ç½®&#13;
```&#13;
api:&#13;
  enabled: true&#13;
  address: 127.0.0.1:58686&#13;
  playground: false&#13;
sources:&#13;
  ingress:&#13;
    type: file&#13;
    include: &#13;
      - /var/log/test-pod-log-ingress&#13;
    data_dir: /etc/vector/workdir&#13;
transforms:&#13;
  parse_ingress:&#13;
    inputs:&#13;
      - ingress&#13;
    type: remap&#13;
    source: |&#13;
      . |= parse_regex!(.message, r'^(?P&lt;timestamp&gt;\d+-\d+-\d+T\d+:\d+:\d+\+\d+:\d+)\s+(?P&lt;log_level&gt;\w+)\s+(?P&lt;file_path&gt;[\w./:-]+)\s+(?P&lt;message&gt;[^\{]+)\s+(?P&lt;structured_data&gt;\{.*\})$')&#13;
      .structured_data = parse_json!(.structured_data)&#13;
      .structured_data = parse_key_value!(.structured_data.cluster, key_value_delimiter: '=' )&#13;
      . = merge(., .structured_data)&#13;
      del(.structured_data)&#13;
  ingress_filter:&#13;
    type: filter&#13;
    inputs:&#13;
      - parse_ingress&#13;
    condition:&#13;
      type: vrl&#13;
      source: .log_level == 'error'&#13;
sinks:&#13;
  http_log:&#13;
    inputs:&#13;
      - ingress_filter&#13;
    uri: http://10.42.16.241:8080/push&#13;
    type: http&#13;
    encoding:&#13;
      codec: json&#13;
  console_log:&#13;
    inputs:&#13;
      - parse_ingress&#13;
    type: console&#13;
    encoding:&#13;
      codec: json&#13;
```&#13;
## sourcesé…ç½®è¯´æ˜&#13;
ç›´æ¥ä»æ–‡ä»¶è¯»å–æ—¥å¿—&#13;
## transformsé…ç½®è¯´æ˜&#13;
1ã€**parse_ingress**ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è§£ææ—¥å¿—çš„timestampã€log_levelã€file_pathã€messageã€structured_dataï¼Œç„¶åå°†structured_dataå†æ¬¡é€šè¿‡key-valueçš„æ–¹å¼è§£æã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/23.html</guid><pubDate>Mon, 15 Jul 2024 08:13:10 +0000</pubDate></item><item><title>docker desktopç™»å½•æŠ¥é”™Error saving credentials</title><link>https://longxiucai.github.io/post/22.html</link><description>æŠ¥é”™å†…å®¹å…·ä½“ä¸ºï¼š&#13;
```&#13;
$ docker login harbor.xxx.com/docker.io/timberio/vector:0.39.0-alpine-arm64&#13;
Username: admin&#13;
Password: &#13;
Error saving credentials: error storing credentials - err: exit status 1, out: `error getting credentials - err: exit status 1, out: `no usernames for harbor.xxx.com``&#13;
```&#13;
è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹~/.docker/config.jsonåˆ é™¤`'credsStore': 'desktop',`ï¼Œç„¶åé‡æ–°å¯åŠ¨ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/22.html</guid><pubDate>Thu, 11 Jul 2024 09:12:09 +0000</pubDate></item><item><title>dockeré…ç½®ä»£ç†</title><link>https://longxiucai.github.io/post/21.html</link><description># rpmè£…çš„dockerï¼Œä¸”æœåŠ¡å™¨æ²¡æœ‰å¤–ç½‘&#13;
1. ä¿®æ”¹/usr/lib/systemd/system/docker.serviceæ–‡ä»¶(æœ‰çš„å¯èƒ½ä¸æ˜¯è¿™ä¸ªæ–‡ä»¶ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/21.html</guid><pubDate>Thu, 11 Jul 2024 09:08:39 +0000</pubDate></item><item><title>docker multi image</title><link>https://longxiucai.github.io/post/20.html</link><description># é€šè¿‡manifest&#13;
1ã€é•œåƒä»“åº“ä¸­æœ‰2ä¸ªæ¶æ„çš„é•œåƒä¸”tagä¸ä¸€è‡´ï¼Œæ²¡æœ‰åˆ™pushä¸Šå»&#13;
```&#13;
docker push  harbor.yourharbor.com/docker.io/timberio/vector:0.39.0-alpine-arm64&#13;
docker push  harbor.yourharbor.com/docker.io/timberio/vector:0.39.0-alpine-amd64&#13;
```&#13;
2ã€åˆ›å»ºmanifest&#13;
```&#13;
docker manifest create harbor.yourharbor.com/docker.io/timberio/vector:0.39.0-alpine \&#13;
--amend harbor.yourharbor.com/docker.io/timberio/vector:0.39.0-alpine-amd64 \&#13;
--amend harbor.yourharbor.com/docker.io/timberio/vector:0.39.0-alpine-arm64&#13;
```&#13;
3ã€push manifest&#13;
```&#13;
 docker manifest push harbor.yourharbor.com/docker.io/timberio/vector:0.39.0-alpine   &#13;
```&#13;
&#13;
# é€šè¿‡buildx&#13;
ç¡®ä¿ docker buildx å·²ç»é…ç½®å¥½ï¼š&#13;
```&#13;
docker buildx create --use&#13;
docker buildx inspect --bootstrap&#13;
```&#13;
é¦–å…ˆï¼Œä½¿ç”¨`docker buildx imagetools inspect`æŸ¥çœ‹ velero/velero:v1.14.0 æ˜¯å¦æ”¯æŒå¤šæ¶æ„ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/20.html</guid><pubDate>Thu, 11 Jul 2024 09:00:21 +0000</pubDate></item><item><title>redisä¸€ä¸»ä¸€ä»é›†ç¾¤è„‘è£‚ç°è±¡æ¨¡æ‹Ÿ</title><link>https://longxiucai.github.io/post/19.html</link><description># ä¸€ä¸»ä¸€ä»redisè„‘è£‚ç°è±¡æ¨¡æ‹Ÿ&#13;
ä¸»èŠ‚ç‚¹A:10.42.186.32  ä»èŠ‚ç‚¹B:10.42.186.33&#13;
&#13;
1. ç½‘ç»œéš”ç¦»&#13;
```bash&#13;
# 10.42.186.32 æ‰§è¡Œä¸‹é¢å‘½ä»¤&#13;
iptables -A INPUT -s 10.42.186.33 -j DROP&#13;
iptables -A OUTPUT -d 10.42.186.33 -j DROP&#13;
&#13;
# 10.42.186.33 æ‰§è¡Œä¸‹é¢å‘½ä»¤&#13;
iptables -A INPUT -s 10.42.186.32 -j DROP&#13;
iptables -A OUTPUT -d 10.42.186.32 -j DROP&#13;
```&#13;
&#13;
2. ä»èŠ‚ç‚¹å‡çº§ä¸ºä¸»èŠ‚ç‚¹&#13;
```bash&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! cluster failover takeover&#13;
```&#13;
3. æŸ¥çœ‹é›†ç¾¤çŠ¶æ€(æ­¤æ—¶2ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸»èŠ‚ç‚¹)&#13;
```bash&#13;
# redis-cli -h 10.42.186.32 -p 6379 -a Kylin.2023! cluster nodes&#13;
4226cce5d7735c488a74e3aff86ad641d5c5e54b 10.42.186.33:6379@16379 master,fail? - 1719909668692 1719909667688 1 connected&#13;
b4519db09c96d8ad12efae818210e6521525e2bf 10.42.186.32:6379@16379 myself,master - 0 0 2 connected 0-16383&#13;
&#13;
# redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! cluster nodes&#13;
b4519db09c96d8ad12efae818210e6521525e2bf 10.42.186.32:6379@16379 slave,fail? 4226cce5d7735c488a74e3aff86ad641d5c5e54b 1719909668604 1719909667601 1 connected&#13;
4226cce5d7735c488a74e3aff86ad641d5c5e54b 10.42.186.33:6379@16379 myself,master - 0 0 1 connected 0-16383&#13;
&#13;
```&#13;
4. èŠ‚ç‚¹A(æ—§ä¸»èŠ‚ç‚¹)å†™å…¥æ•°æ®&#13;
```bash&#13;
redis-cli -h 10.42.186.32 -p 6379 -a Kylin.2023! set key32 data32&#13;
redis-cli -h 10.42.186.32 -p 6379 -a Kylin.2023! set AAA from32&#13;
redis-cli -h 10.42.186.32 -p 6379 -a Kylin.2023! set BBB from32&#13;
```&#13;
5. èŠ‚ç‚¹B(æ–°ä¸»èŠ‚ç‚¹)å†™å…¥æ•°æ®&#13;
```bash&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! set key33 data33&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! set AAA from33&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! set BBB from33&#13;
```&#13;
6. æ¢å¤ç½‘ç»œ&#13;
```bash&#13;
# 10.42.186.32 æ‰§è¡Œä¸‹é¢å‘½ä»¤&#13;
iptables -D INPUT -s 10.42.186.33 -j DROP&#13;
iptables -D OUTPUT -d 10.42.186.33 -j DROP&#13;
&#13;
# 10.42.186.33 æ‰§è¡Œä¸‹é¢å‘½ä»¤&#13;
iptables -D INPUT -s 10.42.186.32 -j DROP&#13;
iptables -D OUTPUT -d 10.42.186.32 -j DROP&#13;
```&#13;
7. æŸ¥çœ‹æ•°æ®ï¼Œæ­¤æ—¶èŠ‚ç‚¹A(æ—§ä¸»èŠ‚ç‚¹)å˜æˆä»èŠ‚ç‚¹ï¼Œå¹¶ä¸”åœ¨ç½‘ç»œéš”ç¦»ä¹‹åå†™çš„æ•°æ®å·²ç»ä¸¢å¤±ï¼ŒèŠ‚ç‚¹B(æ–°ä¸»èŠ‚ç‚¹)å˜æˆä¸»èŠ‚ç‚¹ï¼Œredisé›†ç¾¤çš„æ•°æ®ä»¥æ–°ä¸»èŠ‚ç‚¹ä¸­çš„æ•°æ®ä¸ºå‡†&#13;
```bash&#13;
# 10.42.186.33 æ‰§è¡Œä¸‹é¢å‘½ä»¤&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! get key32&#13;
è¿”å›å€¼ä¸º (nil)&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! get key33&#13;
è¿”å›å€¼ä¸º data33&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! get AAA&#13;
è¿”å›å€¼ä¸º from33&#13;
redis-cli -h 10.42.186.33 -p 6379 -a Kylin.2023! get BBB&#13;
è¿”å›å€¼ä¸º from33&#13;
# 10.42.186.32å˜æˆä»èŠ‚ç‚¹ï¼Œå·²ç»æ— æ³•get keyã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/19.html</guid><pubDate>Tue, 02 Jul 2024 09:17:50 +0000</pubDate></item><item><title>shellä¸­çš„ç‰¹æ®Šå˜é‡ä¸æ•°ç»„</title><link>https://longxiucai.github.io/post/18.html</link><description>`$0`	å½“å‰è„šæœ¬çš„æ–‡ä»¶åã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/18.html</guid><pubDate>Tue, 02 Jul 2024 06:43:32 +0000</pubDate></item><item><title>rpmdbæŠ¥é”™</title><link>https://longxiucai.github.io/post/17.html</link><description>æ‰§è¡Œyumã€rpmå‘½ä»¤å¤±è´¥:error: rpmdb: BDB0113 Thread/process 16978/139878363277376 failed: BDB1507 Thread died in Berkeley DB library&#13;
&#13;
å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è§£å†³&#13;
```&#13;
cd /var/lib/rpm&#13;
rm -rf __db*&#13;
rpm --rebuilddb&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/17.html</guid><pubDate>Tue, 02 Jul 2024 06:29:10 +0000</pubDate></item><item><title>ä¿®æ”¹master3èŠ‚ç‚¹ä¸»æœºå</title><link>https://longxiucai.github.io/post/16.html</link><description>1. master1èŠ‚ç‚¹æ“ä½œåˆ é™¤master3èŠ‚ç‚¹&#13;
```&#13;
kubectl delete node master3&#13;
```&#13;
2. master3èŠ‚ç‚¹æ“ä½œ&#13;
``` &#13;
kubeadm reset&#13;
rm -rf  /var/lib/etcd/&#13;
rm -rf /etc/kubernetes/manifests/*&#13;
hostnamectl set-hostname xxxxx&#13;
``` &#13;
&#13;
3. master1èŠ‚ç‚¹&#13;
```&#13;
kubectl exec -n kube-system -it etcd-master1 -- sh&#13;
alias etcdctl='etcdctl --endpoints=https://127.0.0.1:2379 --cacert=/etc/kubernetes/pki/etcd/ca.crt --cert=/etc/kubernetes/pki/etcd/server.crt --key=/etc/kubernetes/pki/etcd/server.key'&#13;
etcdctl member list&#13;
etcdctl member remove &lt;master3çš„idï¼Œä¸Šä¸€æ­¥è¾“å‡ºçš„ç¬¬ä¸€åˆ—&gt;&#13;
exit&#13;
```&#13;
4. master1èŠ‚ç‚¹æ“ä½œ&#13;
```&#13;
kubeadm token create --print-join-command&#13;
kubeadm init phase upload-certs --upload-certsè¾“å‡ºçš„æœ€åä¸€è¡Œå­—ç¬¦ä¸²ä¸ä¸Šä¸€æ­¥ç»„åˆï¼ˆ--control-plane --certificate-key xxxxxï¼‰&#13;
```&#13;
ç»„åˆå®Œæˆåç¤ºä¾‹ï¼š&#13;
```&#13;
kubeadm join apiserver.cluster.local:6443 --token a6e1fm.b5lnpm64r7t707lw --discovery-token-ca-cert-hash sha256:06bc401679c6964d712790e0464d701030b27919c84807a30acb9c772e1a884f --control-plane --certificate-key b8e05ef60b5cecc78318cfe8148520ae2d46d0ac7871932cfeec7b36a0bd698e&#13;
```&#13;
5. master3æ‰§è¡Œä¸Šé¢ç»„åˆä¹‹åçš„å‘½ä»¤&#13;
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/16.html</guid><pubDate>Tue, 02 Jul 2024 06:21:39 +0000</pubDate></item><item><title>linuxå®‰è£…å¯åŠ¨è¿‡ç¨‹</title><link>https://longxiucai.github.io/post/15.html</link><description>1. isolinux.bin &amp; isolinux.cfg&#13;
&#13;
isolinux.binæ˜¯å…‰ç›˜å¼•å¯¼ç¨‹åºï¼Œåœ¨mkisofsçš„é€‰é¡¹ä¸­éœ€è¦æ˜ç¡®ç»™å‡ºæ–‡ä»¶è·¯å¾„ï¼Œè¿™ä¸ªæ–‡ä»¶å±äºSYSLINUXé¡¹ç›®ï¼Œå¯¹åº”fedora13ä¸­çš„syslinuxåŒ…ï¼Œæ–‡æ¡£å¯å‚è€ƒï¼š/usr/share/doc/syslinux-4.02/isolinux.txtæˆ–è€…é¡¹ç›®Wikiï¼›å¯å¼•å¯¼å…‰ç›˜ç›¸å…³ä¿¡æ¯è¯·å‚è€ƒEl Toritoè§„èŒƒï¼›&#13;
isolinux.cfgæ˜¯isolinux.binçš„é…ç½®æ–‡ä»¶ï¼Œå½“å…‰ç›˜å¯åŠ¨åï¼ˆå³è¿è¡Œisolinux.binï¼‰ï¼Œä¼šè‡ªåŠ¨å»æ‰¾isolinux.cfgæ–‡ä»¶ï¼Œç„¶åæ ¹æ®é…ç½®ä¿¡æ¯è¿›è¡Œåç»­å·¥ä½œï¼›æŸ¥æ‰¾isolinux.cfgçš„é¡ºåºä¸º:&#13;
boot/syslinux/isolinux.cfg&#13;
syslinux/isolinux.cfg&#13;
isolinux.cfg&#13;
&#13;
2. vesamenu.c32&#13;
&#13;
vesamenu.c32å°±æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„å…‰ç›˜å¯åŠ¨åçš„å®‰è£…å›¾å½¢ç•Œé¢ï¼Œä¹Ÿå±äºSYSLINUXé¡¹ç›®ï¼Œè¿˜æœ‰ä¸€ä¸ªmenu.c32ç‰ˆæœ¬ï¼Œæ˜¯çº¯æ–‡æœ¬çš„èœå•ï¼›&#13;
&#13;
3. memtest&#13;
&#13;
å¦‚æœé€šè¿‡å…‰ç›˜å¯åŠ¨èœå•é€‰æ‹©äº†memtesté€‰é¡¹ï¼Œåˆ™å¼€å§‹è¿›è¡Œå†…å­˜æ£€æµ‹ï¼›è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºï¼Œå±äºmemtest86+é¡¹ç›®ï¼Œå¯¹åº”çš„fedora13çš„åŒ…æ˜¯memtest86+-4.00-3.fc13.i686.rpmï¼›é€šè¿‡æ•ˆéªŒmd5å€¼å¯ä»¥å‘ç°è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ä»åŒ…ä¸­æå–å‡ºæ¥çš„ï¼Œå‘è¡Œç‰ˆå®šåˆ¶å·¥å…·ä¼šä»yumæºå°†è¿™ä¸ªåŒ…å®‰è£…åˆ°chrootä¸­ï¼Œç„¶åå°† /boot/memtest86+* å¤åˆ¶åˆ°ISOæ ¹ç›®å½•ï¼›&#13;
&#13;
4. splash.jgp&#13;
&#13;
æ˜¯å…‰ç›˜å¯åŠ¨ç•Œé¢çš„èƒŒæ™¯å›¾ï¼Œåº”è¯¥æ¥è‡ªæ–‡ä»¶ /usr/lib/anaconda-runtime/syslinux-vesa-splash.jpgï¼Œå±äºfedora-logosåŒ…ï¼›åˆ¶ä½œæ–¹æ³•è§Fedoraå®˜æ–¹Wikiï¼š[How_to_create_a_custom_syslinux_splash](https://fedoraproject.org/wiki/How_to_create_a_custom_syslinux_splash)&#13;
&#13;
5. vmlinuz &amp; initrd.img&#13;
&#13;
vmlinuzæ˜¯å†…æ ¸æ˜ åƒï¼Œinitrd.imgæ˜¯ramfs (å…ˆcpioï¼Œå†gzipå‹ç¼©)ï¼Œéƒ½æ˜¯ç¼–è¯‘å†…æ ¸ç”Ÿæˆçš„ï¼›isolinux.binæ ¹æ®å®‰è£…é€‰é¡¹æ‰¾åˆ°å¯¹åº”çš„é…ç½®ï¼Œè£…è½½å†…æ ¸å’Œramfsï¼›&#13;
&#13;
6. install.img&#13;
&#13;
install.imgæ˜¯ä¸€ä¸ªsquashfsæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œå½“å†…æ ¸å¯åŠ¨åå°±è£…è½½install.imgå¹¶åˆ‡æ¢æ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰§è¡Œé‡Œé¢çš„anacondaç¨‹åºï¼Œanacondaæ˜¯fedoraçš„å®‰è£…ç¨‹åºï¼›&#13;
```&#13;
    $ sudo mount install.img /mnt -oloop   # mount&#13;
    $ sudo mksquashfs /dir                 # build&#13;
```&#13;
7. discinfo&#13;
&#13;
å®‰è£…è¿‡ç¨‹ä¸­ï¼Œanacondaä¼šå»è¯»å–.discinfoæ–‡ä»¶ï¼Œè·å–å…‰ç›˜ä¿¡æ¯ï¼ˆä»¥å‰CDå®‰è£…ç³»ç»Ÿéœ€è¦å¤šå¼ å…‰ç›˜ï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&#13;
1273712438.740122     # timestamp ï¼ˆ python time.time() ï¼‰&#13;
Fedora 13             # releasestr&#13;
i386                  # arch&#13;
ALL                   # discNum ï¼ˆALLè¡¨ç¤ºåªæœ‰ä¸€å¼ å®‰è£…ç›˜ï¼‰&#13;
æ³¨ï¼šå‚è€ƒæ–‡ä»¶/usr/lib/anaconda-runtime/makestamp.py &#13;
&#13;
8.Packages &amp; repodata&#13;
&#13;
packageså°±æ˜¯å­˜æ”¾åŒ…çš„ç›®å½•ï¼Œå¯¹è¿™ä¸ªç›®å½•æ‰§è¡Œcreaterepoå‘½ä»¤å°±ä¼šç”Ÿæˆä¸€ä¸ªrepodataçš„ç›®å½•ï¼Œè¿™ä¸ªrepodataå°±æ˜¯yumæºï¼Œé‡Œé¢çš„æ–‡ä»¶åŸºæœ¬éƒ½æ˜¯xmlæ ¼å¼ï¼Œè®°å½•äº†Packagesä¸­æ‰€æœ‰åŒ…çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚åŒ…åã€åŒ…ä¿¡æ¯ã€åŒ…ç‰ˆæœ¬ã€åŒ…ä¸­çš„æ–‡ä»¶æ¸…å•ç­‰ç­‰ï¼›&#13;
&#13;
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/15.html</guid><pubDate>Tue, 02 Jul 2024 06:18:07 +0000</pubDate></item><item><title>curl k8s api</title><link>https://longxiucai.github.io/post/14.html</link><description>1. applyä¸‹é¢çš„èµ„æºæ–‡ä»¶
```
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: test
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: test
    namespace: kube-system
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: test
  namespace: kube-system
---
# sa-token-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: test-sa-token
  namespace: kube-system
  annotations:
    kubernetes.io/service-account.name: test
type: kubernetes.io/service-account-token
```
2. æ‰§è¡Œä¸‹é¢å‘½ä»¤(æ›¿æ¢`KUBE_API`ä¸ºå®é™…)
```
JWT_TOKEN_KUBESYSTEM_DEFAULT=`kubectl get secret test-sa-token -n kube-system -o jsonpath='{.data.token}' | base64 -d`
KUBE_API=https://172.20.187.11:6443
```
3. è¯·æ±‚
```
curl  $KUBE_API/apis/apps/v1/deployments  --header 'Authorization: Bearer $JWT_TOKEN_KUBESYSTEM_DEFAULT' -k
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/14.html</guid><pubDate>Tue, 02 Jul 2024 06:13:16 +0000</pubDate></item><item><title>linuxå®¶ç›®å½•ä¸‹çš„ä¸­æ–‡ç›®å½•ä¿®æ”¹ä¸ºè‹±æ–‡</title><link>https://longxiucai.github.io/post/13.html</link><description>1. å°†è¿™äº›ç›®å½•ä¿®æ”¹ä¸ºè‹±æ–‡åï¼Œå¦‚ï¼š  mv æ¡Œé¢ Desktop &#13;
&#13;
2. ä¿®æ”¹é…ç½®æ–‡ä»¶`~/.config/user-dirs.dirs`ï¼Œå°†å¯¹åº”çš„è·¯å¾„æ”¹ä¸ºè‹±æ–‡åï¼ˆè¦å’Œ1ä¸­ä¿®æ”¹çš„è‹±æ–‡åå¯¹åº”ï¼‰&#13;
&#13;
é…ç½®æ–‡ä»¶ä¿®æ”¹åçš„å†…å®¹å¦‚ä¸‹ï¼š&#13;
```&#13;
XDG_DESKTOP_DIR='$HOME/Desktop'&#13;
XDG_DOWNLOAD_DIR='$HOME/Download'&#13;
XDG_TEMPLATES_DIR='$HOME/Template'&#13;
XDG_PUBLICSHARE_DIR='$HOME/Public'&#13;
XDG_DOCUMENTS_DIR='$HOME/Document'&#13;
XDG_MUSIC_DIR='$HOME/Music'&#13;
XDG_PICTURES_DIR='$HOME/Picture'&#13;
XDG_VIDEOS_DIR='$HOME/Video'&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/13.html</guid><pubDate>Tue, 02 Jul 2024 06:09:53 +0000</pubDate></item><item><title>k8s dashbordçš„tokenåˆ›å»ºï¼Œç”¨äºç™»å½•</title><link>https://longxiucai.github.io/post/12.html</link><description>```&#13;
kubectl create serviceaccount cluster-admin-dashboard-sa&#13;
kubectl create clusterrolebinding cluster-admin-dashboard-sa --clusterrole=cluster-admin --serviceaccount=default:cluster-admin-dashboard-sa&#13;
kubectl describe secrets $(kubectl get secret | grep cluster-admin-dashboard-sa |cut -d ' ' -f1)|grep 'token:'&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/12.html</guid><pubDate>Tue, 02 Jul 2024 06:06:03 +0000</pubDate></item><item><title>å½©è‰²echo</title><link>https://longxiucai.github.io/post/11.html</link><description>```&#13;
################# color code ####################&#13;
RED='31;1m'      # Error message&#13;
GREEN='32;1m'    # Success message&#13;
YELLOW='33;1m'   # Warning message&#13;
BLUE='36;1m'     # Info message&#13;
LIGHT_BLUE='36m' # Debug message&#13;
################# color echo ####################&#13;
colorEcho() { echo -e '\033[${1}${@:2}\033[0m'; }&#13;
error() { colorEcho $RED $1; }&#13;
success() { colorEcho $GREEN $1; }&#13;
warn() { colorEcho $YELLOW $1; }&#13;
info() { colorEcho $BLUE $1; }&#13;
################ end of color echo ##############&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/11.html</guid><pubDate>Tue, 02 Jul 2024 06:04:42 +0000</pubDate></item><item><title>cç¨‹åºå ç”¨æ–‡ä»¶æè¿°ç¬¦</title><link>https://longxiucai.github.io/post/10.html</link><description>## cç¨‹åºæ‰“å¼€å¤šä¸ªæ–‡ä»¶&#13;
```&#13;
#include &lt;stdio.h&gt;&#13;
#include &lt;stdlib.h&gt;&#13;
#include &lt;fcntl.h&gt;&#13;
#include &lt;unistd.h&gt;&#13;
#include &lt;signal.h&gt;&#13;
&#13;
int *fds = NULL;&#13;
int number_of_files = 0;&#13;
int last_files = 0;&#13;
void cleanup() {&#13;
    if (fds != NULL) {&#13;
        for (int i = 0; i &lt; last_files + 1; i++) {&#13;
            if (fds[i] != -1) {&#13;
                close(fds[i]);&#13;
                printf('Closed file descriptor %d\n', fds[i]);&#13;
            }&#13;
&#13;
            char filename[256];&#13;
            snprintf(filename, sizeof(filename), '/tmp/testfile_%d.txt', i);&#13;
            if (unlink(filename) == 0) {&#13;
                printf('Deleted file %s\n', filename);&#13;
            } else {&#13;
                perror('unlink');&#13;
            }&#13;
        }&#13;
        free(fds);&#13;
        fds = NULL;&#13;
        printf('Freed allocated memory\n');&#13;
    }&#13;
}&#13;
&#13;
void signal_handler(int signal) {&#13;
    if (signal == SIGINT) {&#13;
        printf('\nCaught SIGINT signal, performing cleanup...\n');&#13;
        cleanup();&#13;
        exit(EXIT_FAILURE);&#13;
    }&#13;
}&#13;
&#13;
void open_many_files(int num_files) {&#13;
    number_of_files = num_files;&#13;
    fds = malloc(number_of_files * sizeof(int));&#13;
    if (fds == NULL) {&#13;
        perror('malloc');&#13;
        exit(EXIT_FAILURE);&#13;
    }&#13;
&#13;
    for (int i = 0; i &lt; number_of_files; i++) {&#13;
        char filename[256];&#13;
        snprintf(filename, sizeof(filename), '/tmp/testfile_%d.txt', i);&#13;
        fds[i] = open(filename, O_RDWR | O_CREAT, 0644);&#13;
        if (fds[i] == -1) {&#13;
            perror('open');&#13;
            break;&#13;
        }&#13;
        printf('Opened file descriptor %d for %s\n', fds[i], filename);&#13;
        last_files = i;&#13;
    }&#13;
}&#13;
&#13;
int main(int argc, char *argv[]) {&#13;
    if (argc != 3) {&#13;
        fprintf(stderr, 'Usage: %s &lt;number_of_files_to_open&gt; &lt;wait_time_in_seconds&gt;\n', argv[0]);&#13;
        exit(EXIT_FAILURE);&#13;
    }&#13;
&#13;
    // Register the signal handler for SIGINT&#13;
    signal(SIGINT, signal_handler);&#13;
&#13;
    int num_files_to_open = atoi(argv[1]);&#13;
    int wait_time = atoi(argv[2]);&#13;
&#13;
    open_many_files(num_files_to_open);&#13;
&#13;
    // Wait for the specified time before closing file descriptors&#13;
    printf('Waiting for %d seconds before closing file descriptors...\n', wait_time);&#13;
    sleep(wait_time);&#13;
&#13;
    cleanup();&#13;
&#13;
    return 0;&#13;
}&#13;
```&#13;
## åœ¨podä¸­å¤ç°`too many open files in system`çš„æƒ…å†µ&#13;
*  ä¿®æ”¹limit.confä¸­nofileï¼Œç°åœ¨æ–‡ä»¶æ‰“å¼€æ•°é‡ï¼Œåœ¨podä¸­ä¸ä¼šæŠ¥é”™ï¼Œç›´æ¥åœ¨å®¿ä¸»æœºä¸­è¿è¡Œç¨‹åºä¼šæŠ¥é”™&#13;
*  ä¿®æ”¹å†…æ ¸å‚æ•°fs.file-maxï¼Œé™ä½å€¼å†…æ ¸å‚æ•°çš„å€¼ï¼Œpodä¸­ä¼šæŠ¥é”™ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/10.html</guid><pubDate>Tue, 02 Jul 2024 06:03:36 +0000</pubDate></item><item><title>cgroup&amp;å¤šçº¿ç¨‹æµ‹è¯•</title><link>https://longxiucai.github.io/post/9.html</link><description>## Cä»£ç ï¼šthread.c&#13;
```&#13;
#include&lt;stdio.h&gt;&#13;
#include&lt;stdlib.h&gt;&#13;
#include&lt;pthread.h&gt;&#13;
#include &lt;unistd.h&gt; &#13;
/* å£°æ˜ç»“æ„ä½“ */&#13;
struct member&#13;
{&#13;
    int num;&#13;
    char *name;&#13;
};     &#13;
&#13;
/* å®šä¹‰çº¿ç¨‹pthread */&#13;
static void * pthread(void *arg)       &#13;
{&#13;
    struct member *temp;&#13;
    &#13;
    /* çº¿ç¨‹pthreadå¼€å§‹è¿è¡Œ */&#13;
    printf('pthread start!\n');&#13;
    while(1){&#13;
    ;&#13;
    }&#13;
    /* ä»¤ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ */&#13;
    sleep(2);&#13;
    &#13;
    /* æ‰“å°ä¼ å…¥å‚æ•° */&#13;
    temp = (struct member *)arg;      &#13;
    printf('member-&gt;num:%d\n',temp-&gt;num);&#13;
    printf('member-&gt;name:%s\n',temp-&gt;name);&#13;
    &#13;
    return NULL;&#13;
}&#13;
&#13;
/* mainå‡½æ•° */&#13;
int main(int agrc,char* argv[])&#13;
{&#13;
    pthread_t tidp,tidp1;&#13;
    struct member *b;&#13;
&#13;
    /* ä¸ºç»“æ„ä½“å˜é‡bèµ‹å€¼ */&#13;
    b = (struct member *)malloc(sizeof(struct member));           &#13;
    b-&gt;num=1;&#13;
    b-&gt;name='mlq';              &#13;
&#13;
    /* åˆ›å»ºçº¿ç¨‹pthread */&#13;
    if ((pthread_create(&amp;tidp, NULL, pthread, (void*)b)) == -1)&#13;
    {&#13;
        printf('create error!\n');&#13;
        return 1;&#13;
    }&#13;
    if ((pthread_create(&amp;tidp1, NULL, pthread, (void*)b)) == -1)&#13;
    {&#13;
        printf('create error!\n');&#13;
        return 1;&#13;
    }&#13;
&#13;
    /* ä»¤çº¿ç¨‹pthreadå…ˆè¿è¡Œ */&#13;
    sleep(1);&#13;
    &#13;
    /* çº¿ç¨‹pthreadç¡çœ 2sï¼Œæ­¤æ—¶mainå¯ä»¥å…ˆæ‰§è¡Œ */&#13;
    printf('main continue!\n');&#13;
    &#13;
    /* ç­‰å¾…çº¿ç¨‹pthreadé‡Šæ”¾ */&#13;
    if (pthread_join(tidp, NULL))                  &#13;
    {&#13;
        printf('thread is not exit...\n');&#13;
        return -2;&#13;
    }&#13;
    &#13;
    return 0;&#13;
}&#13;
```&#13;
## ç¼–è¯‘&#13;
```&#13;
gcc -o thread.out thread.c -lpthread&#13;
```&#13;
## æµ‹è¯•&#13;
1ã€`systemd-run --unit=threadtest --slice=test  /root/thread.out` ä¼šå¯åŠ¨ä¸€ä¸ªä¸´æ—¶æœåŠ¡,è¯¥æœåŠ¡å°±æ˜¯è¿è¡Œ/root/thread.outï¼Œåä¸ºthreadtest.service&#13;
2ã€æŸ¥çœ‹`top -H -p &lt;threadtest.serviceçš„pid&gt;`ä¼šæ˜¾ç¤ºè¯¥æœåŠ¡åŠå…¶çº¿ç¨‹çš„ä¿¡æ¯&#13;
3ã€cgroupï¼š/sys/fs/cgroup/cpu/test.slice/threadtest.serviceã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/9.html</guid><pubDate>Tue, 02 Jul 2024 05:56:42 +0000</pubDate></item><item><title>bucketbenchæµ‹è¯•crioæ­¥éª¤</title><link>https://longxiucai.github.io/post/8.html</link><description>1. å®‰è£…crio&#13;
&#13;
2. ä¿®æ”¹crioé…ç½®æ–‡ä»¶çš„[crio.image]å­—æ®µï¼Œæ·»åŠ ä¸€è¡Œpause_image      å­—æ®µä½äºç¬¬444è¡Œ&#13;
vim /etc/crio/crio.conf&#13;
[crio.image]&#13;
pause_image = 'harbor.kylincloudnative.com/registry.k8s.io/pause:3.6'&#13;
&#13;
3. é…ç½®cgroup&#13;
mkdir -p /etc/crio/crio.conf.d&#13;
cat &gt;/etc/crio/crio.conf.d/02-cgroup-manager.conf&lt;&lt;-EOF&#13;
[crio.runtime]&#13;
conmon_cgroup = 'pod'&#13;
cgroup_manager = 'cgroupfs'&#13;
EOF&#13;
&#13;
&#13;
4. é‡å¯å¹¶è§‚å¯ŸçŠ¶æ€æ˜¯å¦running&#13;
systemctl daemon-reload&#13;
systemctl restart crio&#13;
systemctl status crio&#13;
&#13;
5. æ‹‰é•œåƒï¼Œä¿®æ”¹tag&#13;
```&#13;
podman pull harbor.kylincloudnative.com/library/alpine:latest&#13;
podman pull harbor.kylincloudnative.com/registry.k8s.io/pause:3.6&#13;
podman pull harbor.kylincloudnative.com/registry.k8s.io/pause:3.1&#13;
podman tag harbor.kylincloudnative.com/registry.k8s.io/pause:3.6 registry.aliyuncs.com/google_containes/pause:3.6&#13;
podman tag harbor.kylincloudnative.com/registry.k8s.io/pause:3.1Â registry.aliyuncs.com/google_containers/pause:3.1&#13;
```&#13;
6. ä¿®æ”¹æµ‹è¯•å·¥å…·é…ç½®æ–‡ä»¶&#13;
* ä¿®æ”¹ contrib/container_config.json      ä½äºç¬¬7è¡Œ&#13;
image.imageä¿®æ”¹ä¸ºharbor.kylincloudnative.com/library/alpine:latest&#13;
* ä¿®æ”¹ examples/crio.yaml   ä½äºç¬¬2è¡Œ&#13;
image: harbor.kylincloudnative.com/library/alpine:latest&#13;
* ä¿®æ”¹ examples/crio.yamlä¸­çš„çº¿ç¨‹æ•°ç›¸å…³é…ç½®ï¼š&#13;
   threads: xxxxxxxx&#13;
   iterations: xxxxxxxx.&#13;
&#13;
7. æµ‹è¯• arm&#13;
./bucketbench-aarch64 --log-level=debug run -b   examples/crio.yaml --skip-limit&#13;
&#13;
&#13;
&gt; [!TIP]&#13;
&gt; å¦‚æŠ¥é”™`xxxxxx : name is reserved`ï¼Œåˆ™éœ€åˆ é™¤podï¼š&#13;
```&#13;
for i in $(crictl pods | awk -F ' ' '{print$1}' | xargs) ;do crictl stopp $i; done&#13;
for i in $(crictl pods | awk -F ' ' '{print$1}' | xargs) ;do crictl rmp $i; done&#13;
```&#13;
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/8.html</guid><pubDate>Tue, 02 Jul 2024 05:51:53 +0000</pubDate></item><item><title>bondé…ç½®</title><link>https://longxiucai.github.io/post/7.html</link><description>1. é…ç½®ifcfg-xxx1æ¥å£ è·¯å¾„ä¸º /etc/sysconfig/network-scripts/&#13;
TYPE=Ethernet&#13;
NAME=xxx1&#13;
BOOTPROTO=none&#13;
DEVICE=xxx1&#13;
ONBOOT=yes&#13;
MASTER=bond0&#13;
SLAVE=yes&#13;
2. åŒ1ï¼Œé…ç½®ifcfg-xxx2æ¥å£&#13;
3. æ–°å»ºifcfg-bond0æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹&#13;
TYPE=Ethernet&#13;
NAME=bond0&#13;
BOOTPROTO=static&#13;
DEVICE=bond0&#13;
ONBOOT=yes&#13;
IPADDR=xxxx&#13;
NATMASK=XXXX&#13;
GATEWAY=172.20.43.253&#13;
DNS1=172.20.191.2&#13;
DNS2=114.114.114.114&#13;
BONDING_OPTS='mode=6 miimon=100'&#13;
4. åŠ è½½æ¨¡å—ï¼Œè®©ç³»ç»Ÿæ”¯æŒbonding    ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ&#13;
cat/etc/modprobe.confï¼Ÿï¼Ÿï¼Ÿ/etc/modprobe.d/bonding.confï¼Ÿï¼Ÿï¼Ÿ  //ä¸å­˜åœ¨çš„è¯ï¼Œæ‰‹åŠ¨åˆ›å»ºï¼ˆä¹Ÿå¯ä»¥æ”¾åœ¨modprobe.dä¸‹é¢ï¼‰&#13;
alias bond0 bonding&#13;
options bond0 miimon=100 mode=0&#13;
5. åŠ è½½bond moduleï¼šmodprobe bonding&#13;
6. systemctl restart network&#13;
7. æŸ¥çœ‹ç»‘å®šç»“æœ&#13;
`cat  /proc/net/bonding/bond0`&#13;
&#13;
å‚è€ƒï¼š&#13;
https://www.cnblogs.com/huangweimin/articles/6527058.html&#13;
https://blog.csdn.net/qq_34870631/article/details/80625217&#13;
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/7.html</guid><pubDate>Tue, 02 Jul 2024 05:45:43 +0000</pubDate></item><item><title>ç½‘æ¡¥é…ç½®è„šæœ¬</title><link>https://longxiucai.github.io/post/6.html</link><description>#!/bin/bash&#13;
ifname=ens3&#13;
brname=bridge0&#13;
ip=172.20.43.11/24&#13;
gateway=172.20.43.253&#13;
dns='172.20.191.2,114.114.114.114'&#13;
nmcli connection add ifname $brname type bridge con-name $brname&#13;
nmcli connection delete ${ifname}&#13;
nmcli connection add type bridge-slave ifname ${ifname} master $brname&#13;
nmcli connection modify $brname ipv4.addresses $ip&#13;
nmcli connection modify $brname ipv4.gateway $gateway&#13;
nmcli connection modify $brname ipv4.dns $dns&#13;
nmcli connection modify $brname ipv4.method manual&#13;
nmcli connection up $brnameã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/6.html</guid><pubDate>Tue, 02 Jul 2024 05:43:51 +0000</pubDate></item><item><title>ä¸´æ—¶ä¿®æ”¹initrd.img</title><link>https://longxiucai.github.io/post/5.html</link><description>## è§£å‹&#13;
mkdir tmpdir&#13;
cd tmpdir&#13;
xzcat -d ../initrd.img | cpio -idum   #è§£å‹imgè¾“å‡ºåˆ°å½“å‰æ‰€åœ¨ç›®å½•&#13;
&#13;
## ä¿®æ”¹&#13;
....&#13;
&#13;
## é‡æ–°æ‰“åŒ…&#13;
find . | cpio -oH newc | xz --check=crc32 -9 &gt; ../initrd.img&#13;
&#13;
cpio -Hå‚æ•°è¯´æ˜ï¼š&#13;
* bin è¿‡æ—¶çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/5.html</guid><pubDate>Tue, 02 Jul 2024 05:40:28 +0000</pubDate></item><item><title>æ­£åˆ™è¡¨è¾¾å¼</title><link>https://longxiucai.github.io/post/4.html</link><description>## å…ƒå­—ç¬¦è¯´æ˜&#13;
&#13;
    å…ƒå­—ç¬¦:  |&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…|ä¸¤è¾¹ä»»æ„ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼&#13;
&#13;
    å…ƒå­—ç¬¦:  .&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…é™¤æ¢è¡Œå¤–çš„ä»»æ„å­—ç¬¦&#13;
&#13;
    å…ƒå­—ç¬¦:  ^&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„å¼€å¤´ä½ç½®&#13;
&#13;
    å…ƒå­—ç¬¦:  $&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®&#13;
&#13;
    å…ƒå­—ç¬¦:  *&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…å‰é¢çš„å­—ç¬¦å‡ºç°0æ¬¡æˆ–å¤šæ¬¡&#13;
&#13;
    å…ƒå­—ç¬¦:  +&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…å‰é¢çš„å­—ç¬¦å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡&#13;
&#13;
	å…ƒå­—ç¬¦:  ?&#13;
	åŒ¹é…è§„åˆ™:åŒ¹é…å‰é¢çš„å­—ç¬¦å‡ºç°0æ¬¡æˆ–1æ¬¡&#13;
&#13;
    å…ƒå­—ç¬¦:  {n}&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…æŒ‡å®šçš„é‡å¤æ¬¡æ•°&#13;
   &#13;
	 å…ƒå­—ç¬¦: {m,n}   &#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼ m--næ¬¡        &#13;
&#13;
&#13;
## åŒ¹é…å­—ç¬¦é›†åˆ&#13;
&#13;
* å…ƒå­—ç¬¦:`[å­—ç¬¦é›†]`&#13;
&#13;
    åŒ¹é…è§„åˆ™:åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦é›†ä¸‹çš„å­—ç¬¦&#13;
```&#13;
    [abc123] a b c 1 2 3 12 &#13;
	[a-z] [0-9] [_123a-z]&#13;
    eg:&#13;
    &gt;&gt;&gt; re.findall('^[a-z][a-z]','boy')&#13;
    ['bo']&#13;
```&#13;
* å…ƒå­—ç¬¦:`[^...]`&#13;
&#13;
    åŒ¹é…è§„åˆ™:å­—ç¬¦é›†å–é,é™¤äº†åˆ—å‡ºçš„å­—ç¬¦ä¹‹å¤–ä»»æ„ä¸€ä¸ªå­—ç¬¦&#13;
```&#13;
    [^abc]--&gt;é™¤abcä¹‹å¤–ä»»æ„å­—ç¬¦&#13;
    eg:&#13;
    &gt;&gt;&gt; re.findall('[^abcds]','boyadshfhjasjhbhjasf')&#13;
    ['o', 'y', 'h', 'f', 'h', 'j', 'j', 'h', 'h', 'j', 'f']&#13;
```&#13;
&#13;
* å…ƒå­—ç¬¦: `\d`  `\D`&#13;
&#13;
    åŒ¹é…è§„åˆ™: &#13;
&#13;
    `\d` åŒ¹é…ä»»æ„æ•°å­—å­—ç¬¦      [0-9]&#13;
    &#13;
    `\D` åŒ¹é…ä»»æ„éæ•°å­—å­—ç¬¦    [^0-9]&#13;
```&#13;
    eg:&#13;
    &gt;&gt;&gt; re.findall('\D','AID1807')&#13;
    ['A', 'I', 'D']&#13;
&#13;
	\1,\2	åå‘å¼•ç”¨	åŒ¹é…ä¹‹å‰ç¬¬ä¸€ã€ç¬¬äºŒæ‹¬å·å†…è¡¨è¾¾å¼åŒ¹é…çš„å†…å®¹&#13;
&#13;
	ä¸¾ä¸ªä¾‹å­ï¼Œæƒ³æ‰¾åˆ°è¿ç»­ä¸¤ä¸ªé‡å¤å•è¯ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦çŸ¥é“å‰é¢å•è¯æ˜¯ä»€ä¹ˆï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨åå‘å¼•ç”¨äº†ï¼Œå¯ä»¥ç®€å•å†™ä¸º(\w+)\s+\1&#13;
```&#13;
	&#13;
* å…ƒå­—ç¬¦:`\w`  `\W`&#13;
    åŒ¹é…è§„åˆ™:&#13;
&#13;
    `\w` æ™®é€šå­—ç¬¦  &#13;
    &#13;
    `\W` éæ™®é€šå­—ç¬¦&#13;
```&#13;
    eg:&#13;
    &gt;&gt;&gt; re.findall('\w','æˆ‘åœ¨åŒ—äº¬')&#13;
    ['æˆ‘', 'åœ¨', 'åŒ—', 'äº¬']&#13;
            &#13;
    &gt;&gt;&gt; re.findall('\W','!@#$æˆ‘åœ¨åŒ—äº¬')&#13;
    ['!', '@', '#', '$']&#13;
```&#13;
&#13;
* å…ƒå­—ç¬¦: `\s` `\S`&#13;
    åŒ¹é…è§„åˆ™:&#13;
&#13;
    `\s` åŒ¹é…ä»»æ„ç©ºå­—ç¬¦`[\r\t\n\v\f]`&#13;
&#13;
    `\S` åŒ¹é…ä»»æ„éç©ºå­—ç¬¦&#13;
```&#13;
    eg:&#13;
    &gt;&gt;&gt; re.findall('\w+\s+\w+','hello     beijin')&#13;
    ['hello     beijin']&#13;
    &gt;&gt;&gt; re.findall('\w+\S+\w+','hello     beijin')&#13;
    ['hello', 'beijin']&#13;
```&#13;
* å…ƒå­—ç¬¦: `\A` `\Z`&#13;
   &#13;
    åŒ¹é…è§„åˆ™:&#13;
    &#13;
    `\A` åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´ä½ç½®  `^`&#13;
&#13;
    `\Z` åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾ä½ç½®  `$`&#13;
```&#13;
    &gt;&gt;&gt; re.findall('\Ahello','hellobeijin')&#13;
    ['hello']&#13;
    &gt;&gt;&gt; re.findall('beijin\Z','hellobeijin')&#13;
    ['beijin']&#13;
```&#13;
ç»å¯¹åŒ¹é…:æ­£åˆ™è¡¨è¾¾å¼å®Œå…¨åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²å†…å®¹&#13;
&#13;
åœ¨æ­£åˆ™è¡¨è¾¾å¼çš„å¼€å¤´æˆ–è€…ç»“å°¾åŠ ä¸Š`^`æˆ–è€…`$`(æˆ–è€…`\A` `\Z`).è¿™æ ·æ­£åˆ™è¡¨è¾¾å¼å¿…é¡»åŒ¹é…åˆ°æ•´ä¸ªç›®æ ‡å­—ç¬¦ä¸²æ‰ä¼šæœ‰ç»“æœ&#13;
```&#13;
    eg:&#13;
    &gt;&gt;&gt; re.findall('\A\d+$','1234568789')&#13;
    ['1234568789']&#13;
&#13;
    åŒ¹é…(é)å•è¯è¾¹ç•Œ&#13;
    \&lt;	å•è¯åˆ†ç•Œç¬¦	åŒ¹é…å•è¯å¼€å§‹	javaä¸­ä½¿ç”¨\b&#13;
	\&gt;	å•è¯åˆ†ç•Œç¬¦	åŒ¹é…å•è¯ç»“æŸ	javaä¸­ä½¿ç”¨\B&#13;
```&#13;
* å…ƒå­—ç¬¦: `\b` `\B`&#13;
    &#13;
    åŒ¹é…è§„åˆ™:&#13;
    &#13;
    `\b` åŒ¹é…å•è¯è¾¹ç•Œä½ç½®&#13;
&#13;
    `\B` åŒ¹é…éå•è¯è¾¹ç•Œä½ç½®&#13;
            æ™®é€šå­—ç¬¦å’Œéæ™®é€šå­—ç¬¦è®¤ä¸ºæ˜¯å•è¯è¾¹ç•Œ&#13;
```&#13;
    eg:&#13;
    &gt;&gt;&gt; re.findall(r'he\b','he ##is a good gril')&#13;
    ['he']&#13;
```&#13;
 &#13;
## å…ƒå­—ç¬¦æ€»ç»“&#13;
&#13;
åŒ¹é…å•ä¸ªå­—ç¬¦: &#13;
```&#13;
a  .  \d   \D  \s  \S  \w   \W  [...]  [^...]&#13;
```&#13;
åŒ¹é…é‡å¤: &#13;
```&#13;
*  +  ?  {n}  {m,n}&#13;
```&#13;
åŒ¹é…ä½ç½®:&#13;
```&#13;
^  $  \A  \Z  \b  \B&#13;
```&#13;
å…¶ä»–: &#13;
```&#13;
|  ()  \&#13;
```&#13;
## æ­£åˆ™è¡¨è¾¾å¼è½¬ä¹‰&#13;
&#13;
æ­£åˆ™ä¸­çš„ç‰¹æ®Šå­—ç¬¦&#13;
```&#13;
. * + ? ^ $ [] {} () | \&#13;
```&#13;
æ­£åˆ™è¡¨è¾¾å¼å¦‚æœåŒ¹é…ç‰¹æ®Šå­—ç¬¦éœ€è¦åŠ `\`è¡¨è¾¾è½¬ä¹‰&#13;
```&#13;
    eg:             æ­£åˆ™  ç›®æ ‡å­—ç¬¦ä¸²&#13;
    &gt;&gt;&gt; re.findall('\$\d+','$10')&#13;
    ['$10']&#13;
&#13;
             pattern     string&#13;
    python  '\\$\\d+'     '$10'&#13;
    python   r'\$\d+'     '$10'&#13;
&#13;
    rawå­ä¸²: åŸå§‹å­—ç¬¦ä¸²å¯¹å†…å®¹ä¸è§£é‡Šè½¬ä¹‰,å°±è¡¨è¾¾å†…å®¹åŸæœ¬çš„æ„ä¹‰&#13;
```&#13;
## è´ªå©ªå’Œéè´ªå©ª&#13;
&#13;
è´ªå©ªæ¨¡å¼:æ­£åˆ™è¡¨è¾¾å¼çš„é‡å¤åŒ¹é…æ€»æ˜¯å°½å¯èƒ½å¤šçš„å‘ååŒ¹é…æ›´å¤šå†…å®¹`* + ? {m,n}`&#13;
&#13;
éè´ªå©ªæ¨¡å¼(æ‡’æƒ°æ¨¡å¼):å°½å¯èƒ½å°‘çš„åŒ¹é…å†…å®¹&#13;
```&#13;
    è´ªå©ª---&gt;éè´ªå©ª *?  +?  ??   {m,n}?&#13;
    &gt;&gt;&gt; re.findall(r'ab','abbbbbbbbbbb')&#13;
    ['ab']&#13;
    &#13;
    &gt;&gt;&gt; re.findall(r'ab+','abbbbbbbbbbb')&#13;
    ['abbbbbbbbbbb']&#13;
    &#13;
    &gt;&gt;&gt; re.findall(r'ab{3,5}?','abbbbbbbbbbb')&#13;
    ['abbb']&#13;
```&#13;
## æ­£åˆ™è¡¨è¾¾å¼çš„å­ç»„&#13;
å¯ä»¥ä½¿ç”¨()ä¸ºæ­£åˆ™è¡¨è¾¾å¼å»ºç«‹å­ç»„,å­ç»„å¯ä»¥çœ‹åšæ˜¯æ­£åˆ™è¡¨è¾¾å¼å†…éƒ¨æ“ä½œçš„ä¸€ä¸ªæ•´ä½“&#13;
&#13;
å­ç»„æ˜¯åœ¨æ­£åˆ™è¡¨è¾¾å¼æ•´ä½“åŒ¹é…åˆ°å†…å®¹çš„å‰æä¸‹æ‰ä¼šå‘æŒ¥çš„ä½œç”¨,ä»–ä¸å½±å“æ­£åˆ™è¡¨è¾¾å¼æ•´ä½“å»åŒ¹é…ç›®æ ‡å†…å®¹è¿™ä¸€åŸåˆ™&#13;
&#13;
å­ç»„ä½œç”¨&#13;
&#13;
1.ä½œä¸ºå†…éƒ¨æ•´ä½“å¯ä»¥æ”¹å˜æŸäº›åŸå­—ç¬¦çš„è¡Œä¸º&#13;
    eg:&#13;
    &gt;&gt;&gt; re.search(r'(ab)+\d+','abababab123456').group()&#13;
    'abababab123456'&#13;
&#13;
2.å­ç»„åœ¨æŸäº›æ“ä½œä¸­å¯ä»¥å•ç‹¬æå–å‡ºåŒ¹é…å†…å®¹&#13;
    &gt;&gt;&gt; re.search(r'(https|http|ftp)://\S+','https://baidu.com').group()&#13;
    'https://baidu.com'&#13;
&#13;
&#13;
å­ç»„ä½¿ç”¨æ³¨æ„äº‹é¡¹:&#13;
* ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥æœ‰å¤šä¸ªå­ç»„&#13;
* å­ç»„ä¸€èˆ¬ç”±å¤–åˆ°å†…,å·¦åˆ°å³ç§°ä¹‹ä¸ºç¬¬ä¸€,ç¬¬äºŒ,ç¬¬ä¸‰...å­ç»„&#13;
* å­ç»„ä¸èƒ½é‡å ,åµŒå¥—ä¹Ÿä¸å®œå¾ˆå¤æ‚&#13;
&#13;
&#13;
## æ•è·ç»„å’Œéæ•è·ç»„&#13;
&#13;
æ ¼å¼:&#13;
```&#13;
(?P&lt;name&gt;pattern)&#13;
&#13;
&gt;&gt;&gt; re.search(r'(?P&lt;dog&gt;ab)cdef','abcdefghijklmn').group('dog')&#13;
'ab'&#13;
```&#13;
ä½œç”¨:å¯ä»¥é€šè¿‡ç»„åæ›´æ–¹ä¾¿è·å–æŸç»„å†…å®¹ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/4.html</guid><pubDate>Tue, 02 Jul 2024 05:36:57 +0000</pubDate></item><item><title>ä¿®æ”¹podç½‘æ®µä¸calicoé…ç½®</title><link>https://longxiucai.github.io/post/3.html</link><description>1. vim /etc/kubernetes/manifests/kube-controller-manager.yaml ã€3ä¸ªmasterä¸€ä¸ªä¸€ä¸ªçš„æ‰§è¡Œï¼Œæœ€å¥½æ˜¯kube-controller-manager-èŠ‚ç‚¹åå­—çš„pod Runningä¹‹åå†ä¿®æ”¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‘&#13;
		19è¡Œï¼š--cluster-cidr=10.128.0.0/18&#13;
&#13;
2. kubectl edit cm kubeadm-config -n kube-system&#13;
		podSubnet: 10.128.0.0/18&#13;
&#13;
3. kubectl edit cm kube-proxy -n kube-system&#13;
		clusterCIDR: 10.128.0.0/18&#13;
&#13;
4. kubectl edit ippool default-ipv4-ippool&#13;
		cidr: 10.128.0.0/18&#13;
&#13;
5. kubectl edit cm calico-config -n kube-system ï¼š&#13;
          'ipam': {&#13;
              'type': 'calico-ipam',					              #é€—å·&#13;
              'ipv4_pools': ['default-ipv4-ippool']   #æ·»åŠ æ­¤è¡Œï¼Œå‰é¢å¿…é¡»æ˜¯ç©ºæ ¼ä¸èƒ½æ˜¯tab&#13;
          },&#13;
&#13;
6. kubectl rollout restart -n kube-system daemonset.apps/calico-node&#13;
ç­‰å¾…calicoçš„podå…¨éƒ¨runningï¼Œå…¨éƒ¨èŠ‚ç‚¹æŸ¥çœ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰'ipv4_pools': ['default-ipv4-ippool']ï¼š&#13;
cat /etc/cni/net.d/00-multus.conf&#13;
cat /etc/cni/net.d/10-calico.conflist&#13;
&#13;
7. kubectl  edit ippool kubevirt-vm-ippool&#13;
  cidr: 10.128.128.0/18&#13;
&#13;
8. kubectl delete ippool other-ippool&#13;
&#13;
9. kubectl cluster-info dump | grep cluster-cidr&#13;
&#13;
&#13;
é»˜è®¤ä½¿ç”¨default poolï¼Œå¼€å¯noipamåŠŸèƒ½&#13;
calico-config configMap:&#13;
cni.projectcalico.org/ipAddrsNoIpam&#13;
```&#13;
apiVersion: v1&#13;
data:&#13;
  calico_backend: bird&#13;
  cni_network_config: |-&#13;
    {&#13;
      'name': 'k8s-pod-network',&#13;
      'cniVersion': '0.3.1',&#13;
      'plugins': [&#13;
        {&#13;
          'type': 'calico',&#13;
          'log_level': 'info',&#13;
          'log_file_path': '/var/log/calico/cni/cni.log',&#13;
          'datastore_type': 'kubernetes',&#13;
          'nodename': '__KUBERNETES_NODE_NAME__',&#13;
          'mtu': __CNI_MTU__,&#13;
          'ipam': {&#13;
              'type': 'calico-ipam',&#13;
              'ipv4_pools': ['default-ipv4-ippool']&#13;
          },&#13;
          'policy': {&#13;
              'type': 'k8s'&#13;
          },&#13;
          'kubernetes': {&#13;
              'kubeconfig': '__KUBECONFIG_FILEPATH__'&#13;
          },&#13;
         'feature_control': {&#13;
             'ip_addrs_no_ipam': true&#13;
         }&#13;
        },&#13;
        {&#13;
          'type': 'portmap',&#13;
          'snat': true,&#13;
          'capabilities': {'portMappings': true}&#13;
        },&#13;
        {&#13;
          'type': 'bandwidth',&#13;
          'capabilities': {'bandwidth': true}&#13;
        }&#13;
      ]&#13;
    }&#13;
  typha_service_name: none&#13;
  veth_mtu: '0'&#13;
kind: ConfigMap&#13;
metadata:&#13;
  name: calico-config&#13;
  namespace: kube-system&#13;
```&#13;
&#13;
ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/3.html</guid><pubDate>Tue, 02 Jul 2024 03:23:13 +0000</pubDate></item><item><title>goè§£æè¯ä¹¦æ–‡ä»¶</title><link>https://longxiucai.github.io/post/2.html</link><description>```&#13;
package cert&#13;
&#13;
import (&#13;
	'crypto/x509'&#13;
	'encoding/pem'&#13;
	'os'&#13;
	'path/filepath'&#13;
	'strings'&#13;
	'time'&#13;
&#13;
	log 'github.com/sirupsen/logrus'&#13;
)&#13;
&#13;
func parseCertificate(file string) {&#13;
	// è¯»å–æ–‡ä»¶å†…å®¹&#13;
	fileData, err := os.ReadFile(file)&#13;
	if err != nil {&#13;
		log.Errorf('Error reading file %s: %s\n', file, err)&#13;
		return&#13;
	}&#13;
&#13;
	// è§£æ PEM å—&#13;
	block, _ := pem.Decode(fileData)&#13;
	if block == nil {&#13;
		log.Errorf('No PEM block found in file %s\n', file)&#13;
		return&#13;
	}&#13;
&#13;
	// åˆ¤æ–­æ–‡ä»¶ç±»å‹&#13;
	fileType := strings.ToLower(filepath.Ext(file))&#13;
	switch fileType {&#13;
	case '.crt', '.pem':&#13;
		// è§£æè¯ä¹¦&#13;
		cert, err := x509.ParseCertificate(block.Bytes)&#13;
		if err != nil {&#13;
			log.Errorf('Error parsing certificate from file %s: %s\n', file, err)&#13;
			return&#13;
		}&#13;
&#13;
		// è¾“å‡ºè¯ä¹¦æœ‰æ•ˆæœŸç­‰ä¿¡æ¯&#13;
		log.Infof('Certificate in file %s:', file)&#13;
		log.Infof('  Subject: %s', cert.Subject.CommonName)&#13;
		log.Infof('  Valid from: %s', cert.NotBefore)&#13;
		log.Infof('  Valid until: %s', cert.NotAfter)&#13;
&#13;
		// è®¡ç®—è¯ä¹¦æœ‰æ•ˆæœŸç»“æŸæ—¶é—´ä¸å½“å‰æ—¶é—´ä¹‹é—´çš„å¤©æ•°å·®&#13;
		now := time.Now()&#13;
		expiresInDays := int((time.Duration(cert.NotAfter.Sub(now).Hours()) / 24))&#13;
		log.Infof('è¯ä¹¦%s å°†äº %d å¤©åè¿‡æœŸ', cert.Subject.CommonName, expiresInDays)&#13;
		log.Infof('---------------------------')&#13;
	default:&#13;
		log.Infof('Unsupported file type: %s %s', fileType, file)&#13;
	}&#13;
}&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/2.html</guid><pubDate>Tue, 02 Jul 2024 02:33:15 +0000</pubDate></item><item><title>goè¿æ¥æ•°æ®åº“</title><link>https://longxiucai.github.io/post/1.html</link><description>```&#13;
package dbtest&#13;
&#13;
import (&#13;
	'database/sql'&#13;
	'fmt'&#13;
	'log'&#13;
&#13;
	_ 'github.com/go-sql-driver/mysql'&#13;
)&#13;
&#13;
func maindb() {&#13;
	// è¿æ¥ MySQL æ•°æ®åº“&#13;
	db, err := sql.Open('mysql', 'dbinit:123456@tcp(10.42.186.232:3306)/dbinit_test')&#13;
	if err != nil {&#13;
		log.Fatal(err)&#13;
	}&#13;
	defer db.Close()&#13;
&#13;
	// æµ‹è¯•è¿æ¥&#13;
	err = db.Ping()&#13;
	if err != nil {&#13;
		log.Fatal('Error connecting to the database:', err)&#13;
	}&#13;
&#13;
	fmt.Println('Connected to MySQL database successfully!')&#13;
&#13;
	// æŸ¥è¯¢ç¤ºä¾‹&#13;
	rows, err := db.Query('SELECT * FROM users')&#13;
	if err != nil {&#13;
		log.Fatal('Error executing query:', err)&#13;
	}&#13;
	defer rows.Close()&#13;
&#13;
	// éå†æŸ¥è¯¢ç»“æœ&#13;
	for rows.Next() {&#13;
		var id int&#13;
		var name string&#13;
		err := rows.Scan(&amp;id, &amp;name)&#13;
		if err != nil {&#13;
			log.Fatal('Error scanning row:', err)&#13;
		}&#13;
		fmt.Printf('ID: %d, Name: %s\n', id, name)&#13;
	}&#13;
}&#13;
```ã€‚</description><guid isPermaLink="true">https://longxiucai.github.io/post/1.html</guid><pubDate>Tue, 02 Jul 2024 02:04:36 +0000</pubDate></item></channel></rss>